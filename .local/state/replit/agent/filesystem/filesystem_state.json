{"file_contents":{"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, integer, real, jsonb, timestamp, pgEnum } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// POI Types enum\nexport const poiTypes = [\n  \"Building\",\n  \"Gate\",\n  \"Canteen\",\n  \"Food Stall\",\n  \"Library\",\n  \"Student Lounge\",\n  \"Car Parking\",\n  \"Motorcycle Parking\",\n  \"Comfort Room\",\n  \"Lecture Hall / Classroom\",\n  \"Administrative Office\",\n  \"Residence Hall / Dormitory\",\n  \"Health Services / Clinic\",\n  \"Gym / Sports Facility\",\n  \"Auditorium / Theater\",\n  \"Laboratory\",\n  \"Faculty Lounge / Staff Room\",\n  \"Study Area\",\n  \"Bookstore\",\n  \"ATM\",\n  \"Chapel / Prayer Room\",\n  \"Green Space / Courtyard\",\n  \"Bus Stop / Shuttle Stop\",\n  \"Bike Parking\",\n  \"Security Office / Campus Police\",\n  \"Waste / Recycling Station\",\n  \"Water Fountain\",\n  \"Print/Copy Center\",\n  \"Other\"\n] as const;\n\nexport type POIType = typeof poiTypes[number];\n\n// POI type subsets for feature gating\nexport const buildingDepartmentTypes = new Set<POIType>([\"Building\"]);\n\nexport const floorPlanEligibleTypes = new Set<POIType>([\n  \"Building\",\n  \"Library\",\n  \"Canteen\",\n  \"Lecture Hall / Classroom\",\n  \"Administrative Office\",\n  \"Health Services / Clinic\",\n  \"Gym / Sports Facility\",\n  \"Laboratory\"\n]);\n\nexport const staffAllowedPOITypes = new Set<POIType>([\n  \"Building\",\n  \"Security Office / Campus Police\",\n  \"Gym / Sports Facility\",\n  \"Library\",\n  \"Administrative Office\",\n  \"Health Services / Clinic\"\n]);\n\nexport const descriptionOnlyTypes = new Set<POIType>([\n  \"Gate\",\n  \"Food Stall\",\n  \"Student Lounge\",\n  \"Car Parking\",\n  \"Motorcycle Parking\",\n  \"Bike Parking\",\n  \"Comfort Room\",\n  \"Auditorium / Theater\",\n  \"Faculty Lounge / Staff Room\",\n  \"Study Area\",\n  \"Bookstore\",\n  \"ATM\",\n  \"Green Space / Courtyard\",\n  \"Bus Stop / Shuttle Stop\",\n  \"Waste / Recycling Station\",\n  \"Water Fountain\",\n  \"Print/Copy Center\",\n  \"Other\"\n]);\n\n// Helper predicates for POI type checking\nexport const canHaveDepartments = (type: POIType): boolean => buildingDepartmentTypes.has(type);\nexport const canHaveFloorPlan = (type: POIType): boolean => floorPlanEligibleTypes.has(type);\nexport const canHaveStaff = (type: POIType): boolean => staffAllowedPOITypes.has(type);\nexport const isDescriptionOnly = (type: POIType): boolean => descriptionOnlyTypes.has(type);\n\n// Kiosk location constant - \"You are Here\" marker\nexport const KIOSK_LOCATION = {\n  id: 'kiosk',\n  name: 'Your Location (Kiosk)',\n  lat: 14.403115555479292,\n  lng: 120.86635977029803,\n  type: 'Kiosk',\n  description: null,\n  departments: null,\n  image: null,\n  markerIcon: null\n} as const;\n\n// Buildings table\nexport const buildings = pgTable(\"buildings\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  type: text(\"type\").notNull().default(\"Building\"),\n  description: text(\"description\"),\n  lat: real(\"lat\").notNull(),\n  lng: real(\"lng\").notNull(),\n  departments: text(\"departments\").array(),\n  image: text(\"image\"),\n  markerIcon: text(\"marker_icon\").default(\"building\"),\n});\n\nexport const insertBuildingSchema = createInsertSchema(buildings).omit({ id: true });\nexport type InsertBuilding = z.infer<typeof insertBuildingSchema>;\nexport type Building = typeof buildings.$inferSelect;\n\n// Floors table\nexport const floors = pgTable(\"floors\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  buildingId: varchar(\"building_id\").notNull(),\n  floorNumber: integer(\"floor_number\").notNull(),\n  floorName: text(\"floor_name\"),\n  floorPlanImage: text(\"floor_plan_image\"),\n});\n\nexport const insertFloorSchema = createInsertSchema(floors).omit({ id: true });\nexport type InsertFloor = z.infer<typeof insertFloorSchema>;\nexport type Floor = typeof floors.$inferSelect;\n\n// Rooms table\nexport const rooms = pgTable(\"rooms\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  floorId: varchar(\"floor_id\").notNull(),\n  buildingId: varchar(\"building_id\").notNull(),\n  name: text(\"name\").notNull(),\n  type: text(\"type\").notNull(), // classroom, office, lab, etc.\n  description: text(\"description\"),\n  x: real(\"x\").notNull(), // X position on floor plan\n  y: real(\"y\").notNull(), // Y position on floor plan\n});\n\nexport const insertRoomSchema = createInsertSchema(rooms).omit({ id: true });\nexport type InsertRoom = z.infer<typeof insertRoomSchema>;\nexport type Room = typeof rooms.$inferSelect;\n\n// Staff table\nexport const staff = pgTable(\"staff\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  position: text(\"position\"),\n  department: text(\"department\"),\n  buildingId: varchar(\"building_id\"),\n  floorId: varchar(\"floor_id\"),\n  roomId: varchar(\"room_id\"),\n  email: text(\"email\"),\n  phone: text(\"phone\"),\n  photo: text(\"photo\"),\n});\n\nexport const insertStaffSchema = createInsertSchema(staff).omit({ id: true });\nexport type InsertStaff = z.infer<typeof insertStaffSchema>;\nexport type Staff = typeof staff.$inferSelect;\n\n// Event classification enum - PostgreSQL enum type\nexport const eventClassificationEnum = pgEnum(\"event_classification\", [\"Event\", \"Announcement\", \"Achievement\"]);\n\n// Event classification types for TypeScript\nexport const eventClassifications = [\n  \"Event\",\n  \"Announcement\",\n  \"Achievement\"\n] as const;\n\nexport type EventClassification = typeof eventClassifications[number];\n\n// Events table\nexport const events = pgTable(\"events\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  title: text(\"title\").notNull(),\n  description: text(\"description\"),\n  date: text(\"date\").notNull(),\n  time: text(\"time\"),\n  location: text(\"location\"),\n  buildingId: varchar(\"building_id\"),\n  image: text(\"image\"),\n  classification: eventClassificationEnum(\"classification\").notNull().default(\"Event\"),\n});\n\nexport const insertEventSchema = createInsertSchema(events).omit({ id: true }).extend({\n  classification: z.enum(eventClassifications).default(\"Event\"),\n});\nexport type InsertEvent = z.infer<typeof insertEventSchema>;\nexport type Event = typeof events.$inferSelect;\n\n// Walkpaths table - multi-node polylines for walking routes\nexport const walkpaths = pgTable(\"walkpaths\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\"),\n  nodes: jsonb(\"nodes\").notNull(), // Array of {lat, lng} objects\n});\n\nexport const insertWalkpathSchema = createInsertSchema(walkpaths).omit({ id: true });\nexport type InsertWalkpath = z.infer<typeof insertWalkpathSchema>;\nexport type Walkpath = typeof walkpaths.$inferSelect;\n\n// Drivepaths table - multi-node polylines for driving routes\nexport const drivepaths = pgTable(\"drivepaths\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\"),\n  nodes: jsonb(\"nodes\").notNull(), // Array of {lat, lng} objects\n});\n\nexport const insertDrivepathSchema = createInsertSchema(drivepaths).omit({ id: true });\nexport type InsertDrivepath = z.infer<typeof insertDrivepathSchema>;\nexport type Drivepath = typeof drivepaths.$inferSelect;\n\n// Admin users table\nexport const adminUsers = pgTable(\"admin_users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n});\n\nexport const insertAdminUserSchema = createInsertSchema(adminUsers).omit({ id: true });\nexport type InsertAdminUser = z.infer<typeof insertAdminUserSchema>;\nexport type AdminUser = typeof adminUsers.$inferSelect;\n\n// Settings table - for app configuration (inactivity timeout, etc.)\nexport const settings = pgTable(\"settings\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  key: text(\"key\").notNull().unique(),\n  value: text(\"value\").notNull(),\n  description: text(\"description\"),\n});\n\nexport const insertSettingSchema = createInsertSchema(settings).omit({ id: true });\nexport type InsertSetting = z.infer<typeof insertSettingSchema>;\nexport type Setting = typeof settings.$inferSelect;\n\n// TypeScript interfaces for complex data structures\nexport interface LatLng {\n  lat: number;\n  lng: number;\n}\n\nexport interface RouteStep {\n  instruction: string;\n  distance: string;\n  icon: string;\n}\n\nexport interface NavigationRoute {\n  start: Building;\n  end: Building;\n  mode: 'walking' | 'driving';\n  polyline: LatLng[];\n  steps: RouteStep[];\n  totalDistance: string;\n}\n","size_bytes":8352},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/pages/admin-dashboard.tsx":{"content":"import { useEffect } from \"react\";\nimport { useLocation } from \"wouter\";\nimport AdminLayout from \"@/components/admin-layout\";\n\nexport default function AdminDashboard() {\n  const [, setLocation] = useLocation();\n\n  useEffect(() => {\n    setLocation('/admin/buildings');\n  }, [setLocation]);\n\n  return (\n    <AdminLayout>\n      <div className=\"p-8\">\n        <div className=\"flex items-center justify-center h-96\">\n          <div className=\"animate-pulse text-muted-foreground\">Redirecting...</div>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","size_bytes":550},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"server/storage.ts":{"content":"import { randomUUID } from \"crypto\";\nimport { db } from \"./db\";\nimport { readFileSync } from \"fs\";\nimport { join } from \"path\";\nimport type {\n  Building, InsertBuilding,\n  Floor, InsertFloor,\n  Room, InsertRoom,\n  Staff, InsertStaff,\n  Event, InsertEvent,\n  Walkpath, InsertWalkpath,\n  Drivepath, InsertDrivepath,\n  AdminUser, InsertAdminUser,\n  Setting, InsertSetting\n} from \"@shared/schema\";\n\nlet usingFallback = false;\nlet fallbackData: any = null;\n\nfunction loadFallbackData() {\n  if (fallbackData) return fallbackData;\n  \n  try {\n    const dataPath = join(process.cwd(), 'data.json');\n    fallbackData = JSON.parse(readFileSync(dataPath, 'utf8'));\n    \n    if (!usingFallback) {\n      usingFallback = true;\n      console.warn('⚠️ FALLBACK MODE ACTIVATED: Using data.json because Firestore connection failed');\n      console.warn('⚠️ Please check your Firebase configuration and serviceAccountKey.json');\n    }\n    \n    return fallbackData;\n  } catch (error) {\n    console.error('❌ Failed to load fallback data from data.json:', error);\n    return { buildings: [], floors: [], rooms: [], staff: [], events: [], walkpaths: [], drivepaths: [], admins: [], settings: [] };\n  }\n}\n\nexport interface IStorage {\n  getBuildings(): Promise<Building[]>;\n  getBuilding(id: string): Promise<Building | undefined>;\n  createBuilding(building: InsertBuilding): Promise<Building>;\n  updateBuilding(id: string, building: InsertBuilding): Promise<Building | undefined>;\n  deleteBuilding(id: string): Promise<boolean>;\n\n  getFloors(): Promise<Floor[]>;\n  getFloor(id: string): Promise<Floor | undefined>;\n  getFloorsByBuilding(buildingId: string): Promise<Floor[]>;\n  createFloor(floor: InsertFloor): Promise<Floor>;\n  updateFloor(id: string, floor: InsertFloor): Promise<Floor | undefined>;\n  deleteFloor(id: string): Promise<boolean>;\n\n  getRooms(): Promise<Room[]>;\n  getRoom(id: string): Promise<Room | undefined>;\n  getRoomsByFloor(floorId: string): Promise<Room[]>;\n  getRoomsByBuilding(buildingId: string): Promise<Room[]>;\n  createRoom(room: InsertRoom): Promise<Room>;\n  updateRoom(id: string, room: InsertRoom): Promise<Room | undefined>;\n  deleteRoom(id: string): Promise<boolean>;\n\n  getStaff(): Promise<Staff[]>;\n  getStaffMember(id: string): Promise<Staff | undefined>;\n  getStaffByBuilding(buildingId: string): Promise<Staff[]>;\n  createStaff(staff: InsertStaff): Promise<Staff>;\n  updateStaff(id: string, staff: InsertStaff): Promise<Staff | undefined>;\n  deleteStaff(id: string): Promise<boolean>;\n\n  getEvents(): Promise<Event[]>;\n  getEvent(id: string): Promise<Event | undefined>;\n  createEvent(event: InsertEvent): Promise<Event>;\n  updateEvent(id: string, event: InsertEvent): Promise<Event | undefined>;\n  deleteEvent(id: string): Promise<boolean>;\n\n  getWalkpaths(): Promise<Walkpath[]>;\n  getWalkpath(id: string): Promise<Walkpath | undefined>;\n  createWalkpath(walkpath: InsertWalkpath): Promise<Walkpath>;\n  updateWalkpath(id: string, walkpath: InsertWalkpath): Promise<Walkpath | undefined>;\n  deleteWalkpath(id: string): Promise<boolean>;\n\n  getDrivepaths(): Promise<Drivepath[]>;\n  getDrivepath(id: string): Promise<Drivepath | undefined>;\n  createDrivepath(drivepath: InsertDrivepath): Promise<Drivepath>;\n  updateDrivepath(id: string, drivepath: InsertDrivepath): Promise<Drivepath | undefined>;\n  deleteDrivepath(id: string): Promise<boolean>;\n\n  getAdminByUsername(username: string): Promise<AdminUser | undefined>;\n  createAdmin(admin: InsertAdminUser): Promise<AdminUser>;\n\n  getSettings(): Promise<Setting[]>;\n  getSetting(key: string): Promise<Setting | undefined>;\n  createSetting(setting: InsertSetting): Promise<Setting>;\n  updateSetting(key: string, value: string): Promise<Setting | undefined>;\n\n  exportToJSON(): Promise<void>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // Buildings\n  async getBuildings(): Promise<Building[]> {\n    try {\n      const snapshot = await db.collection('buildings').get();\n      return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as Building));\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.buildings || [];\n    }\n  }\n\n  async getBuilding(id: string): Promise<Building | undefined> {\n    try {\n      const doc = await db.collection('buildings').doc(id).get();\n      if (!doc.exists) return undefined;\n      return { id: doc.id, ...doc.data() } as Building;\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.buildings?.find((b: Building) => b.id === id);\n    }\n  }\n\n  async createBuilding(insertBuilding: InsertBuilding): Promise<Building> {\n    try {\n      const id = randomUUID();\n      const building = { ...insertBuilding, id, markerIcon: insertBuilding.markerIcon || \"building\" } as Building;\n      await db.collection('buildings').doc(id).set(building);\n      return building;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot create building in fallback mode');\n    }\n  }\n\n  async updateBuilding(id: string, insertBuilding: InsertBuilding): Promise<Building | undefined> {\n    try {\n      const building = { ...insertBuilding, id, markerIcon: insertBuilding.markerIcon || \"building\" } as Building;\n      await db.collection('buildings').doc(id).set(building);\n      return building;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot update building in fallback mode');\n    }\n  }\n\n  async deleteBuilding(id: string): Promise<boolean> {\n    try {\n      await db.collection('buildings').doc(id).delete();\n      return true;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot delete building in fallback mode');\n    }\n  }\n\n  // Floors\n  async getFloors(): Promise<Floor[]> {\n    try {\n      const snapshot = await db.collection('floors').get();\n      return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as Floor));\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.floors || [];\n    }\n  }\n\n  async getFloor(id: string): Promise<Floor | undefined> {\n    try {\n      const doc = await db.collection('floors').doc(id).get();\n      if (!doc.exists) return undefined;\n      return { id: doc.id, ...doc.data() } as Floor;\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.floors?.find((f: Floor) => f.id === id);\n    }\n  }\n\n  async getFloorsByBuilding(buildingId: string): Promise<Floor[]> {\n    try {\n      const snapshot = await db.collection('floors').where('buildingId', '==', buildingId).get();\n      return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as Floor));\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.floors?.filter((f: Floor) => f.buildingId === buildingId) || [];\n    }\n  }\n\n  async createFloor(insertFloor: InsertFloor): Promise<Floor> {\n    try {\n      const id = randomUUID();\n      const floor = { ...insertFloor, id } as Floor;\n      await db.collection('floors').doc(id).set(floor);\n      return floor;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot create floor in fallback mode');\n    }\n  }\n\n  async updateFloor(id: string, insertFloor: InsertFloor): Promise<Floor | undefined> {\n    try {\n      const floor = { ...insertFloor, id } as Floor;\n      await db.collection('floors').doc(id).set(floor);\n      return floor;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot update floor in fallback mode');\n    }\n  }\n\n  async deleteFloor(id: string): Promise<boolean> {\n    try {\n      await db.collection('floors').doc(id).delete();\n      return true;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot delete floor in fallback mode');\n    }\n  }\n\n  // Rooms\n  async getRooms(): Promise<Room[]> {\n    try {\n      const snapshot = await db.collection('rooms').get();\n      return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as Room));\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.rooms || [];\n    }\n  }\n\n  async getRoom(id: string): Promise<Room | undefined> {\n    try {\n      const doc = await db.collection('rooms').doc(id).get();\n      if (!doc.exists) return undefined;\n      return { id: doc.id, ...doc.data() } as Room;\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.rooms?.find((r: Room) => r.id === id);\n    }\n  }\n\n  async getRoomsByFloor(floorId: string): Promise<Room[]> {\n    try {\n      const snapshot = await db.collection('rooms').where('floorId', '==', floorId).get();\n      return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as Room));\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.rooms?.filter((r: Room) => r.floorId === floorId) || [];\n    }\n  }\n\n  async getRoomsByBuilding(buildingId: string): Promise<Room[]> {\n    try {\n      const snapshot = await db.collection('rooms').where('buildingId', '==', buildingId).get();\n      return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as Room));\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.rooms?.filter((r: Room) => r.buildingId === buildingId) || [];\n    }\n  }\n\n  async createRoom(insertRoom: InsertRoom): Promise<Room> {\n    try {\n      const id = randomUUID();\n      const room = { ...insertRoom, id } as Room;\n      await db.collection('rooms').doc(id).set(room);\n      return room;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot create room in fallback mode');\n    }\n  }\n\n  async updateRoom(id: string, insertRoom: InsertRoom): Promise<Room | undefined> {\n    try {\n      const room = { ...insertRoom, id } as Room;\n      await db.collection('rooms').doc(id).set(room);\n      return room;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot update room in fallback mode');\n    }\n  }\n\n  async deleteRoom(id: string): Promise<boolean> {\n    try {\n      await db.collection('rooms').doc(id).delete();\n      return true;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot delete room in fallback mode');\n    }\n  }\n\n  // Staff\n  async getStaff(): Promise<Staff[]> {\n    try {\n      const snapshot = await db.collection('staff').get();\n      return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as Staff));\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.staff || [];\n    }\n  }\n\n  async getStaffMember(id: string): Promise<Staff | undefined> {\n    try {\n      const doc = await db.collection('staff').doc(id).get();\n      if (!doc.exists) return undefined;\n      return { id: doc.id, ...doc.data() } as Staff;\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.staff?.find((s: Staff) => s.id === id);\n    }\n  }\n\n  async getStaffByBuilding(buildingId: string): Promise<Staff[]> {\n    try {\n      const snapshot = await db.collection('staff').where('buildingId', '==', buildingId).get();\n      return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as Staff));\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.staff?.filter((s: Staff) => s.buildingId === buildingId) || [];\n    }\n  }\n\n  async createStaff(insertStaff: InsertStaff): Promise<Staff> {\n    try {\n      const id = randomUUID();\n      const staffMember = { ...insertStaff, id } as Staff;\n      await db.collection('staff').doc(id).set(staffMember);\n      return staffMember;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot create staff in fallback mode');\n    }\n  }\n\n  async updateStaff(id: string, insertStaff: InsertStaff): Promise<Staff | undefined> {\n    try {\n      const staffMember = { ...insertStaff, id } as Staff;\n      await db.collection('staff').doc(id).set(staffMember);\n      return staffMember;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot update staff in fallback mode');\n    }\n  }\n\n  async deleteStaff(id: string): Promise<boolean> {\n    try {\n      await db.collection('staff').doc(id).delete();\n      return true;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot delete staff in fallback mode');\n    }\n  }\n\n  // Events\n  async getEvents(): Promise<Event[]> {\n    try {\n      const snapshot = await db.collection('events').get();\n      return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as Event));\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.events || [];\n    }\n  }\n\n  async getEvent(id: string): Promise<Event | undefined> {\n    try {\n      const doc = await db.collection('events').doc(id).get();\n      if (!doc.exists) return undefined;\n      return { id: doc.id, ...doc.data() } as Event;\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.events?.find((e: Event) => e.id === id);\n    }\n  }\n\n  async createEvent(insertEvent: InsertEvent): Promise<Event> {\n    try {\n      const id = randomUUID();\n      const event = { ...insertEvent, id, classification: insertEvent.classification || \"Event\" } as Event;\n      await db.collection('events').doc(id).set(event);\n      return event;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot create event in fallback mode');\n    }\n  }\n\n  async updateEvent(id: string, insertEvent: InsertEvent): Promise<Event | undefined> {\n    try {\n      const event = { ...insertEvent, id, classification: insertEvent.classification || \"Event\" } as Event;\n      await db.collection('events').doc(id).set(event);\n      return event;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot update event in fallback mode');\n    }\n  }\n\n  async deleteEvent(id: string): Promise<boolean> {\n    try {\n      await db.collection('events').doc(id).delete();\n      return true;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot delete event in fallback mode');\n    }\n  }\n\n  // Walkpaths\n  async getWalkpaths(): Promise<Walkpath[]> {\n    try {\n      const snapshot = await db.collection('walkpaths').get();\n      return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as Walkpath));\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.walkpaths || [];\n    }\n  }\n\n  async getWalkpath(id: string): Promise<Walkpath | undefined> {\n    try {\n      const doc = await db.collection('walkpaths').doc(id).get();\n      if (!doc.exists) return undefined;\n      return { id: doc.id, ...doc.data() } as Walkpath;\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.walkpaths?.find((w: Walkpath) => w.id === id);\n    }\n  }\n\n  async createWalkpath(insertWalkpath: InsertWalkpath): Promise<Walkpath> {\n    try {\n      const id = randomUUID();\n      const walkpath = { ...insertWalkpath, id } as Walkpath;\n      await db.collection('walkpaths').doc(id).set(walkpath);\n      return walkpath;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot create walkpath in fallback mode');\n    }\n  }\n\n  async updateWalkpath(id: string, insertWalkpath: InsertWalkpath): Promise<Walkpath | undefined> {\n    try {\n      const walkpath = { ...insertWalkpath, id } as Walkpath;\n      await db.collection('walkpaths').doc(id).set(walkpath);\n      return walkpath;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot update walkpath in fallback mode');\n    }\n  }\n\n  async deleteWalkpath(id: string): Promise<boolean> {\n    try {\n      await db.collection('walkpaths').doc(id).delete();\n      return true;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot delete walkpath in fallback mode');\n    }\n  }\n\n  // Drivepaths\n  async getDrivepaths(): Promise<Drivepath[]> {\n    try {\n      const snapshot = await db.collection('drivepaths').get();\n      return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as Drivepath));\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.drivepaths || [];\n    }\n  }\n\n  async getDrivepath(id: string): Promise<Drivepath | undefined> {\n    try {\n      const doc = await db.collection('drivepaths').doc(id).get();\n      if (!doc.exists) return undefined;\n      return { id: doc.id, ...doc.data() } as Drivepath;\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.drivepaths?.find((d: Drivepath) => d.id === id);\n    }\n  }\n\n  async createDrivepath(insertDrivepath: InsertDrivepath): Promise<Drivepath> {\n    try {\n      const id = randomUUID();\n      const drivepath = { ...insertDrivepath, id } as Drivepath;\n      await db.collection('drivepaths').doc(id).set(drivepath);\n      return drivepath;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot create drivepath in fallback mode');\n    }\n  }\n\n  async updateDrivepath(id: string, insertDrivepath: InsertDrivepath): Promise<Drivepath | undefined> {\n    try {\n      const drivepath = { ...insertDrivepath, id } as Drivepath;\n      await db.collection('drivepaths').doc(id).set(drivepath);\n      return drivepath;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot update drivepath in fallback mode');\n    }\n  }\n\n  async deleteDrivepath(id: string): Promise<boolean> {\n    try {\n      await db.collection('drivepaths').doc(id).delete();\n      return true;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot delete drivepath in fallback mode');\n    }\n  }\n\n  // Admin\n  async getAdminByUsername(username: string): Promise<AdminUser | undefined> {\n    try {\n      const snapshot = await db.collection('admins').where('username', '==', username).get();\n      if (snapshot.empty) return undefined;\n      const doc = snapshot.docs[0];\n      return { id: doc.id, ...doc.data() } as AdminUser;\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.admins?.find((a: AdminUser) => a.username === username);\n    }\n  }\n\n  async createAdmin(insertAdmin: InsertAdminUser): Promise<AdminUser> {\n    try {\n      const id = randomUUID();\n      const admin: AdminUser = { ...insertAdmin, id };\n      await db.collection('admins').doc(id).set(admin);\n      return admin;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot create admin in fallback mode');\n    }\n  }\n\n  // Settings\n  async getSettings(): Promise<Setting[]> {\n    try {\n      const snapshot = await db.collection('settings').get();\n      return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as Setting));\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.settings || [];\n    }\n  }\n\n  async getSetting(key: string): Promise<Setting | undefined> {\n    try {\n      const snapshot = await db.collection('settings').where('key', '==', key).get();\n      if (snapshot.empty) return undefined;\n      const doc = snapshot.docs[0];\n      return { id: doc.id, ...doc.data() } as Setting;\n    } catch (error) {\n      console.error('Firestore error, using fallback:', error);\n      const data = loadFallbackData();\n      return data.settings?.find((s: Setting) => s.key === key);\n    }\n  }\n\n  async createSetting(insertSetting: InsertSetting): Promise<Setting> {\n    try {\n      const id = randomUUID();\n      const setting: Setting = { ...insertSetting, id };\n      await db.collection('settings').doc(id).set(setting);\n      return setting;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot create setting in fallback mode');\n    }\n  }\n\n  async updateSetting(key: string, value: string): Promise<Setting | undefined> {\n    try {\n      const existing = await this.getSetting(key);\n      if (!existing) {\n        return undefined;\n      }\n      const updated: Setting = { \n        id: existing.id,\n        key: existing.key,\n        value,\n        description: existing.description || null\n      };\n      await db.collection('settings').doc(existing.id).set(updated);\n      return updated;\n    } catch (error) {\n      console.error('Firestore error:', error);\n      throw new Error('Cannot update setting in fallback mode');\n    }\n  }\n\n  async exportToJSON(): Promise<void> {\n    console.log('Export to JSON skipped - Firestore is the source of truth');\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","size_bytes":21989},"design_guidelines.md":{"content":"# iCCAT Smart Campus Kiosk - Design Guidelines\n\n## Design Approach\n\n**Selected Approach:** Material Design System (adapted for kiosk/touch interface)\n\n**Rationale:** This information kiosk requires clear information hierarchy, touch-optimized interactions, and robust component patterns for maps, modals, forms, and data displays. Material Design provides the structure needed for a public-facing utility application while maintaining visual appeal.\n\n**Core Principles:**\n- Touch-first interaction design with large tap targets (minimum 48px)\n- Clear visual hierarchy for wayfinding and information discovery\n- Professional academic aesthetic with approachable warmth\n- Immediate comprehension - users should understand functionality at a glance\n- Consistent patterns across admin and public-facing interfaces\n\n---\n\n## Typography\n\n**Font Stack:**\n- Primary: 'Roboto' (via Google Fonts CDN)\n- Monospace: 'Roboto Mono' for codes/room numbers\n\n**Hierarchy:**\n- H1 (Landing/Module Titles): 48px/font-bold - Large kiosk-friendly headers\n- H2 (Section Headers): 32px/font-semibold - Modal titles, panel headers\n- H3 (Subsections): 24px/font-medium - Building names, card titles\n- Body Large: 18px/font-normal - Primary content, descriptions\n- Body: 16px/font-normal - Secondary text, labels\n- Caption: 14px/font-normal - Metadata, timestamps, helper text\n- Button Text: 16-18px/font-medium - All-caps for primary actions\n\n---\n\n## Layout System\n\n**Spacing Primitives:** Tailwind units of 2, 4, 6, 8, 12, 16 (p-2, h-8, m-4, gap-6, etc.)\n\n**Grid Structures:**\n- Landing Page: 2-column grid (lg:grid-cols-2) for main action buttons\n- Admin Panels: Sidebar (w-64) + main content area (flex-1)\n- Staff/Event Cards: 3-column grid (lg:grid-cols-3, md:grid-cols-2, grid-cols-1)\n- Floor Plan Editor: Full viewport with floating toolbars\n\n**Container Strategy:**\n- Landing: Full viewport sections (min-h-screen)\n- Content Modules: max-w-7xl centered containers with px-6 py-8\n- Modals: max-w-2xl for information, max-w-4xl for editors, max-w-6xl for maps\n- Admin Forms: max-w-xl for optimal form width\n\n**Vertical Rhythm:** py-8 for section padding, py-4 for card interiors, py-2 for tight groupings\n\n---\n\n## Component Library\n\n### Navigation & Landing\n\n**Landing Page Buttons:**\n- Large card-style buttons (min-h-40) with icons (64px) above text\n- 4-button grid layout with ample spacing (gap-6)\n- Elevated appearance with shadow-lg and subtle hover lift\n- Icon + Title + Subtitle pattern\n\n**Admin Access Link:**\n- Small text link at page bottom (text-sm underline)\n\n### Map Interface\n\n**Map Container:**\n- Full height of viewport minus header (h-[calc(100vh-4rem)])\n- Leaflet controls positioned top-right with elevated panels\n- Building markers: Custom colored pins with building icons\n- Selected state: Larger scale + pulsing animation\n\n**Map Controls:**\n- Floating white panels (bg-white shadow-lg rounded-lg p-4)\n- Positioned absolutely over map\n- Z-index layering: Controls (50) > Markers (30) > Base map (10)\n\n### Building Information Modal\n\n**Structure:**\n- Draggable modal with header handle\n- Image preview area at top (aspect-video)\n- Tabbed content: Overview | Staff | Floor Plans\n- Fixed footer with action buttons\n- Close button (top-right icon)\n\n**Content Layout:**\n- Two-column layout for metadata (grid-cols-2 gap-4)\n- List views for staff/departments with avatar chips\n- Floor preview thumbnails in horizontal scroll\n\n### Navigation System\n\n**Route Display:**\n- Colored polyline on map (blue for walking, green for driving, stroke-width: 6)\n- Start/end markers with custom icons\n- Side panel (w-80) with step-by-step directions\n- Each step: Icon + instruction + distance\n\n**Direction Steps:**\n- Numbered circles (40px) with step numbers\n- Turn icons from Heroicons\n- Distance badges on right\n- Active step highlighted\n\n### Floor Plan Viewer\n\n**Viewer Interface:**\n- Pannable/zoomable canvas (similar to map)\n- Room markers as colored circles with labels\n- Zoom controls in corner\n- Floor selector tabs at top\n\n**Room Markers:**\n- Circular badges (w-8 h-8) with room numbers\n- Color-coded by type (classroom: blue, office: green, lab: purple)\n- Tooltip on hover/tap showing room details\n- Click opens room info modal\n\n### Staff Directory\n\n**Search Interface:**\n- Prominent search bar (h-12) with icon\n- Filter chips below (building, department)\n- Real-time results as cards\n\n**Staff Cards:**\n- Horizontal layout: Avatar (w-16 h-16 rounded-full) | Info\n- Name (text-lg font-semibold)\n- Position/Department (text-sm text-gray-600)\n- Building/Room (text-sm with location icon)\n- Click for detailed modal\n\n### Events & Announcements\n\n**Event Cards:**\n- Vertical card layout with image header (aspect-video object-cover)\n- Date badge overlaying top-left corner\n- Title (text-xl font-semibold)\n- Excerpt (3 lines, truncated)\n- \"Read More\" link\n\n**Event Modal:**\n- Full event image at top\n- Date/time/location metadata row\n- Full description with proper paragraph spacing\n\n### Admin Panel\n\n**Layout:**\n- Left sidebar (w-64): Navigation menu with icons\n- Main content: Contextual editors\n- Top bar: Current module title + logout\n\n**Form Components:**\n- Label above input pattern\n- Input fields (h-12 rounded-lg border-2)\n- Grouped fields with gap-4\n- Action buttons right-aligned at bottom\n- Cancel (ghost) + Save (primary) pattern\n\n**Data Tables:**\n- Zebra striping (even:bg-gray-50)\n- Action column on right with icon buttons\n- Sortable headers with arrow indicators\n- Row height: h-16 for touch targets\n\n**Map Editors:**\n- Drawing toolbar (top of map)\n- Tool buttons in horizontal row\n- Active tool state: filled background\n- Node handles: draggable circles (w-4 h-4) on paths\n\n### Buttons & Actions\n\n**Primary Button:**\n- Solid fill, rounded-lg, px-6 py-3, font-medium\n- Touch-friendly minimum size (h-12)\n- Elevated with shadow\n\n**Secondary Button:**\n- Border-2, rounded-lg, px-6 py-3\n- Transparent background\n\n**Icon Buttons:**\n- Square (w-12 h-12), rounded-full for floating actions\n- Icon centered (w-6 h-6)\n\n**Floating Action Button (FAB):**\n- Large circular button (w-16 h-16)\n- Fixed position bottom-right\n- Shadow-xl with hover lift\n\n### Modals & Overlays\n\n**Modal Backdrop:**\n- Semi-transparent overlay (bg-black/50)\n- Blur effect (backdrop-blur-sm)\n\n**Modal Container:**\n- Centered, elevated card (shadow-2xl)\n- Rounded-xl corners\n- Padding: p-6\n- Slide-up entrance animation\n\n**Toast Notifications:**\n- Fixed top-right position\n- Auto-dismiss after 3 seconds\n- Icon + message + close button\n- Slide-in animation\n\n---\n\n## Interaction Patterns\n\n**Touch Optimization:**\n- All interactive elements minimum 48x48px\n- Increased spacing between clickable items (gap-4 minimum)\n- No hover-dependent interactions\n- Clear pressed states (scale-95 active state)\n\n**Loading States:**\n- Skeleton screens for data loading\n- Spinner overlay for map operations\n- Progress indicators for file uploads\n\n**Feedback:**\n- Immediate visual response to all taps\n- Success/error toasts for admin actions\n- Inline validation for forms\n\n**Animations:**\n- Subtle page transitions (fade/slide)\n- Modal entrance: slide-up with fade\n- Button press: scale feedback\n- Map marker selection: bounce animation\n- NO decorative animations - keep functional only\n\n---\n\n## Images\n\n**Landing Page:**\n- Background: University campus panorama or iconic building (full viewport, subtle overlay for readability)\n- Positioned behind button grid with gradient overlay (from-black/60 to-black/30)\n\n**Building Modals:**\n- Building exterior photos (aspect-video) at modal header\n- Placeholder: Generic university building silhouette if no image\n\n**Floor Plans:**\n- Uploaded architectural floor plan images\n- Displayed as pannable/zoomable images\n\n**Staff Photos:**\n- Headshot portraits (square, 1:1 ratio)\n- Placeholder: Generic avatar icon for missing photos\n\n**Event Cards:**\n- Event-specific images (aspect-video, 16:9)\n- Placeholder: Calendar icon graphic for events without images\n\n---\n\nThis design system creates a professional, highly functional kiosk interface optimized for public use while maintaining the flexibility needed for comprehensive admin tools.","size_bytes":8124},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-[1000] bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-[1000] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4428},"client/src/pages/staff.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { ArrowLeft, Search, MapPin, Mail, Phone, Navigation } from \"lucide-react\";\nimport { Link, useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport GetDirectionsDialog from \"@/components/get-directions-dialog\";\nimport type { Staff, Building } from \"@shared/schema\";\nimport { useGlobalInactivity } from \"@/hooks/use-inactivity\";\n\nexport default function StaffDirectory() {\n  // Return to home after 3 minutes of inactivity\n  useGlobalInactivity();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [buildingFilter, setBuildingFilter] = useState<string>(\"all\");\n  const [departmentFilter, setDepartmentFilter] = useState<string>(\"all\");\n  const [selectedStaff, setSelectedStaff] = useState<Staff | null>(null);\n  const [showDirections, setShowDirections] = useState(false);\n  const [directionsDestination, setDirectionsDestination] = useState<string | null>(null);\n  const [, navigate] = useLocation();\n\n  const { data: staff = [], isLoading } = useQuery<Staff[]>({\n    queryKey: ['/api/staff']\n  });\n\n  const { data: buildings = [] } = useQuery<Building[]>({\n    queryKey: ['/api/buildings']\n  });\n\n  // Filter buildings to only show those that have staff assigned\n  const buildingsWithStaff = buildings.filter(building => \n    staff.some(member => member.buildingId === building.id)\n  );\n\n  const departments = Array.from(new Set(staff.map(s => s.department).filter(Boolean)));\n\n  const filteredStaff = staff.filter(member => {\n    const matchesSearch = !searchQuery || \n      member.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      member.position?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      member.department?.toLowerCase().includes(searchQuery.toLowerCase());\n    \n    const matchesBuilding = buildingFilter === \"all\" || member.buildingId === buildingFilter;\n    const matchesDepartment = departmentFilter === \"all\" || member.department === departmentFilter;\n\n    return matchesSearch && matchesBuilding && matchesDepartment;\n  });\n\n  const getBuildingName = (buildingId: string | null | undefined) => {\n    if (!buildingId) return \"Not assigned\";\n    const building = buildings.find(b => b.id === buildingId);\n    return building?.name || \"Unknown\";\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"bg-card border-b border-card-border p-4 sticky top-0 z-10\">\n        <div className=\"max-w-7xl mx-auto flex items-center gap-4\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"icon\" data-testid=\"button-back\">\n              <ArrowLeft className=\"w-5 h-5\" />\n            </Button>\n          </Link>\n          <div>\n            <h1 className=\"text-2xl font-semibold text-foreground\">Staff Directory</h1>\n            <p className=\"text-sm text-muted-foreground\">Find faculty and staff members</p>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"max-w-7xl mx-auto px-6 py-8\">\n        <div className=\"mb-8 space-y-4\">\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-muted-foreground\" />\n            <Input\n              type=\"search\"\n              placeholder=\"Search by name, position, or department...\"\n              className=\"pl-10 h-12\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              data-testid=\"input-search-staff\"\n            />\n          </div>\n\n          <div className=\"flex flex-wrap gap-4\">\n            <div className=\"flex-1 min-w-64\">\n              <Select value={buildingFilter} onValueChange={setBuildingFilter}>\n                <SelectTrigger data-testid=\"select-building-filter\">\n                  <SelectValue placeholder=\"Filter by building\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Buildings</SelectItem>\n                  {buildingsWithStaff.map(building => (\n                    <SelectItem key={building.id} value={building.id}>\n                      {building.name}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"flex-1 min-w-64\">\n              <Select value={departmentFilter} onValueChange={setDepartmentFilter}>\n                <SelectTrigger data-testid=\"select-department-filter\">\n                  <SelectValue placeholder=\"Filter by department\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Departments</SelectItem>\n                  {departments.map(dept => (\n                    <SelectItem key={dept} value={dept!}>\n                      {dept}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n        </div>\n\n        {isLoading ? (\n          <div className=\"grid lg:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-4\">\n            {[1, 2, 3, 4, 5, 6].map((i) => (\n              <Card key={i} className=\"h-40 animate-pulse bg-muted\" />\n            ))}\n          </div>\n        ) : filteredStaff.length === 0 ? (\n          <div className=\"text-center py-16\">\n            <Search className=\"w-16 h-16 text-muted-foreground mx-auto mb-4\" />\n            <h3 className=\"text-xl font-medium text-foreground mb-2\">No Staff Found</h3>\n            <p className=\"text-muted-foreground\">\n              {searchQuery || buildingFilter !== \"all\" || departmentFilter !== \"all\"\n                ? \"Try adjusting your search filters\"\n                : \"No staff members have been added yet\"}\n            </p>\n          </div>\n        ) : (\n          <div className=\"grid lg:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-4\">\n            {filteredStaff.map((member) => (\n              <Card\n                key={member.id}\n                className=\"p-6 hover-elevate active-elevate-2 cursor-pointer\"\n                data-testid={`staff-card-${member.id}`}\n                onClick={() => setSelectedStaff(member)}\n              >\n                <div className=\"flex items-start gap-4 mb-4\">\n                  <Avatar className=\"w-16 h-16\">\n                    <AvatarImage src={member.photo || undefined} alt={member.name} />\n                    <AvatarFallback className=\"bg-primary text-primary-foreground text-lg\">\n                      {member.name.split(' ').map(n => n[0]).join('').slice(0, 2)}\n                    </AvatarFallback>\n                  </Avatar>\n                  <div className=\"flex-1\">\n                    <h3 className=\"text-lg font-semibold text-foreground\">{member.name}</h3>\n                    {member.position && (\n                      <p className=\"text-sm text-muted-foreground\">{member.position}</p>\n                    )}\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  {member.department && (\n                    <div className=\"flex items-center gap-2\">\n                      <Badge variant=\"secondary\" className=\"text-xs\">\n                        {member.department}\n                      </Badge>\n                    </div>\n                  )}\n\n                  <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                    <MapPin className=\"w-4 h-4 flex-shrink-0\" />\n                    <span className=\"truncate\">{getBuildingName(member.buildingId)}</span>\n                  </div>\n\n                  {member.email && (\n                    <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                      <Mail className=\"w-4 h-4 flex-shrink-0\" />\n                      <span className=\"truncate\">{member.email}</span>\n                    </div>\n                  )}\n\n                  {member.phone && (\n                    <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                      <Phone className=\"w-4 h-4 flex-shrink-0\" />\n                      <span>{member.phone}</span>\n                    </div>\n                  )}\n                </div>\n              </Card>\n            ))}\n          </div>\n        )}\n      </main>\n\n      {/* Staff Detail Dialog */}\n      <Dialog \n        open={!!selectedStaff && !showDirections} \n        onOpenChange={(open) => {\n          if (!open) {\n            setSelectedStaff(null);\n          }\n        }}\n      >\n        <DialogContent className=\"sm:max-w-md\" data-testid=\"dialog-staff-detail\">\n          <DialogHeader>\n            <DialogTitle>Staff Information</DialogTitle>\n          </DialogHeader>\n          \n          {selectedStaff && (\n            <div className=\"space-y-6\">\n              <div className=\"flex items-start gap-4\">\n                <Avatar className=\"w-20 h-20\">\n                  <AvatarImage src={selectedStaff.photo || undefined} alt={selectedStaff.name} />\n                  <AvatarFallback className=\"bg-primary text-primary-foreground text-xl\">\n                    {selectedStaff.name.split(' ').map(n => n[0]).join('').slice(0, 2)}\n                  </AvatarFallback>\n                </Avatar>\n                <div className=\"flex-1\">\n                  <h3 className=\"text-xl font-semibold text-foreground mb-1\">{selectedStaff.name}</h3>\n                  {selectedStaff.position && (\n                    <p className=\"text-muted-foreground\">{selectedStaff.position}</p>\n                  )}\n                  {selectedStaff.department && (\n                    <Badge variant=\"secondary\" className=\"mt-2\">\n                      {selectedStaff.department}\n                    </Badge>\n                  )}\n                </div>\n              </div>\n\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center gap-3 text-muted-foreground\">\n                  <MapPin className=\"w-5 h-5\" />\n                  <span>{getBuildingName(selectedStaff.buildingId)}</span>\n                </div>\n\n                {selectedStaff.email && (\n                  <div className=\"flex items-center gap-3 text-muted-foreground\">\n                    <Mail className=\"w-5 h-5\" />\n                    <span className=\"break-all\">{selectedStaff.email}</span>\n                  </div>\n                )}\n\n                {selectedStaff.phone && (\n                  <div className=\"flex items-center gap-3 text-muted-foreground\">\n                    <Phone className=\"w-5 h-5\" />\n                    <span>{selectedStaff.phone}</span>\n                  </div>\n                )}\n              </div>\n\n              {selectedStaff.buildingId && buildings.find(b => b.id === selectedStaff.buildingId) && (\n                <div className=\"pt-6 border-t border-border\">\n                  <Button\n                    onClick={() => {\n                      const building = buildings.find(b => b.id === selectedStaff.buildingId);\n                      if (building) {\n                        setDirectionsDestination(selectedStaff.buildingId);\n                        setShowDirections(true);\n                      }\n                    }}\n                    className=\"w-full\"\n                    data-testid=\"button-staff-get-directions\"\n                  >\n                    <Navigation className=\"w-4 h-4 mr-2\" />\n                    Get Directions\n                  </Button>\n                </div>\n              )}\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n\n      {/* Get Directions Dialog */}\n      {showDirections && directionsDestination && (\n        <GetDirectionsDialog\n          open={showDirections}\n          destination={buildings.find(b => b.id === directionsDestination) || null}\n          buildings={buildings}\n          onClose={() => {\n            setShowDirections(false);\n            setDirectionsDestination(null);\n          }}\n          onNavigate={(startId: string, mode: 'walking' | 'driving') => {\n            navigate(`/navigation?from=${startId}&to=${directionsDestination}&mode=${mode}`);\n            setShowDirections(false);\n            setDirectionsDestination(null);\n            setSelectedStaff(null);\n          }}\n        />\n      )}\n    </div>\n  );\n}\n","size_bytes":12665},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"client/src/pages/admin-events.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Plus, Pencil, Trash2, Calendar as CalendarIcon } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport AdminLayout from \"@/components/admin-layout\";\nimport type { Event, InsertEvent, Building } from \"@shared/schema\";\nimport { eventClassifications } from \"@shared/schema\";\n\nexport default function AdminEvents() {\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingEvent, setEditingEvent] = useState<Event | null>(null);\n  const [formData, setFormData] = useState<InsertEvent>({\n    title: \"\",\n    description: \"\",\n    date: \"\",\n    time: \"\",\n    location: \"\",\n    buildingId: null,\n    image: \"\",\n    classification: \"Event\",\n  });\n  const { toast } = useToast();\n\n  const { data: events = [], isLoading } = useQuery<Event[]>({\n    queryKey: ['/api/events']\n  });\n\n  const { data: buildings = [] } = useQuery<Building[]>({\n    queryKey: ['/api/buildings']\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: InsertEvent) => apiRequest('POST', '/api/events', data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/events'] });\n      toast({ title: \"Event created successfully\" });\n      handleCloseDialog();\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: InsertEvent }) =>\n      apiRequest('PUT', `/api/events/${id}`, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/events'] });\n      toast({ title: \"Event updated successfully\" });\n      handleCloseDialog();\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: string) => apiRequest('DELETE', `/api/events/${id}`, null),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/events'] });\n      toast({ title: \"Event deleted successfully\" });\n    },\n  });\n\n  const handleOpenDialog = (event?: Event) => {\n    if (event) {\n      setEditingEvent(event);\n      setFormData({\n        title: event.title,\n        description: event.description || \"\",\n        date: event.date,\n        time: event.time || \"\",\n        location: event.location || \"\",\n        buildingId: event.buildingId || null,\n        image: event.image || \"\",\n        classification: event.classification || \"Event\",\n      });\n    } else {\n      setEditingEvent(null);\n      const today = new Date().toISOString().split('T')[0];\n      setFormData({\n        title: \"\",\n        description: \"\",\n        date: today,\n        time: \"\",\n        location: \"\",\n        buildingId: null,\n        image: \"\",\n        classification: \"Event\",\n      });\n    }\n    setIsDialogOpen(true);\n  };\n\n  const handleCloseDialog = () => {\n    setIsDialogOpen(false);\n    setEditingEvent(null);\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (editingEvent) {\n      updateMutation.mutate({ id: editingEvent.id, data: formData });\n    } else {\n      createMutation.mutate(formData);\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"p-8\">\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-foreground\">Events Management</h1>\n            <p className=\"text-muted-foreground\">Manage campus events and announcements</p>\n          </div>\n          <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n            <DialogTrigger asChild>\n              <Button onClick={() => handleOpenDialog()} data-testid=\"button-add-event\">\n                <Plus className=\"w-4 h-4 mr-2\" />\n                Add Event\n              </Button>\n            </DialogTrigger>\n            <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n              <DialogHeader>\n                <DialogTitle>\n                  {editingEvent ? \"Edit Event\" : \"Add New Event\"}\n                </DialogTitle>\n              </DialogHeader>\n              <form onSubmit={handleSubmit} className=\"space-y-6\">\n                <div>\n                  <Label htmlFor=\"title\">Event Title *</Label>\n                  <Input\n                    id=\"title\"\n                    value={formData.title}\n                    onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                    required\n                    data-testid=\"input-event-title\"\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"description\">Description</Label>\n                  <Textarea\n                    id=\"description\"\n                    value={formData.description || \"\"}\n                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                    rows={4}\n                    data-testid=\"textarea-event-description\"\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"classification\">Classification *</Label>\n                  <Select\n                    value={formData.classification}\n                    onValueChange={(value) => setFormData({ \n                      ...formData, \n                      classification: value as typeof formData.classification\n                    })}\n                  >\n                    <SelectTrigger data-testid=\"select-event-classification\">\n                      <SelectValue placeholder=\"Select classification\" />\n                    </SelectTrigger>\n                    <SelectContent className=\"z-[1002]\">\n                      {eventClassifications.map((classification) => (\n                        <SelectItem key={classification} value={classification}>\n                          {classification}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                {/* Only show date and time for non-Achievement classifications */}\n                {formData.classification !== \"Achievement\" && (\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <Label htmlFor=\"date\">Date *</Label>\n                      <Input\n                        id=\"date\"\n                        type=\"date\"\n                        value={formData.date}\n                        onChange={(e) => setFormData({ ...formData, date: e.target.value })}\n                        required\n                        data-testid=\"input-event-date\"\n                      />\n                    </div>\n                    <div>\n                      <Label htmlFor=\"time\">Time</Label>\n                      <Input\n                        id=\"time\"\n                        type=\"time\"\n                        value={formData.time || \"\"}\n                        onChange={(e) => setFormData({ ...formData, time: e.target.value })}\n                        data-testid=\"input-event-time\"\n                      />\n                    </div>\n                  </div>\n                )}\n\n                <div>\n                  <Label htmlFor=\"building\">Event Location (Building)</Label>\n                  <Select\n                    value={formData.buildingId || \"none\"}\n                    onValueChange={(value) => setFormData({ \n                      ...formData, \n                      buildingId: value === \"none\" ? null : value \n                    })}\n                  >\n                    <SelectTrigger data-testid=\"select-event-building\">\n                      <SelectValue placeholder=\"Select a building\" />\n                    </SelectTrigger>\n                    <SelectContent className=\"z-[1002]\">\n                      <SelectItem value=\"none\">No specific building</SelectItem>\n                      {buildings.map((building) => (\n                        <SelectItem key={building.id} value={building.id}>\n                          {building.name}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    Select if event is at a specific campus building (enables \"Get Direction\" button)\n                  </p>\n                </div>\n\n                <div>\n                  <Label htmlFor=\"location\">Additional Location Details</Label>\n                  <Input\n                    id=\"location\"\n                    value={formData.location || \"\"}\n                    onChange={(e) => setFormData({ ...formData, location: e.target.value })}\n                    placeholder=\"e.g., Room 101, Auditorium, or off-campus address\"\n                    data-testid=\"input-event-location\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    Add room number or additional details about the location\n                  </p>\n                </div>\n\n                <div>\n                  <Label htmlFor=\"image\">Image URL</Label>\n                  <Input\n                    id=\"image\"\n                    value={formData.image || \"\"}\n                    onChange={(e) => setFormData({ ...formData, image: e.target.value })}\n                    placeholder=\"https://example.com/image.jpg\"\n                    data-testid=\"input-event-image\"\n                  />\n                </div>\n\n                <div className=\"flex gap-3 justify-end\">\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={handleCloseDialog}\n                    data-testid=\"button-cancel\"\n                  >\n                    Cancel\n                  </Button>\n                  <Button\n                    type=\"submit\"\n                    disabled={createMutation.isPending || updateMutation.isPending}\n                    data-testid=\"button-save-event\"\n                  >\n                    {editingEvent ? \"Update\" : \"Create\"}\n                  </Button>\n                </div>\n              </form>\n            </DialogContent>\n          </Dialog>\n        </div>\n\n        <div className=\"grid lg:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-6\">\n          {isLoading ? (\n            [1, 2, 3].map((i) => (\n              <Card key={i} className=\"h-80 animate-pulse bg-muted\" />\n            ))\n          ) : events.length === 0 ? (\n            <div className=\"col-span-full text-center py-16\">\n              <CalendarIcon className=\"w-16 h-16 text-muted-foreground mx-auto mb-4\" />\n              <h3 className=\"text-xl font-medium text-foreground mb-2\">No Events Yet</h3>\n              <p className=\"text-muted-foreground\">Create your first event to get started</p>\n            </div>\n          ) : (\n            events.map((event) => (\n              <Card key={event.id} className=\"flex flex-col overflow-hidden\" data-testid={`event-item-${event.id}`}>\n                {event.image ? (\n                  <div className=\"w-full aspect-[4/3] bg-muted\">\n                    <img src={event.image} alt={event.title} className=\"w-full h-full object-cover\" />\n                  </div>\n                ) : (\n                  <div className=\"w-full aspect-[4/3] bg-gradient-to-br from-primary/20 to-primary/5 flex items-center justify-center\">\n                    <CalendarIcon className=\"w-12 h-12 text-primary/40\" />\n                  </div>\n                )}\n                <div className=\"p-6 flex flex-col flex-1\">\n                  <div className=\"mb-3\">\n                    <Badge variant=\"secondary\" className=\"mb-2\">\n                      {event.classification}\n                    </Badge>\n                  </div>\n                  <h3 className=\"text-lg font-semibold text-foreground mb-2 line-clamp-2\">\n                    {event.title}\n                  </h3>\n                  {event.classification !== \"Achievement\" && (\n                    <div className=\"text-sm text-muted-foreground mb-3\">\n                      {event.date} {event.time && `• ${event.time}`}\n                    </div>\n                  )}\n                  {event.description && (\n                    <p className=\"text-sm text-muted-foreground line-clamp-3 mb-4\">\n                      {event.description}\n                    </p>\n                  )}\n                  <div className=\"flex gap-2 mt-auto\">\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      className=\"flex-1\"\n                      onClick={() => handleOpenDialog(event)}\n                      data-testid={`button-edit-${event.id}`}\n                    >\n                      <Pencil className=\"w-3 h-3 mr-2\" />\n                      Edit\n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => deleteMutation.mutate(event.id)}\n                      data-testid={`button-delete-${event.id}`}\n                    >\n                      <Trash2 className=\"w-3 h-3 text-destructive\" />\n                    </Button>\n                  </div>\n                </div>\n              </Card>\n            ))\n          )}\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","size_bytes":13777},"client/src/pages/admin-staff.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Plus, Pencil, Trash2, Users as UsersIcon } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport AdminLayout from \"@/components/admin-layout\";\nimport type { Staff, InsertStaff, Building } from \"@shared/schema\";\nimport { canHaveDepartments, canHaveStaff } from \"@shared/schema\";\n\nexport default function AdminStaff() {\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingStaff, setEditingStaff] = useState<Staff | null>(null);\n  const [formData, setFormData] = useState<InsertStaff>({\n    name: \"\",\n    position: \"\",\n    department: \"\",\n    buildingId: null,\n    floorId: null,\n    roomId: null,\n    email: \"\",\n    phone: \"\",\n    photo: \"\",\n  });\n  const { toast } = useToast();\n\n  const { data: staff = [], isLoading } = useQuery<Staff[]>({\n    queryKey: ['/api/staff']\n  });\n\n  const { data: buildings = [] } = useQuery<Building[]>({\n    queryKey: ['/api/buildings']\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: InsertStaff) => apiRequest('POST', '/api/staff', data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/staff'] });\n      toast({ title: \"Staff member created successfully\" });\n      handleCloseDialog();\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: InsertStaff }) =>\n      apiRequest('PUT', `/api/staff/${id}`, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/staff'] });\n      toast({ title: \"Staff member updated successfully\" });\n      handleCloseDialog();\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: string) => apiRequest('DELETE', `/api/staff/${id}`, null),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/staff'] });\n      toast({ title: \"Staff member deleted successfully\" });\n    },\n  });\n\n  const handleOpenDialog = (member?: Staff) => {\n    if (member) {\n      setEditingStaff(member);\n      setFormData({\n        name: member.name,\n        position: member.position || \"\",\n        department: member.department || \"\",\n        buildingId: member.buildingId || null,\n        floorId: member.floorId || null,\n        roomId: member.roomId || null,\n        email: member.email || \"\",\n        phone: member.phone || \"\",\n        photo: member.photo || \"\",\n      });\n    } else {\n      setEditingStaff(null);\n      setFormData({\n        name: \"\",\n        position: \"\",\n        department: \"\",\n        buildingId: null,\n        floorId: null,\n        roomId: null,\n        email: \"\",\n        phone: \"\",\n        photo: \"\",\n      });\n    }\n    setIsDialogOpen(true);\n  };\n\n  const handleCloseDialog = () => {\n    setIsDialogOpen(false);\n    setEditingStaff(null);\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (editingStaff) {\n      updateMutation.mutate({ id: editingStaff.id, data: formData });\n    } else {\n      createMutation.mutate(formData);\n    }\n  };\n\n  // Get unique departments from buildings with type=\"Building\"\n  const availableDepartments = Array.from(\n    new Set(\n      buildings\n        .filter(b => canHaveDepartments(b.type as any))\n        .flatMap(b => b.departments || [])\n        .filter(Boolean)\n    )\n  ).sort();\n\n  // Filter buildings to only show staff-allowed POI types\n  const staffAllowedBuildings = buildings.filter(b => canHaveStaff(b.type as any));\n\n  return (\n    <AdminLayout>\n      <div className=\"p-8\">\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-foreground\">Staff Management</h1>\n            <p className=\"text-muted-foreground\">Manage faculty and staff directory</p>\n          </div>\n          <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n            <DialogTrigger asChild>\n              <Button onClick={() => handleOpenDialog()} data-testid=\"button-add-staff\">\n                <Plus className=\"w-4 h-4 mr-2\" />\n                Add Staff Member\n              </Button>\n            </DialogTrigger>\n            <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n              <DialogHeader>\n                <DialogTitle>\n                  {editingStaff ? \"Edit Staff Member\" : \"Add New Staff Member\"}\n                </DialogTitle>\n              </DialogHeader>\n              <form onSubmit={handleSubmit} className=\"space-y-6\">\n                <div>\n                  <Label htmlFor=\"name\">Full Name *</Label>\n                  <Input\n                    id=\"name\"\n                    value={formData.name}\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                    required\n                    data-testid=\"input-staff-name\"\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <Label htmlFor=\"position\">Position</Label>\n                    <Input\n                      id=\"position\"\n                      value={formData.position || \"\"}\n                      onChange={(e) => setFormData({ ...formData, position: e.target.value })}\n                      data-testid=\"input-staff-position\"\n                    />\n                  </div>\n                  <div>\n                    <Label htmlFor=\"department\">Department</Label>\n                    <Select\n                      value={formData.department || undefined}\n                      onValueChange={(value) => setFormData({ ...formData, department: value })}\n                    >\n                      <SelectTrigger id=\"department\" data-testid=\"select-staff-department\">\n                        <SelectValue placeholder={availableDepartments.length > 0 ? \"Select department\" : \"No departments available\"} />\n                      </SelectTrigger>\n                      <SelectContent className=\"z-[1002]\">\n                        {availableDepartments.length > 0 ? (\n                          availableDepartments.map(dept => (\n                            <SelectItem key={dept} value={dept}>\n                              {dept}\n                            </SelectItem>\n                          ))\n                        ) : (\n                          <SelectItem value=\"none\" disabled>\n                            No departments available\n                          </SelectItem>\n                        )}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </div>\n\n                <div>\n                  <Label htmlFor=\"building\">Building</Label>\n                  <Select\n                    value={formData.buildingId || undefined}\n                    onValueChange={(value) => setFormData({ ...formData, buildingId: value })}\n                  >\n                    <SelectTrigger data-testid=\"select-staff-building\">\n                      <SelectValue placeholder=\"Select building\" />\n                    </SelectTrigger>\n                    <SelectContent className=\"z-[1002]\">\n                      {staffAllowedBuildings.map(building => (\n                        <SelectItem key={building.id} value={building.id}>\n                          {building.name}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <Label htmlFor=\"email\">Email</Label>\n                    <Input\n                      id=\"email\"\n                      type=\"email\"\n                      value={formData.email || \"\"}\n                      onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                      data-testid=\"input-staff-email\"\n                    />\n                  </div>\n                  <div>\n                    <Label htmlFor=\"phone\">Phone</Label>\n                    <Input\n                      id=\"phone\"\n                      value={formData.phone || \"\"}\n                      onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\n                      data-testid=\"input-staff-phone\"\n                    />\n                  </div>\n                </div>\n\n                <div>\n                  <Label htmlFor=\"photo\">Photo URL</Label>\n                  <Input\n                    id=\"photo\"\n                    value={formData.photo || \"\"}\n                    onChange={(e) => setFormData({ ...formData, photo: e.target.value })}\n                    placeholder=\"https://example.com/photo.jpg\"\n                    data-testid=\"input-staff-photo\"\n                  />\n                </div>\n\n                <div className=\"flex gap-3 justify-end\">\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={handleCloseDialog}\n                    data-testid=\"button-cancel\"\n                  >\n                    Cancel\n                  </Button>\n                  <Button\n                    type=\"submit\"\n                    disabled={createMutation.isPending || updateMutation.isPending}\n                    data-testid=\"button-save-staff\"\n                  >\n                    {editingStaff ? \"Update\" : \"Create\"}\n                  </Button>\n                </div>\n              </form>\n            </DialogContent>\n          </Dialog>\n        </div>\n\n        <Card className=\"p-6\">\n          {isLoading ? (\n            <div className=\"space-y-4\">\n              {[1, 2, 3].map((i) => (\n                <div key={i} className=\"h-24 bg-muted animate-pulse rounded-lg\" />\n              ))}\n            </div>\n          ) : staff.length === 0 ? (\n            <div className=\"text-center py-16\">\n              <UsersIcon className=\"w-16 h-16 text-muted-foreground mx-auto mb-4\" />\n              <h3 className=\"text-xl font-medium text-foreground mb-2\">No Staff Members</h3>\n              <p className=\"text-muted-foreground\">Add your first staff member to get started</p>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {staff.map((member) => (\n                <div\n                  key={member.id}\n                  className=\"flex items-center justify-between p-4 bg-muted/50 rounded-lg hover-elevate\"\n                  data-testid={`staff-item-${member.id}`}\n                >\n                  <div className=\"flex items-center gap-4 flex-1\">\n                    <Avatar className=\"w-12 h-12\">\n                      <AvatarImage src={member.photo || undefined} alt={member.name} />\n                      <AvatarFallback className=\"bg-primary text-primary-foreground\">\n                        {member.name.split(' ').map(n => n[0]).join('').slice(0, 2)}\n                      </AvatarFallback>\n                    </Avatar>\n                    <div className=\"flex-1\">\n                      <h3 className=\"font-medium text-foreground\">{member.name}</h3>\n                      <div className=\"flex flex-wrap gap-2 text-sm text-muted-foreground\">\n                        {member.position && <span>{member.position}</span>}\n                        {member.department && (\n                          <>\n                            {member.position && <span>•</span>}\n                            <span>{member.department}</span>\n                          </>\n                        )}\n                      </div>\n                      <div className=\"flex gap-4 text-sm text-muted-foreground mt-1\">\n                        {member.email && <span>{member.email}</span>}\n                        {member.phone && <span>{member.phone}</span>}\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Button\n                      size=\"icon\"\n                      variant=\"ghost\"\n                      onClick={() => handleOpenDialog(member)}\n                      data-testid={`button-edit-${member.id}`}\n                    >\n                      <Pencil className=\"w-4 h-4\" />\n                    </Button>\n                    <Button\n                      size=\"icon\"\n                      variant=\"ghost\"\n                      onClick={() => deleteMutation.mutate(member.id)}\n                      data-testid={`button-delete-${member.id}`}\n                    >\n                      <Trash2 className=\"w-4 h-4 text-destructive\" />\n                    </Button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","size_bytes":13253},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/pages/admin-buildings.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Plus, Pencil, Trash2, MapPin, Building2, School, Hospital, Store, Home } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport AdminLayout from \"@/components/admin-layout\";\nimport CampusMap from \"@/components/campus-map\";\nimport type { Building, InsertBuilding } from \"@shared/schema\";\nimport { poiTypes, canHaveDepartments } from \"@shared/schema\";\n\nexport default function AdminBuildings() {\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingBuilding, setEditingBuilding] = useState<Building | null>(null);\n  const [formData, setFormData] = useState<InsertBuilding>({\n    name: \"\",\n    type: \"Building\",\n    description: \"\",\n    lat: 14.4035451,\n    lng: 120.8659794,\n    departments: [],\n    image: \"\",\n    markerIcon: \"building\",\n  });\n  const [departmentInput, setDepartmentInput] = useState(\"\");\n  const [mapClickEnabled, setMapClickEnabled] = useState(false);\n  const [selectedTypeFilter, setSelectedTypeFilter] = useState<string>(\"All Types\");\n  const mapClickEnabledRef = useRef(false);\n  const { toast } = useToast();\n\n  useEffect(() => {\n    mapClickEnabledRef.current = mapClickEnabled;\n  }, [mapClickEnabled]);\n\n  const { data: buildings = [], isLoading } = useQuery<Building[]>({\n    queryKey: ['/api/buildings']\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: InsertBuilding) => apiRequest('POST', '/api/buildings', data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/buildings'] });\n      toast({ title: \"Building created successfully\" });\n      handleCloseDialog();\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: InsertBuilding }) =>\n      apiRequest('PUT', `/api/buildings/${id}`, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/buildings'] });\n      toast({ title: \"Building updated successfully\" });\n      handleCloseDialog();\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: string) => apiRequest('DELETE', `/api/buildings/${id}`, null),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/buildings'] });\n      toast({ title: \"Building deleted successfully\" });\n    },\n  });\n\n  const handleOpenDialog = (building?: Building) => {\n    if (building) {\n      setEditingBuilding(building);\n      setFormData({\n        name: building.name,\n        type: building.type || \"Building\",\n        description: building.description || \"\",\n        lat: building.lat,\n        lng: building.lng,\n        departments: building.departments || [],\n        image: building.image || \"\",\n        markerIcon: building.markerIcon || \"building\",\n      });\n    } else {\n      setEditingBuilding(null);\n      setFormData({\n        name: \"\",\n        type: \"Building\",\n        description: \"\",\n        lat: 14.4035451,\n        lng: 120.8659794,\n        departments: [],\n        image: \"\",\n        markerIcon: \"building\",\n      });\n    }\n    setMapClickEnabled(false);\n    setIsDialogOpen(true);\n  };\n\n  const handleCloseDialog = () => {\n    setIsDialogOpen(false);\n    setEditingBuilding(null);\n    setDepartmentInput(\"\");\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (editingBuilding) {\n      updateMutation.mutate({ id: editingBuilding.id, data: formData });\n    } else {\n      createMutation.mutate(formData);\n    }\n  };\n\n  const handleAddDepartment = () => {\n    if (departmentInput.trim()) {\n      setFormData({\n        ...formData,\n        departments: [...(formData.departments || []), departmentInput.trim()]\n      });\n      setDepartmentInput(\"\");\n    }\n  };\n\n  const handleRemoveDepartment = (index: number) => {\n    setFormData({\n      ...formData,\n      departments: formData.departments?.filter((_, i) => i !== index) || []\n    });\n  };\n\n  const handleMapClick = (lat: number, lng: number) => {\n    if (mapClickEnabledRef.current) {\n      setFormData(prev => ({\n        ...prev,\n        lat,\n        lng\n      }));\n      toast({ title: \"Location updated\", description: `Set to ${lat.toFixed(6)}, ${lng.toFixed(6)}` });\n    }\n  };\n\n  const toggleMapClick = () => {\n    setMapClickEnabled(!mapClickEnabled);\n  };\n\n  const markerIconOptions = [\n    { value: \"building\", label: \"Building\", icon: Building2 },\n    { value: \"school\", label: \"School\", icon: School },\n    { value: \"hospital\", label: \"Hospital\", icon: Hospital },\n    { value: \"store\", label: \"Store\", icon: Store },\n    { value: \"home\", label: \"Home\", icon: Home },\n  ];\n\n  return (\n    <AdminLayout>\n      <div className=\"p-8\">\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-foreground\">Building Management</h1>\n            <p className=\"text-muted-foreground\">Manage campus buildings and locations</p>\n          </div>\n          <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n            <DialogTrigger asChild>\n              <Button onClick={() => handleOpenDialog()} data-testid=\"button-add-building\">\n                <Plus className=\"w-4 h-4 mr-2\" />\n                Add Building\n              </Button>\n            </DialogTrigger>\n            <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n              <DialogHeader>\n                <DialogTitle>\n                  {editingBuilding ? \"Edit Building\" : \"Add New Building\"}\n                </DialogTitle>\n              </DialogHeader>\n              <form onSubmit={handleSubmit} className=\"space-y-6\">\n                <div>\n                  <Label htmlFor=\"name\">Location Name *</Label>\n                  <Input\n                    id=\"name\"\n                    value={formData.name}\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                    required\n                    data-testid=\"input-building-name\"\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"type\">Type *</Label>\n                  <Select\n                    value={formData.type}\n                    onValueChange={(value) => {\n                      setFormData({ \n                        ...formData, \n                        type: value,\n                        departments: canHaveDepartments(value as any) ? formData.departments : []\n                      });\n                    }}\n                  >\n                    <SelectTrigger id=\"type\" data-testid=\"select-poi-type\">\n                      <SelectValue placeholder=\"Select location type\" />\n                    </SelectTrigger>\n                    <SelectContent className=\"z-[10000] max-h-[300px]\">\n                      {poiTypes.map((type) => (\n                        <SelectItem key={type} value={type}>\n                          {type}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div>\n                  <Label htmlFor=\"description\">Description</Label>\n                  <Textarea\n                    id=\"description\"\n                    value={formData.description || \"\"}\n                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                    rows={3}\n                    data-testid=\"textarea-building-description\"\n                  />\n                </div>\n\n                <div>\n                  <Label>Location *</Label>\n                  <div className=\"mt-2 space-y-3\">\n                    <Button\n                      type=\"button\"\n                      variant={mapClickEnabled ? \"default\" : \"outline\"}\n                      className=\"w-full\"\n                      onClick={toggleMapClick}\n                      data-testid=\"button-toggle-map-click\"\n                    >\n                      <MapPin className=\"w-4 h-4 mr-2\" />\n                      {mapClickEnabled ? \"Click map to place marker (Active)\" : \"Click to enable map placement\"}\n                    </Button>\n                    \n                    <div className=\"h-[300px] rounded-lg overflow-hidden border\">\n                      <CampusMap\n                        buildings={[{ ...formData, id: \"preview\", name: formData.name || \"New Building\", markerIcon: formData.markerIcon }] as Building[]}\n                        onMapClick={handleMapClick}\n                        centerLat={formData.lat}\n                        centerLng={formData.lng}\n                      />\n                    </div>\n\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <Label htmlFor=\"lat\" className=\"text-xs\">Latitude</Label>\n                        <Input\n                          id=\"lat\"\n                          type=\"number\"\n                          step=\"any\"\n                          value={formData.lat}\n                          onChange={(e) => setFormData({ ...formData, lat: parseFloat(e.target.value) })}\n                          required\n                          data-testid=\"input-building-lat\"\n                          className=\"text-sm\"\n                        />\n                      </div>\n                      <div>\n                        <Label htmlFor=\"lng\" className=\"text-xs\">Longitude</Label>\n                        <Input\n                          id=\"lng\"\n                          type=\"number\"\n                          step=\"any\"\n                          value={formData.lng}\n                          onChange={(e) => setFormData({ ...formData, lng: parseFloat(e.target.value) })}\n                          required\n                          data-testid=\"input-building-lng\"\n                          className=\"text-sm\"\n                        />\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <div>\n                  <Label htmlFor=\"markerIcon\">Marker Icon</Label>\n                  <Select\n                    value={formData.markerIcon || \"building\"}\n                    onValueChange={(value) => setFormData({ ...formData, markerIcon: value })}\n                  >\n                    <SelectTrigger id=\"markerIcon\" data-testid=\"select-marker-icon\">\n                      <SelectValue placeholder=\"Select marker icon\" />\n                    </SelectTrigger>\n                    <SelectContent className=\"z-[10000]\">\n                      {markerIconOptions.map((option) => (\n                        <SelectItem key={option.value} value={option.value}>\n                          <div className=\"flex items-center gap-2\">\n                            <option.icon className=\"w-4 h-4\" />\n                            {option.label}\n                          </div>\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div>\n                  <Label htmlFor=\"image\">Image URL</Label>\n                  <Input\n                    id=\"image\"\n                    value={formData.image || \"\"}\n                    onChange={(e) => setFormData({ ...formData, image: e.target.value })}\n                    placeholder=\"https://example.com/image.jpg\"\n                    data-testid=\"input-building-image\"\n                  />\n                </div>\n\n                {canHaveDepartments(formData.type as any) && (\n                  <div>\n                    <Label>Departments</Label>\n                    <div className=\"flex gap-2 mt-2\">\n                      <Input\n                        value={departmentInput}\n                        onChange={(e) => setDepartmentInput(e.target.value)}\n                        placeholder=\"Department name\"\n                        data-testid=\"input-department\"\n                      />\n                      <Button\n                        type=\"button\"\n                        variant=\"outline\"\n                        onClick={handleAddDepartment}\n                        data-testid=\"button-add-department\"\n                      >\n                        Add\n                      </Button>\n                    </div>\n                    <div className=\"flex flex-wrap gap-2 mt-3\">\n                      {formData.departments?.map((dept, index) => (\n                        <div\n                          key={index}\n                          className=\"flex items-center gap-2 bg-secondary px-3 py-1 rounded-md\"\n                        >\n                          <span className=\"text-sm\">{dept}</span>\n                          <button\n                            type=\"button\"\n                            onClick={() => handleRemoveDepartment(index)}\n                            className=\"text-destructive hover:text-destructive/80\"\n                          >\n                            ×\n                          </button>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                )}\n\n                <div className=\"flex gap-3 justify-end\">\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={handleCloseDialog}\n                    data-testid=\"button-cancel\"\n                  >\n                    Cancel\n                  </Button>\n                  <Button\n                    type=\"submit\"\n                    disabled={createMutation.isPending || updateMutation.isPending}\n                    data-testid=\"button-save-building\"\n                  >\n                    {editingBuilding ? \"Update\" : \"Create\"}\n                  </Button>\n                </div>\n              </form>\n            </DialogContent>\n          </Dialog>\n        </div>\n\n        <div className=\"grid lg:grid-cols-3 gap-8\">\n          <div className=\"lg:col-span-2\">\n            <Card className=\"h-[600px] overflow-hidden\">\n              <CampusMap buildings={buildings} onBuildingClick={handleOpenDialog} />\n            </Card>\n          </div>\n\n          <div>\n            <Card className=\"p-6\">\n              <h2 className=\"text-lg font-semibold text-foreground mb-4\">Buildings List</h2>\n              \n              <div className=\"mb-4\">\n                <Label htmlFor=\"type-filter\" className=\"text-sm\">Filter by Type</Label>\n                <Select\n                  value={selectedTypeFilter}\n                  onValueChange={setSelectedTypeFilter}\n                >\n                  <SelectTrigger id=\"type-filter\" data-testid=\"select-type-filter\" className=\"mt-1\">\n                    <SelectValue placeholder=\"All Types\" />\n                  </SelectTrigger>\n                  <SelectContent className=\"z-[100] max-h-[300px]\">\n                    <SelectItem value=\"All Types\">All Types</SelectItem>\n                    {poiTypes.map((type) => (\n                      <SelectItem key={type} value={type}>\n                        {type}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              {isLoading ? (\n                <div className=\"space-y-3\">\n                  {[1, 2, 3].map((i) => (\n                    <div key={i} className=\"h-20 bg-muted animate-pulse rounded-lg\" />\n                  ))}\n                </div>\n              ) : buildings.length === 0 ? (\n                <div className=\"text-center py-8\">\n                  <MapPin className=\"w-12 h-12 text-muted-foreground mx-auto mb-2\" />\n                  <p className=\"text-sm text-muted-foreground\">No buildings yet</p>\n                </div>\n              ) : (\n                <div className=\"space-y-3 max-h-[500px] overflow-y-auto\">\n                  {buildings\n                    .filter((building) => \n                      selectedTypeFilter === \"All Types\" || building.type === selectedTypeFilter\n                    )\n                    .map((building) => (\n                    <div\n                      key={building.id}\n                      className=\"flex items-start justify-between p-3 bg-muted/50 rounded-lg hover-elevate\"\n                      data-testid={`building-item-${building.id}`}\n                    >\n                      <div className=\"flex-1\">\n                        <h3 className=\"font-medium text-foreground\">{building.name}</h3>\n                        <p className=\"text-sm text-muted-foreground\">\n                          {building.type || \"Building\"}\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {building.lat.toFixed(4)}, {building.lng.toFixed(4)}\n                        </p>\n                      </div>\n                      <div className=\"flex gap-2\">\n                        <Button\n                          size=\"icon\"\n                          variant=\"ghost\"\n                          onClick={() => handleOpenDialog(building)}\n                          data-testid={`button-edit-${building.id}`}\n                        >\n                          <Pencil className=\"w-4 h-4\" />\n                        </Button>\n                        <Button\n                          size=\"icon\"\n                          variant=\"ghost\"\n                          onClick={() => deleteMutation.mutate(building.id)}\n                          data-testid={`button-delete-${building.id}`}\n                        >\n                          <Trash2 className=\"w-4 h-4 text-destructive\" />\n                        </Button>\n                      </div>\n                    </div>\n                  ))}\n                  {buildings.filter((building) => \n                    selectedTypeFilter === \"All Types\" || building.type === selectedTypeFilter\n                  ).length === 0 && (\n                    <div className=\"text-center py-8\">\n                      <MapPin className=\"w-12 h-12 text-muted-foreground mx-auto mb-2\" />\n                      <p className=\"text-sm text-muted-foreground\">No buildings of type \"{selectedTypeFilter}\"</p>\n                    </div>\n                  )}\n                </div>\n              )}\n            </Card>\n          </div>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","size_bytes":18822},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/pages/navigation.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { ArrowLeft, Navigation as NavigationIcon, TrendingUp, MapPin, Filter, Search, Users } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Tabs, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Input } from \"@/components/ui/input\";\nimport CampusMap from \"@/components/campus-map\";\nimport BuildingInfoModal from \"@/components/building-info-modal\";\nimport FloorPlanViewer from \"@/components/floor-plan-viewer\";\nimport GetDirectionsDialog from \"@/components/get-directions-dialog\";\nimport type { Building, NavigationRoute, Staff, Floor, Room } from \"@shared/schema\";\nimport { poiTypes, KIOSK_LOCATION } from \"@shared/schema\";\nimport { useGlobalInactivity } from \"@/hooks/use-inactivity\";\nimport { findShortestPath } from \"@/lib/pathfinding\";\nimport { getWalkpaths, getDrivepaths, getBuildings, getStaff, getFloors, getRooms } from \"@/lib/offline-data\";\n\nexport default function Navigation() {\n  // Return to home after 3 minutes of inactivity\n  useGlobalInactivity();\n  const [selectedStart, setSelectedStart] = useState<Building | null | typeof KIOSK_LOCATION>(null);\n  const [selectedEnd, setSelectedEnd] = useState<Building | null>(null);\n  const [mode, setMode] = useState<'walking' | 'driving'>('walking');\n  const [route, setRoute] = useState<NavigationRoute | null>(null);\n  const [selectedBuilding, setSelectedBuilding] = useState<Building | null>(null);\n  const [selectedFloor, setSelectedFloor] = useState<Floor | null>(null);\n  const [filterType, setFilterType] = useState<string>(\"all\");\n  const [searchQuery, setSearchQuery] = useState<string>(\"\");\n  const [showDirectionsDialog, setShowDirectionsDialog] = useState(false);\n  const [directionsDestination, setDirectionsDestination] = useState<Building | null>(null);\n\n  const { data: buildings = [] } = useQuery<Building[]>({\n    queryKey: ['/api/buildings'],\n    queryFn: getBuildings\n  });\n\n  const { data: staff = [] } = useQuery<Staff[]>({\n    queryKey: ['/api/staff'],\n    queryFn: getStaff\n  });\n\n  const { data: floors = [] } = useQuery<Floor[]>({\n    queryKey: ['/api/floors'],\n    queryFn: getFloors\n  });\n\n  const { data: rooms = [] } = useQuery<Room[]>({\n    queryKey: ['/api/rooms'],\n    queryFn: getRooms\n  });\n\n  useEffect(() => {\n    setSelectedStart(KIOSK_LOCATION as any);\n  }, []);\n\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    const fromId = params.get('from');\n    const toId = params.get('to');\n    const travelMode = params.get('mode') as 'walking' | 'driving';\n\n    if (fromId && toId && buildings.length > 0) {\n      const startBuilding = fromId === 'kiosk' \n        ? { ...KIOSK_LOCATION, description: null, departments: null, image: null, markerIcon: null }\n        : buildings.find(b => b.id === fromId);\n      const endBuilding = buildings.find(b => b.id === toId);\n\n      if (startBuilding && endBuilding) {\n        setSelectedStart(startBuilding as any);\n        setSelectedEnd(endBuilding);\n        if (travelMode === 'walking' || travelMode === 'driving') {\n          setMode(travelMode);\n        }\n        \n        setTimeout(async () => {\n          try {\n            const routePolyline = await calculateRouteClientSide(\n              startBuilding as any,\n              endBuilding,\n              travelMode || 'walking'\n            );\n\n            if (!routePolyline) {\n              console.error('Failed to calculate route');\n              return;\n            }\n\n            const steps = [];\n            let totalDist = 0;\n\n            steps.push({\n              instruction: `Start at ${startBuilding.name}`,\n              distance: '0 m',\n              icon: 'start'\n            });\n\n            for (let i = 0; i < routePolyline.length - 1; i++) {\n              const dist = calculateDistance(\n                routePolyline[i].lat,\n                routePolyline[i].lng,\n                routePolyline[i + 1].lat,\n                routePolyline[i + 1].lng\n              );\n              totalDist += dist;\n\n              if (i < routePolyline.length - 2) {\n                steps.push({\n                  instruction: (travelMode || 'walking') === 'walking' \n                    ? `Continue along the pathway` \n                    : `Continue along the road`,\n                  distance: `${Math.round(dist)} m`,\n                  icon: 'straight'\n                });\n              }\n            }\n\n            steps.push({\n              instruction: `Arrive at ${endBuilding.name}`,\n              distance: '0 m',\n              icon: 'end'\n            });\n\n            setRoute({\n              start: startBuilding as any,\n              end: endBuilding,\n              mode: travelMode || 'walking',\n              polyline: routePolyline,\n              steps,\n              totalDistance: `${Math.round(totalDist)} m`\n            });\n          } catch (error) {\n            console.error('Error generating route:', error);\n          }\n        }, 100);\n      }\n    }\n  }, [buildings]);\n\n  const calculateDistance = (lat1: number, lng1: number, lat2: number, lng2: number): number => {\n    const R = 6371000;\n    const φ1 = lat1 * Math.PI/180;\n    const φ2 = lat2 * Math.PI/180;\n    const Δφ = (lat2-lat1) * Math.PI/180;\n    const Δλ = (lng2-lng1) * Math.PI/180;\n\n    const a = Math.sin(Δφ/2) * Math.sin(Δφ/2) +\n            Math.cos(φ1) * Math.cos(φ2) *\n            Math.sin(Δλ/2) * Math.sin(Δλ/2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n\n    return R * c;\n  };\n\n  const calculateRouteClientSide = async (\n    startBuilding: Building | typeof KIOSK_LOCATION,\n    endBuilding: Building,\n    travelMode: 'walking' | 'driving'\n  ): Promise<Array<{ lat: number; lng: number }> | null> => {\n    try {\n      const paths = travelMode === 'walking' \n        ? await getWalkpaths()\n        : await getDrivepaths();\n\n      if (!paths || paths.length === 0) {\n        console.error('[CLIENT] No paths available for pathfinding');\n        return null;\n      }\n\n      const route = findShortestPath(\n        startBuilding as Building,\n        endBuilding,\n        paths\n      );\n\n      return route;\n    } catch (error) {\n      console.error('[CLIENT] Error calculating route:', error);\n      return null;\n    }\n  };\n\n  const generateRoute = async () => {\n    if (!selectedStart || !selectedEnd) return;\n\n    try {\n      const routePolyline = await calculateRouteClientSide(\n        selectedStart,\n        selectedEnd,\n        mode\n      );\n\n      if (!routePolyline) {\n        console.error('Failed to calculate route');\n        return;\n      }\n\n      const steps = [];\n      let totalDist = 0;\n\n      steps.push({\n        instruction: `Start at ${selectedStart.name}`,\n        distance: '0 m',\n        icon: 'start'\n      });\n\n      for (let i = 0; i < routePolyline.length - 1; i++) {\n        const dist = calculateDistance(\n          routePolyline[i].lat,\n          routePolyline[i].lng,\n          routePolyline[i + 1].lat,\n          routePolyline[i + 1].lng\n        );\n        totalDist += dist;\n\n        if (i < routePolyline.length - 2) {\n          steps.push({\n            instruction: mode === 'walking' \n              ? `Continue along the pathway` \n              : `Continue along the road`,\n            distance: `${Math.round(dist)} m`,\n            icon: 'straight'\n          });\n        }\n      }\n\n      steps.push({\n        instruction: `Arrive at ${selectedEnd.name}`,\n        distance: '0 m',\n        icon: 'end'\n      });\n\n      setRoute({\n        start: selectedStart,\n        end: selectedEnd,\n        mode,\n        polyline: routePolyline,\n        steps,\n        totalDistance: `${Math.round(totalDist)} m`\n      });\n    } catch (error) {\n      console.error('Error generating route:', error);\n    }\n  };\n\n  const resetNavigation = () => {\n    setSelectedStart(null);\n    setSelectedEnd(null);\n    setRoute(null);\n  };\n\n  const handleGetDirections = () => {\n    if (selectedBuilding) {\n      setDirectionsDestination(selectedBuilding);\n      setShowDirectionsDialog(true);\n    }\n  };\n\n  const handleNavigateFromDialog = async (startId: string, travelMode: 'walking' | 'driving') => {\n    if (!directionsDestination) return;\n\n    // Handle kiosk location or regular building\n    const start = startId === 'kiosk' \n      ? KIOSK_LOCATION as any\n      : buildings.find(b => b.id === startId);\n    \n    if (!start) return;\n\n    // Set the navigation parameters\n    setSelectedStart(start);\n    setSelectedEnd(directionsDestination);\n    setMode(travelMode);\n\n    // Close modals\n    setShowDirectionsDialog(false);\n    setSelectedBuilding(null);\n\n    // Generate the route\n    try {\n      const routePolyline = await calculateRouteClientSide(\n        start,\n        directionsDestination,\n        travelMode\n      );\n\n      if (!routePolyline) {\n        console.error('Failed to calculate route');\n        return;\n      }\n\n      const steps = [];\n      let totalDist = 0;\n\n      steps.push({\n        instruction: `Start at ${start.name}`,\n        distance: '0 m',\n        icon: 'start'\n      });\n\n      for (let i = 0; i < routePolyline.length - 1; i++) {\n        const dist = calculateDistance(\n          routePolyline[i].lat,\n          routePolyline[i].lng,\n          routePolyline[i + 1].lat,\n          routePolyline[i + 1].lng\n        );\n        totalDist += dist;\n\n        if (i < routePolyline.length - 2) {\n          steps.push({\n            instruction: travelMode === 'walking' \n              ? `Continue along the pathway` \n              : `Continue along the road`,\n            distance: `${Math.round(dist)} m`,\n            icon: 'straight'\n          });\n        }\n      }\n\n      steps.push({\n        instruction: `Arrive at ${directionsDestination.name}`,\n        distance: '0 m',\n        icon: 'end'\n      });\n\n      setRoute({\n        start,\n        end: directionsDestination,\n        mode: travelMode,\n        polyline: routePolyline,\n        steps,\n        totalDistance: `${Math.round(totalDist)} m`\n      });\n    } catch (error) {\n      console.error('Error generating route:', error);\n    }\n  };\n\n  const buildingStaff = selectedBuilding\n    ? staff.filter(s => s.buildingId === selectedBuilding.id)\n    : [];\n\n  const buildingFloors = selectedBuilding\n    ? floors.filter(f => f.buildingId === selectedBuilding.id)\n    : [];\n\n  const floorRooms = selectedFloor\n    ? rooms.filter(r => r.floorId === selectedFloor.id)\n    : [];\n\n  // Filter buildings by type and search query\n  const filteredBuildings = buildings.filter(b => {\n    const matchesType = filterType === \"all\" || b.type === filterType;\n    const matchesSearch = searchQuery === \"\" || \n      b.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      (b.description && b.description.toLowerCase().includes(searchQuery.toLowerCase()));\n    return matchesType && matchesSearch;\n  });\n\n  return (\n    <div className=\"h-screen flex flex-col overflow-hidden\">\n      <header className=\"bg-card border-b border-card-border p-4 flex-shrink-0\">\n        <div className=\"max-w-7xl mx-auto flex items-center justify-between flex-wrap gap-4\">\n          <div className=\"flex items-center gap-4\">\n            <Link href=\"/\">\n              <Button variant=\"ghost\" size=\"icon\" data-testid=\"button-back\">\n                <ArrowLeft className=\"w-5 h-5\" />\n              </Button>\n            </Link>\n            <div>\n              <h1 className=\"text-2xl font-semibold text-foreground\">Campus Navigation</h1>\n              <p className=\"text-sm text-muted-foreground\">Find your way around CVSU CCAT</p>\n            </div>\n          </div>\n          <Link href=\"/staff\">\n            <Button variant=\"default\" data-testid=\"button-staff-finder\">\n              <Users className=\"w-4 h-4 mr-2\" />\n              Staff Finder\n            </Button>\n          </Link>\n        </div>\n      </header>\n\n      <div className=\"flex-1 flex flex-col md:flex-row overflow-hidden\">\n        <aside className=\"w-full md:w-96 bg-card md:border-r border-b md:border-b-0 border-card-border p-6 overflow-y-auto flex-shrink-0\">\n          {!route ? (\n            <div className=\"space-y-6\">\n              <div>\n                <label className=\"block text-sm font-medium text-foreground mb-2 flex items-center gap-2\">\n                  <Search className=\"w-4 h-4\" />\n                  Search Buildings\n                </label>\n                <Input\n                  type=\"text\"\n                  placeholder=\"Search by name or description...\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  data-testid=\"input-search-buildings\"\n                  className=\"w-full\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-foreground mb-2 flex items-center gap-2\">\n                  <Filter className=\"w-4 h-4\" />\n                  Filter Map Markers\n                </label>\n                <Select value={filterType} onValueChange={setFilterType}>\n                  <SelectTrigger data-testid=\"select-marker-filter\">\n                    <SelectValue placeholder=\"All Types\" />\n                  </SelectTrigger>\n                  <SelectContent className=\"z-[100]\">\n                    <SelectItem value=\"all\">All Types</SelectItem>\n                    {poiTypes.map((type) => (\n                      <SelectItem key={type} value={type}>\n                        {type}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-foreground mb-2\">\n                  Starting Point\n                </label>\n                <Select\n                  value={selectedStart?.id}\n                  onValueChange={(id) => {\n                    if (id === 'kiosk') {\n                      setSelectedStart(KIOSK_LOCATION as any);\n                    } else {\n                      const building = buildings.find(b => b.id === id);\n                      setSelectedStart(building || null);\n                    }\n                  }}\n                >\n                  <SelectTrigger data-testid=\"select-start\">\n                    <SelectValue placeholder=\"Select starting location\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"kiosk\">\n                      <div className=\"flex items-center gap-2\">\n                        <MapPin className=\"w-4 h-4 text-blue-600\" />\n                        <span className=\"font-semibold\">{KIOSK_LOCATION.name}</span>\n                      </div>\n                    </SelectItem>\n                    {buildings.map(building => (\n                      <SelectItem key={building.id} value={building.id}>\n                        {building.name}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-foreground mb-2\">\n                  Destination\n                </label>\n                <Select\n                  value={selectedEnd?.id}\n                  onValueChange={(id) => {\n                    const building = buildings.find(b => b.id === id);\n                    setSelectedEnd(building || null);\n                  }}\n                >\n                  <SelectTrigger data-testid=\"select-destination\">\n                    <SelectValue placeholder=\"Select destination\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {buildings.map(building => (\n                      <SelectItem key={building.id} value={building.id}>\n                        {building.name}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-foreground mb-2\">\n                  Travel Mode\n                </label>\n                <Tabs value={mode} onValueChange={(v) => setMode(v as 'walking' | 'driving')}>\n                  <TabsList className=\"w-full\">\n                    <TabsTrigger value=\"walking\" className=\"flex-1\" data-testid=\"tab-walking\">\n                      Walking\n                    </TabsTrigger>\n                    <TabsTrigger value=\"driving\" className=\"flex-1\" data-testid=\"tab-driving\">\n                      Driving\n                    </TabsTrigger>\n                  </TabsList>\n                </Tabs>\n              </div>\n\n              <Button\n                className=\"w-full\"\n                onClick={generateRoute}\n                disabled={!selectedStart || !selectedEnd}\n                data-testid=\"button-generate-route\"\n              >\n                <NavigationIcon className=\"w-4 h-4 mr-2\" />\n                Generate Route\n              </Button>\n\n              <div className=\"pt-4 border-t border-border\">\n                <h3 className=\"text-sm font-medium text-foreground mb-3\">\n                  {filterType === \"all\" ? \"Available Buildings\" : `${filterType} Locations`}\n                </h3>\n                <div className=\"space-y-2\">\n                  {filteredBuildings.length > 0 ? (\n                    filteredBuildings.map(building => (\n                      <div\n                        key={building.id}\n                        className=\"flex items-center justify-between gap-2 p-2 rounded-lg hover-elevate cursor-pointer\"\n                        onClick={() => setSelectedBuilding(building)}\n                        data-testid={`building-list-${building.id}`}\n                      >\n                        <div className=\"flex items-center gap-2 flex-1\">\n                          <MapPin className=\"w-4 h-4 text-primary flex-shrink-0\" />\n                          <span className=\"text-sm text-foreground\">{building.name}</span>\n                        </div>\n                        <span className=\"text-xs text-muted-foreground flex-shrink-0\">{building.type}</span>\n                      </div>\n                    ))\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground text-center py-4\">\n                      No {filterType} locations found\n                    </p>\n                  )}\n                </div>\n              </div>\n            </div>\n          ) : (\n            <div className=\"space-y-6\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-lg font-semibold text-foreground\">Route Details</h3>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={resetNavigation}\n                  data-testid=\"button-reset-navigation\"\n                >\n                  Restart\n                </Button>\n              </div>\n\n              <Card className=\"p-4\">\n                <div className=\"flex items-center justify-between mb-3\">\n                  <div>\n                    <p className=\"text-xs text-muted-foreground\">From</p>\n                    <p className=\"font-medium text-foreground\">{route.start.name}</p>\n                  </div>\n                  <TrendingUp className=\"w-5 h-5 text-muted-foreground\" />\n                  <div className=\"text-right\">\n                    <p className=\"text-xs text-muted-foreground\">To</p>\n                    <p className=\"font-medium text-foreground\">{route.end.name}</p>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <span className=\"text-muted-foreground\">Distance:</span>\n                  <span className=\"font-medium text-foreground\">{route.totalDistance}</span>\n                  <span className=\"text-muted-foreground\">•</span>\n                  <span className=\"text-muted-foreground capitalize\">{route.mode}</span>\n                </div>\n              </Card>\n\n              <div>\n                <h4 className=\"text-sm font-medium text-foreground mb-3\">Directions</h4>\n                <div className=\"space-y-3\">\n                  {route.steps.map((step, index) => (\n                    <div\n                      key={index}\n                      className=\"flex gap-3\"\n                      data-testid={`route-step-${index}`}\n                    >\n                      <div className=\"flex-shrink-0 w-8 h-8 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-medium\">\n                        {index + 1}\n                      </div>\n                      <div className=\"flex-1\">\n                        <p className=\"text-sm font-medium text-foreground\">{step.instruction}</p>\n                        <p className=\"text-xs text-muted-foreground\">{step.distance}</p>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n          )}\n        </aside>\n\n        <main className=\"flex-1 overflow-hidden\">\n          <CampusMap\n            buildings={filteredBuildings}\n            onBuildingClick={setSelectedBuilding}\n            selectedBuilding={selectedBuilding}\n            routePolyline={route?.polyline}\n            routeMode={route?.mode}\n          />\n        </main>\n      </div>\n\n      {selectedBuilding && (\n        <BuildingInfoModal\n          building={selectedBuilding}\n          staff={buildingStaff}\n          floors={buildingFloors}\n          onClose={() => setSelectedBuilding(null)}\n          onOpenFloorPlan={setSelectedFloor}\n          onGetDirections={handleGetDirections}\n        />\n      )}\n\n      {selectedFloor && (\n        <FloorPlanViewer\n          floor={selectedFloor}\n          rooms={floorRooms}\n          onClose={() => setSelectedFloor(null)}\n        />\n      )}\n\n      <GetDirectionsDialog\n        open={showDirectionsDialog}\n        destination={directionsDestination}\n        buildings={buildings}\n        onClose={() => setShowDirectionsDialog(false)}\n        onNavigate={handleNavigateFromDialog}\n      />\n    </div>\n  );\n}\n","size_bytes":22390},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport {\n  insertBuildingSchema,\n  insertFloorSchema,\n  insertRoomSchema,\n  insertStaffSchema,\n  insertEventSchema,\n  insertWalkpathSchema,\n  insertDrivepathSchema,\n  insertSettingSchema,\n  canHaveStaff,\n  type POIType\n} from \"@shared/schema\";\nimport { z } from \"zod\";\nimport { findShortestPath } from \"./pathfinding\";\n\nconst loginSchema = z.object({\n  username: z.string(),\n  password: z.string()\n});\n\nconst updateSettingSchema = z.object({\n  value: z.string()\n});\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  app.post('/api/admin/login', async (req, res) => {\n    try {\n      const { username, password } = loginSchema.parse(req.body);\n      const admin = await storage.getAdminByUsername(username);\n      \n      if (!admin || admin.password !== password) {\n        return res.status(401).json({ error: 'Invalid credentials' });\n      }\n      \n      res.json({ success: true, username: admin.username });\n    } catch (error) {\n      res.status(400).json({ error: 'Invalid request' });\n    }\n  });\n\n  // Settings routes\n  app.get('/api/settings/:key', async (req, res) => {\n    try {\n      const setting = await storage.getSetting(req.params.key);\n      if (!setting) {\n        return res.status(404).json({ error: 'Setting not found' });\n      }\n      res.json(setting);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch setting' });\n    }\n  });\n\n  app.put('/api/settings/:key', async (req, res) => {\n    try {\n      const { value } = updateSettingSchema.parse(req.body);\n      let setting = await storage.getSetting(req.params.key);\n      if (!setting) {\n        // Create if doesn't exist\n        const data = insertSettingSchema.parse({ key: req.params.key, value, description: null });\n        setting = await storage.createSetting(data);\n      } else {\n        // Update existing\n        setting = await storage.updateSetting(req.params.key, value);\n      }\n      res.json(setting);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: 'Invalid request body', details: error.errors });\n      }\n      res.status(400).json({ error: 'Failed to update setting' });\n    }\n  });\n\n  app.get('/api/buildings', async (req, res) => {\n    try {\n      const buildings = await storage.getBuildings();\n      res.json(buildings);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch buildings' });\n    }\n  });\n\n  app.get('/api/buildings/:id', async (req, res) => {\n    try {\n      const building = await storage.getBuilding(req.params.id);\n      if (!building) {\n        return res.status(404).json({ error: 'Building not found' });\n      }\n      res.json(building);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch building' });\n    }\n  });\n\n  app.post('/api/buildings', async (req, res) => {\n    try {\n      const data = insertBuildingSchema.parse(req.body);\n      const building = await storage.createBuilding(data);\n      res.status(201).json(building);\n    } catch (error) {\n      res.status(400).json({ error: 'Invalid building data' });\n    }\n  });\n\n  app.put('/api/buildings/:id', async (req, res) => {\n    try {\n      const data = insertBuildingSchema.parse(req.body);\n      const building = await storage.updateBuilding(req.params.id, data);\n      if (!building) {\n        return res.status(404).json({ error: 'Building not found' });\n      }\n      res.json(building);\n    } catch (error) {\n      res.status(400).json({ error: 'Invalid building data' });\n    }\n  });\n\n  app.delete('/api/buildings/:id', async (req, res) => {\n    try {\n      const success = await storage.deleteBuilding(req.params.id);\n      if (!success) {\n        return res.status(404).json({ error: 'Building not found' });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to delete building' });\n    }\n  });\n\n  app.get('/api/floors', async (req, res) => {\n    try {\n      const floors = await storage.getFloors();\n      res.json(floors);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch floors' });\n    }\n  });\n\n  app.get('/api/floors/:id', async (req, res) => {\n    try {\n      const floor = await storage.getFloor(req.params.id);\n      if (!floor) {\n        return res.status(404).json({ error: 'Floor not found' });\n      }\n      res.json(floor);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch floor' });\n    }\n  });\n\n  app.post('/api/floors', async (req, res) => {\n    try {\n      const data = insertFloorSchema.parse(req.body);\n      const floor = await storage.createFloor(data);\n      res.status(201).json(floor);\n    } catch (error) {\n      res.status(400).json({ error: 'Invalid floor data' });\n    }\n  });\n\n  app.put('/api/floors/:id', async (req, res) => {\n    try {\n      const data = insertFloorSchema.parse(req.body);\n      const floor = await storage.updateFloor(req.params.id, data);\n      if (!floor) {\n        return res.status(404).json({ error: 'Floor not found' });\n      }\n      res.json(floor);\n    } catch (error) {\n      res.status(400).json({ error: 'Invalid floor data' });\n    }\n  });\n\n  app.delete('/api/floors/:id', async (req, res) => {\n    try {\n      const success = await storage.deleteFloor(req.params.id);\n      if (!success) {\n        return res.status(404).json({ error: 'Floor not found' });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to delete floor' });\n    }\n  });\n\n  app.get('/api/rooms', async (req, res) => {\n    try {\n      const rooms = await storage.getRooms();\n      res.json(rooms);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch rooms' });\n    }\n  });\n\n  app.get('/api/rooms/:id', async (req, res) => {\n    try {\n      const room = await storage.getRoom(req.params.id);\n      if (!room) {\n        return res.status(404).json({ error: 'Room not found' });\n      }\n      res.json(room);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch room' });\n    }\n  });\n\n  app.post('/api/rooms', async (req, res) => {\n    try {\n      const data = insertRoomSchema.parse(req.body);\n      const room = await storage.createRoom(data);\n      res.status(201).json(room);\n    } catch (error) {\n      res.status(400).json({ error: 'Invalid room data' });\n    }\n  });\n\n  app.put('/api/rooms/:id', async (req, res) => {\n    try {\n      const data = insertRoomSchema.parse(req.body);\n      const room = await storage.updateRoom(req.params.id, data);\n      if (!room) {\n        return res.status(404).json({ error: 'Room not found' });\n      }\n      res.json(room);\n    } catch (error) {\n      res.status(400).json({ error: 'Invalid room data' });\n    }\n  });\n\n  app.delete('/api/rooms/:id', async (req, res) => {\n    try {\n      const success = await storage.deleteRoom(req.params.id);\n      if (!success) {\n        return res.status(404).json({ error: 'Room not found' });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to delete room' });\n    }\n  });\n\n  app.get('/api/staff', async (req, res) => {\n    try {\n      const staff = await storage.getStaff();\n      res.json(staff);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch staff' });\n    }\n  });\n\n  app.get('/api/staff/:id', async (req, res) => {\n    try {\n      const staff = await storage.getStaffMember(req.params.id);\n      if (!staff) {\n        return res.status(404).json({ error: 'Staff member not found' });\n      }\n      res.json(staff);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch staff member' });\n    }\n  });\n\n  app.post('/api/staff', async (req, res) => {\n    try {\n      const data = insertStaffSchema.parse(req.body);\n      \n      // Validate that buildingId (if provided) belongs to a staff-allowed POI type\n      if (data.buildingId) {\n        const building = await storage.getBuilding(data.buildingId);\n        if (!building) {\n          return res.status(400).json({ error: 'Building not found' });\n        }\n        if (!canHaveStaff(building.type as POIType)) {\n          return res.status(400).json({ \n            error: `Staff cannot be assigned to ${building.type} POI type. Allowed types: Building, Security Office / Campus Police, Gym / Sports Facility, Library, Administrative Office, Health Services / Clinic` \n          });\n        }\n      }\n      \n      const staff = await storage.createStaff(data);\n      res.status(201).json(staff);\n    } catch (error) {\n      res.status(400).json({ error: 'Invalid staff data' });\n    }\n  });\n\n  app.put('/api/staff/:id', async (req, res) => {\n    try {\n      const data = insertStaffSchema.parse(req.body);\n      \n      // Validate that buildingId (if provided) belongs to a staff-allowed POI type\n      if (data.buildingId) {\n        const building = await storage.getBuilding(data.buildingId);\n        if (!building) {\n          return res.status(400).json({ error: 'Building not found' });\n        }\n        if (!canHaveStaff(building.type as POIType)) {\n          return res.status(400).json({ \n            error: `Staff cannot be assigned to ${building.type} POI type. Allowed types: Building, Security Office / Campus Police, Gym / Sports Facility, Library, Administrative Office, Health Services / Clinic` \n          });\n        }\n      }\n      \n      const staff = await storage.updateStaff(req.params.id, data);\n      if (!staff) {\n        return res.status(404).json({ error: 'Staff member not found' });\n      }\n      res.json(staff);\n    } catch (error) {\n      res.status(400).json({ error: 'Invalid staff data' });\n    }\n  });\n\n  app.delete('/api/staff/:id', async (req, res) => {\n    try {\n      const success = await storage.deleteStaff(req.params.id);\n      if (!success) {\n        return res.status(404).json({ error: 'Staff member not found' });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to delete staff member' });\n    }\n  });\n\n  app.get('/api/events', async (req, res) => {\n    try {\n      const events = await storage.getEvents();\n      res.json(events);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch events' });\n    }\n  });\n\n  app.get('/api/events/:id', async (req, res) => {\n    try {\n      const event = await storage.getEvent(req.params.id);\n      if (!event) {\n        return res.status(404).json({ error: 'Event not found' });\n      }\n      res.json(event);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch event' });\n    }\n  });\n\n  app.post('/api/events', async (req, res) => {\n    try {\n      const data = insertEventSchema.parse(req.body);\n      const event = await storage.createEvent(data);\n      res.status(201).json(event);\n    } catch (error) {\n      res.status(400).json({ error: 'Invalid event data' });\n    }\n  });\n\n  app.put('/api/events/:id', async (req, res) => {\n    try {\n      const data = insertEventSchema.parse(req.body);\n      const event = await storage.updateEvent(req.params.id, data);\n      if (!event) {\n        return res.status(404).json({ error: 'Event not found' });\n      }\n      res.json(event);\n    } catch (error) {\n      res.status(400).json({ error: 'Invalid event data' });\n    }\n  });\n\n  app.delete('/api/events/:id', async (req, res) => {\n    try {\n      const success = await storage.deleteEvent(req.params.id);\n      if (!success) {\n        return res.status(404).json({ error: 'Event not found' });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to delete event' });\n    }\n  });\n\n  app.get('/api/walkpaths', async (req, res) => {\n    try {\n      const walkpaths = await storage.getWalkpaths();\n      res.json(walkpaths);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch walkpaths' });\n    }\n  });\n\n  app.get('/api/walkpaths/:id', async (req, res) => {\n    try {\n      const walkpath = await storage.getWalkpath(req.params.id);\n      if (!walkpath) {\n        return res.status(404).json({ error: 'Walkpath not found' });\n      }\n      res.json(walkpath);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch walkpath' });\n    }\n  });\n\n  app.post('/api/walkpaths', async (req, res) => {\n    try {\n      const data = insertWalkpathSchema.parse(req.body);\n      const walkpath = await storage.createWalkpath(data);\n      res.status(201).json(walkpath);\n    } catch (error) {\n      res.status(400).json({ error: 'Invalid walkpath data' });\n    }\n  });\n\n  app.put('/api/walkpaths/:id', async (req, res) => {\n    try {\n      const data = insertWalkpathSchema.parse(req.body);\n      const walkpath = await storage.updateWalkpath(req.params.id, data);\n      if (!walkpath) {\n        return res.status(404).json({ error: 'Walkpath not found' });\n      }\n      res.json(walkpath);\n    } catch (error) {\n      res.status(400).json({ error: 'Invalid walkpath data' });\n    }\n  });\n\n  app.delete('/api/walkpaths/:id', async (req, res) => {\n    try {\n      const success = await storage.deleteWalkpath(req.params.id);\n      if (!success) {\n        return res.status(404).json({ error: 'Walkpath not found' });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to delete walkpath' });\n    }\n  });\n\n  app.get('/api/drivepaths', async (req, res) => {\n    try {\n      const drivepaths = await storage.getDrivepaths();\n      res.json(drivepaths);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch drivepaths' });\n    }\n  });\n\n  app.get('/api/drivepaths/:id', async (req, res) => {\n    try {\n      const drivepath = await storage.getDrivepath(req.params.id);\n      if (!drivepath) {\n        return res.status(404).json({ error: 'Drivepath not found' });\n      }\n      res.json(drivepath);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to fetch drivepath' });\n    }\n  });\n\n  app.post('/api/drivepaths', async (req, res) => {\n    try {\n      const data = insertDrivepathSchema.parse(req.body);\n      const drivepath = await storage.createDrivepath(data);\n      res.status(201).json(drivepath);\n    } catch (error) {\n      res.status(400).json({ error: 'Invalid drivepath data' });\n    }\n  });\n\n  app.put('/api/drivepaths/:id', async (req, res) => {\n    try {\n      const data = insertDrivepathSchema.parse(req.body);\n      const drivepath = await storage.updateDrivepath(req.params.id, data);\n      if (!drivepath) {\n        return res.status(404).json({ error: 'Drivepath not found' });\n      }\n      res.json(drivepath);\n    } catch (error) {\n      res.status(400).json({ error: 'Invalid drivepath data' });\n    }\n  });\n\n  app.delete('/api/drivepaths/:id', async (req, res) => {\n    try {\n      const success = await storage.deleteDrivepath(req.params.id);\n      if (!success) {\n        return res.status(404).json({ error: 'Drivepath not found' });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to delete drivepath' });\n    }\n  });\n\n  const routeSchema = z.object({\n    startId: z.string(),\n    startLat: z.number().optional(),\n    startLng: z.number().optional(),\n    endId: z.string(),\n    mode: z.enum(['walking', 'driving'])\n  });\n\n  app.post('/api/routes/calculate', async (req, res) => {\n    try {\n      const { startId, startLat, startLng, endId, mode } = routeSchema.parse(req.body);\n      \n      let startBuilding;\n      if (startId === 'kiosk' && startLat !== undefined && startLng !== undefined) {\n        startBuilding = {\n          id: 'kiosk',\n          name: 'Your Location (Kiosk)',\n          lat: startLat,\n          lng: startLng,\n          type: 'Kiosk',\n          description: null,\n          departments: null,\n          image: null,\n          markerIcon: null\n        };\n      } else {\n        startBuilding = await storage.getBuilding(startId);\n      }\n      \n      const endBuilding = await storage.getBuilding(endId);\n      \n      if (!startBuilding || !endBuilding) {\n        return res.status(404).json({ error: 'Building not found' });\n      }\n\n      const paths = mode === 'walking' \n        ? await storage.getWalkpaths()\n        : await storage.getDrivepaths();\n\n      const route = findShortestPath(startBuilding, endBuilding, paths);\n\n      if (!route) {\n        return res.status(404).json({ error: 'No route found' });\n      }\n\n      res.json({ route });\n    } catch (error) {\n      res.status(400).json({ error: 'Invalid request' });\n    }\n  });\n\n  const httpServer = createServer(app);\n\n  return httpServer;\n}\n","size_bytes":16722},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"Roboto\", \"sans-serif\"],\n        serif: [\"Georgia\", \"serif\"],\n        mono: [\"Roboto Mono\", \"monospace\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":4061},"client/src/pages/admin-paths.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Route as RouteIcon, Plus, Pencil, Trash2 } from \"lucide-react\";\nimport { Card } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport AdminLayout from \"@/components/admin-layout\";\nimport CampusMap from \"@/components/campus-map\";\nimport PathDrawingMap from \"@/components/path-drawing-map\";\nimport type { Building } from \"@shared/schema\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"@/components/ui/alert-dialog\";\n\ninterface PathNode {\n  lat: number;\n  lng: number;\n}\n\nexport default function AdminPaths() {\n  const [activeTab, setActiveTab] = useState(\"walkpaths\");\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingPath, setEditingPath] = useState<any | null>(null);\n  const [editingPathType, setEditingPathType] = useState<'walkpath' | 'drivepath' | null>(null);\n  const [deletingPath, setDeletingPath] = useState<any | null>(null);\n  const [pathName, setPathName] = useState(\"\");\n  const [pathNodes, setPathNodes] = useState<PathNode[]>([]);\n  const { toast } = useToast();\n\n  const { data: buildings = [] } = useQuery<Building[]>({\n    queryKey: ['/api/buildings']\n  });\n\n  const { data: walkpaths = [] } = useQuery<any[]>({\n    queryKey: ['/api/walkpaths']\n  });\n\n  const { data: drivepaths = [] } = useQuery<any[]>({\n    queryKey: ['/api/drivepaths']\n  });\n\n  const createWalkpath = useMutation({\n    mutationFn: (data: any) => apiRequest('POST', '/api/walkpaths', data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/walkpaths'] });\n      toast({ title: \"Walkpath created successfully\" });\n      setIsDialogOpen(false);\n      setPathName(\"\");\n      setPathNodes([]);\n    },\n  });\n\n  const createDrivepath = useMutation({\n    mutationFn: (data: any) => apiRequest('POST', '/api/drivepaths', data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/drivepaths'] });\n      toast({ title: \"Drivepath created successfully\" });\n      setIsDialogOpen(false);\n      setPathName(\"\");\n      setPathNodes([]);\n    },\n  });\n\n  const updateWalkpath = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: any }) => apiRequest('PUT', `/api/walkpaths/${id}`, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/walkpaths'] });\n      toast({ title: \"Walkpath updated successfully\" });\n      setIsDialogOpen(false);\n      setEditingPath(null);\n      setPathName(\"\");\n      setPathNodes([]);\n    },\n  });\n\n  const updateDrivepath = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: any }) => apiRequest('PUT', `/api/drivepaths/${id}`, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/drivepaths'] });\n      toast({ title: \"Drivepath updated successfully\" });\n      setIsDialogOpen(false);\n      setEditingPath(null);\n      setPathName(\"\");\n      setPathNodes([]);\n    },\n  });\n\n  const deleteWalkpath = useMutation({\n    mutationFn: (id: string) => apiRequest('DELETE', `/api/walkpaths/${id}`, null),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/walkpaths'] });\n      toast({ title: \"Walkpath deleted successfully\" });\n      setDeletingPath(null);\n    },\n  });\n\n  const deleteDrivepath = useMutation({\n    mutationFn: (id: string) => apiRequest('DELETE', `/api/drivepaths/${id}`, null),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/drivepaths'] });\n      toast({ title: \"Drivepath deleted successfully\" });\n      setDeletingPath(null);\n    },\n  });\n\n  const handleOpenDialog = (path?: any, pathType?: 'walkpath' | 'drivepath') => {\n    if (path) {\n      setEditingPath(path);\n      setEditingPathType(pathType ?? (activeTab === 'walkpaths' ? 'walkpath' : 'drivepath'));\n      setPathName(path.name || \"\");\n      setPathNodes(Array.isArray(path.nodes) ? path.nodes : []);\n    } else {\n      setEditingPath(null);\n      setEditingPathType(null);\n      setPathName(\"\");\n      setPathNodes([]);\n    }\n    setIsDialogOpen(true);\n  };\n\n  const handleCloseDialog = () => {\n    setIsDialogOpen(false);\n    setEditingPath(null);\n    setEditingPathType(null);\n    setPathName(\"\");\n    setPathNodes([]);\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (pathNodes.length < 2) {\n      toast({ title: \"Please add at least 2 waypoints to create a path\", variant: \"destructive\" });\n      return;\n    }\n\n    const data = {\n      name: pathName,\n      nodes: pathNodes\n    };\n\n    if (editingPath) {\n      if (editingPathType === \"walkpath\") {\n        updateWalkpath.mutate({ id: editingPath.id, data });\n      } else {\n        updateDrivepath.mutate({ id: editingPath.id, data });\n      }\n    } else {\n      if (activeTab === \"walkpaths\") {\n        createWalkpath.mutate(data);\n      } else {\n        createDrivepath.mutate(data);\n      }\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"p-8\">\n        <div className=\"mb-8 flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-foreground\">Path Management</h1>\n            <p className=\"text-muted-foreground\">Manage walking and driving paths for navigation</p>\n          </div>\n          <Dialog open={isDialogOpen} onOpenChange={(open) => open ? handleOpenDialog() : handleCloseDialog()}>\n            <DialogTrigger asChild>\n              <Button data-testid=\"button-add-path\">\n                <Plus className=\"w-4 h-4 mr-2\" />\n                Add Path\n              </Button>\n            </DialogTrigger>\n            <DialogContent>\n              <DialogHeader>\n                <DialogTitle>{editingPath ? 'Edit' : 'Add'} {activeTab === \"walkpaths\" ? \"Walking\" : \"Driving\"} Path</DialogTitle>\n                <p className=\"text-sm text-muted-foreground\">\n                  {editingPath ? 'Update' : 'Create a new'} {activeTab === \"walkpaths\" ? \"walking\" : \"driving\"} path by clicking on the map\n                </p>\n              </DialogHeader>\n              <form onSubmit={handleSubmit} className=\"space-y-4\">\n                <div>\n                  <Label htmlFor=\"name\">Path Name</Label>\n                  <Input\n                    id=\"name\"\n                    value={pathName}\n                    onChange={(e) => setPathName(e.target.value)}\n                    required\n                    data-testid=\"input-path-name\"\n                  />\n                </div>\n                <div>\n                  <Label>Draw Path on Map</Label>\n                  <PathDrawingMap\n                    nodes={pathNodes}\n                    onNodesChange={setPathNodes}\n                    mode={activeTab === \"walkpaths\" ? \"walking\" : \"driving\"}\n                  />\n                </div>\n                <Button type=\"submit\" className=\"w-full\" disabled={pathNodes.length < 2}>{editingPath ? 'Update Path' : 'Create Path'}</Button>\n              </form>\n            </DialogContent>\n          </Dialog>\n        </div>\n\n        <Tabs value={activeTab} onValueChange={setActiveTab}>\n          <TabsList className=\"mb-6\">\n            <TabsTrigger value=\"walkpaths\" data-testid=\"tab-walkpaths\">\n              Walking Paths\n            </TabsTrigger>\n            <TabsTrigger value=\"drivepaths\" data-testid=\"tab-drivepaths\">\n              Driving Paths\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"walkpaths\">\n            <div className=\"grid lg:grid-cols-3 gap-6\">\n              <div className=\"lg:col-span-2\">\n                <Card className=\"h-[600px] overflow-hidden\">\n                  <CampusMap buildings={buildings} />\n                </Card>\n              </div>\n\n              <div>\n                <Card className=\"p-6\">\n                  <h2 className=\"text-lg font-semibold text-foreground mb-4\">Walking Paths</h2>\n                  {walkpaths.length === 0 ? (\n                    <div className=\"text-center py-8\">\n                      <RouteIcon className=\"w-12 h-12 text-muted-foreground mx-auto mb-2\" />\n                      <p className=\"text-sm text-muted-foreground\">No walking paths yet</p>\n                    </div>\n                  ) : (\n                    <div className=\"space-y-3\">\n                      {walkpaths.map((path, index) => (\n                        <div\n                          key={path.id || index}\n                          className=\"p-3 bg-muted/50 rounded-lg\"\n                          data-testid={`walkpath-${index}`}\n                        >\n                          <div className=\"flex items-start justify-between gap-2\">\n                            <div className=\"flex-1\">\n                              <p className=\"font-medium text-foreground\">\n                                {path.name || `Path ${index + 1}`}\n                              </p>\n                              <p className=\"text-sm text-muted-foreground\">\n                                {Array.isArray(path.nodes) ? path.nodes.length : 0} waypoints\n                              </p>\n                            </div>\n                            <div className=\"flex gap-1\">\n                              <Button\n                                size=\"icon\"\n                                variant=\"ghost\"\n                                onClick={() => handleOpenDialog(path, 'walkpath')}\n                                data-testid={`button-edit-walkpath-${index}`}\n                              >\n                                <Pencil className=\"w-4 h-4\" />\n                              </Button>\n                              <Button\n                                size=\"icon\"\n                                variant=\"ghost\"\n                                onClick={() => setDeletingPath({ ...path, type: 'walkpath' })}\n                                data-testid={`button-delete-walkpath-${index}`}\n                              >\n                                <Trash2 className=\"w-4 h-4 text-destructive\" />\n                              </Button>\n                            </div>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                </Card>\n              </div>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"drivepaths\">\n            <div className=\"grid lg:grid-cols-3 gap-6\">\n              <div className=\"lg:col-span-2\">\n                <Card className=\"h-[600px] overflow-hidden\">\n                  <CampusMap buildings={buildings} />\n                </Card>\n              </div>\n\n              <div>\n                <Card className=\"p-6\">\n                  <h2 className=\"text-lg font-semibold text-foreground mb-4\">Driving Paths</h2>\n                  {drivepaths.length === 0 ? (\n                    <div className=\"text-center py-8\">\n                      <RouteIcon className=\"w-12 h-12 text-muted-foreground mx-auto mb-2\" />\n                      <p className=\"text-sm text-muted-foreground\">No driving paths yet</p>\n                    </div>\n                  ) : (\n                    <div className=\"space-y-3\">\n                      {drivepaths.map((path, index) => (\n                        <div\n                          key={path.id || index}\n                          className=\"p-3 bg-muted/50 rounded-lg\"\n                          data-testid={`drivepath-${index}`}\n                        >\n                          <div className=\"flex items-start justify-between gap-2\">\n                            <div className=\"flex-1\">\n                              <p className=\"font-medium text-foreground\">\n                                {path.name || `Path ${index + 1}`}\n                              </p>\n                              <p className=\"text-sm text-muted-foreground\">\n                                {Array.isArray(path.nodes) ? path.nodes.length : 0} waypoints\n                              </p>\n                            </div>\n                            <div className=\"flex gap-1\">\n                              <Button\n                                size=\"icon\"\n                                variant=\"ghost\"\n                                onClick={() => handleOpenDialog(path, 'drivepath')}\n                                data-testid={`button-edit-drivepath-${index}`}\n                              >\n                                <Pencil className=\"w-4 h-4\" />\n                              </Button>\n                              <Button\n                                size=\"icon\"\n                                variant=\"ghost\"\n                                onClick={() => setDeletingPath({ ...path, type: 'drivepath' })}\n                                data-testid={`button-delete-drivepath-${index}`}\n                              >\n                                <Trash2 className=\"w-4 h-4 text-destructive\" />\n                              </Button>\n                            </div>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                </Card>\n              </div>\n            </div>\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      <AlertDialog open={!!deletingPath} onOpenChange={(open) => !open && setDeletingPath(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Path</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to delete \"{deletingPath?.name || 'this path'}\"? This action cannot be undone.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => {\n                if (deletingPath) {\n                  if (deletingPath.type === 'walkpath') {\n                    deleteWalkpath.mutate(deletingPath.id);\n                  } else {\n                    deleteDrivepath.mutate(deletingPath.id);\n                  }\n                }\n              }}\n              className=\"bg-destructive text-destructive-foreground\"\n            >\n              Delete\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </AdminLayout>\n  );\n}\n","size_bytes":14859},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1592},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/pages/about.tsx":{"content":"import { ArrowLeft, Map, Navigation as NavigationIcon, Users, Calendar, Smartphone, Wifi } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { useGlobalInactivity } from \"@/hooks/use-inactivity\";\n\nexport default function About() {\n  // Return to home after 3 minutes of inactivity\n  useGlobalInactivity();\n  const features = [\n    {\n      icon: Map,\n      title: \"Interactive Campus Map\",\n      description: \"Explore the CVSU CCAT campus with our detailed interactive map showing all buildings and facilities\"\n    },\n    {\n      icon: NavigationIcon,\n      title: \"Turn-by-Turn Navigation\",\n      description: \"Get walking or driving directions to any location on campus with step-by-step guidance\"\n    },\n    {\n      icon: Users,\n      title: \"Staff Directory\",\n      description: \"Quickly find faculty and staff members with our comprehensive searchable directory\"\n    },\n    {\n      icon: Calendar,\n      title: \"Events & Announcements\",\n      description: \"Stay informed about upcoming events, activities, and important campus announcements\"\n    },\n    {\n      icon: Smartphone,\n      title: \"Touch-Optimized Interface\",\n      description: \"Large, easy-to-use buttons and controls designed specifically for kiosk interaction\"\n    },\n    {\n      icon: Wifi,\n      title: \"Offline Capability\",\n      description: \"Access essential information even when internet connectivity is limited\"\n    }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"bg-card border-b border-card-border p-4 sticky top-0 z-10\">\n        <div className=\"max-w-7xl mx-auto flex items-center gap-4\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"icon\" data-testid=\"button-back\">\n              <ArrowLeft className=\"w-5 h-5\" />\n            </Button>\n          </Link>\n          <div>\n            <h1 className=\"text-2xl font-semibold text-foreground\">About iCCAT</h1>\n            <p className=\"text-sm text-muted-foreground\">Learn about this kiosk system</p>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"max-w-5xl mx-auto px-6 py-12\">\n        <div className=\"text-center mb-12\">\n          <div className=\"inline-flex items-center justify-center w-20 h-20 bg-primary rounded-lg mb-4\">\n            <Map className=\"w-12 h-12 text-primary-foreground\" />\n          </div>\n          <h2 className=\"text-4xl font-bold text-foreground mb-4\">\n            iCCAT\n          </h2>\n          <p className=\"text-xl text-muted-foreground mb-2\">\n            Interactive Campus Companion & Assistance Terminal\n          </p>\n          <p className=\"text-lg text-muted-foreground max-w-2xl mx-auto\">\n            Your smart wayfinding and information system for Cavite State University CCAT Campus\n          </p>\n        </div>\n\n        <div className=\"mb-12\">\n          <Card className=\"p-8\">\n            <h3 className=\"text-2xl font-semibold text-foreground mb-4\">Welcome to CVSU CCAT</h3>\n            <p className=\"text-lg text-muted-foreground mb-4\">\n              The Interactive Campus Companion and Assistance Terminal (iCCAT) is designed to help students, \n              faculty, staff, and visitors navigate the Cavite State University CCAT Campus with ease.\n            </p>\n            <p className=\"text-lg text-muted-foreground\">\n              Whether you're looking for a specific building, trying to find a faculty member, checking out \n              upcoming events, or simply exploring the campus, iCCAT provides all the information you need in \n              one convenient, user-friendly interface.\n            </p>\n          </Card>\n        </div>\n\n        <div className=\"mb-12\">\n          <h3 className=\"text-2xl font-semibold text-foreground mb-6\">Key Features</h3>\n          <div className=\"grid md:grid-cols-2 gap-6\">\n            {features.map((feature, index) => (\n              <Card key={index} className=\"p-6\" data-testid={`feature-card-${index}`}>\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"flex-shrink-0 w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center\">\n                    <feature.icon className=\"w-6 h-6 text-primary\" />\n                  </div>\n                  <div>\n                    <h4 className=\"text-lg font-semibold text-foreground mb-2\">{feature.title}</h4>\n                    <p className=\"text-base text-muted-foreground\">{feature.description}</p>\n                  </div>\n                </div>\n              </Card>\n            ))}\n          </div>\n        </div>\n\n        <div>\n          <Card className=\"p-8 bg-primary/5 border-primary/20\">\n            <h3 className=\"text-2xl font-semibold text-foreground mb-4\">Need Help?</h3>\n            <p className=\"text-lg text-muted-foreground mb-4\">\n              If you have any questions or need assistance using this kiosk, please don't hesitate to ask \n              any nearby campus personnel. They'll be happy to help you find what you're looking for.\n            </p>\n            <div className=\"flex gap-4\">\n              <Link href=\"/\">\n                <Button data-testid=\"button-home\">\n                  Return to Home\n                </Button>\n              </Link>\n              <Link href=\"/navigation\">\n                <Button variant=\"outline\" data-testid=\"button-start-navigation\">\n                  Start Navigation\n                </Button>\n              </Link>\n            </div>\n          </Card>\n        </div>\n      </main>\n    </div>\n  );\n}\n","size_bytes":5575},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5741},"client/src/pages/admin-floor-plans.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Layers, Building2, Plus, Pencil, Trash2, Filter } from \"lucide-react\";\nimport { Card } from \"@/components/ui/card\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport AdminLayout from \"@/components/admin-layout\";\nimport type { Building, Floor, Room } from \"@shared/schema\";\nimport { poiTypes, canHaveFloorPlan, floorPlanEligibleTypes } from \"@shared/schema\";\nimport FloorPlanViewer from \"@/components/floor-plan-viewer\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"@/components/ui/alert-dialog\";\n\nexport default function AdminFloorPlans() {\n  const [selectedBuildingId, setSelectedBuildingId] = useState<string>(\"\");\n  const [selectedFloor, setSelectedFloor] = useState<Floor | null>(null);\n  const [isFloorDialogOpen, setIsFloorDialogOpen] = useState(false);\n  const [editingFloor, setEditingFloor] = useState<Floor | null>(null);\n  const [deletingFloor, setDeletingFloor] = useState<Floor | null>(null);\n  const [floorData, setFloorData] = useState({ floorNumber: \"\", floorName: \"\", image: \"\" });\n  const [filterType, setFilterType] = useState<string>(\"all\");\n  const { toast } = useToast();\n\n  const { data: buildings = [] } = useQuery<Building[]>({\n    queryKey: ['/api/buildings']\n  });\n\n  const { data: floors = [] } = useQuery<Floor[]>({\n    queryKey: ['/api/floors']\n  });\n\n  const { data: rooms = [] } = useQuery<Room[]>({\n    queryKey: ['/api/rooms']\n  });\n\n  const createFloor = useMutation({\n    mutationFn: (data: any) => apiRequest('POST', '/api/floors', data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/floors'] });\n      toast({ title: \"Floor created successfully\" });\n      setIsFloorDialogOpen(false);\n      setFloorData({ floorNumber: \"\", floorName: \"\", image: \"\" });\n    },\n  });\n\n  const updateFloor = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: any }) => apiRequest('PUT', `/api/floors/${id}`, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/floors'] });\n      toast({ title: \"Floor updated successfully\" });\n      setIsFloorDialogOpen(false);\n      setEditingFloor(null);\n      setFloorData({ floorNumber: \"\", floorName: \"\", image: \"\" });\n    },\n  });\n\n  const createRoom = useMutation({\n    mutationFn: (data: any) => apiRequest('POST', '/api/rooms', data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/rooms'] });\n      toast({ title: \"Room created successfully\" });\n    },\n  });\n\n  const updateRoom = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: any }) => apiRequest('PUT', `/api/rooms/${id}`, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/rooms'] });\n      toast({ title: \"Room updated successfully\" });\n    },\n  });\n\n  const deleteFloor = useMutation({\n    mutationFn: (id: string) => apiRequest('DELETE', `/api/floors/${id}`, null),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/floors'] });\n      toast({ title: \"Floor deleted successfully\" });\n      setDeletingFloor(null);\n    },\n  });\n\n  const deleteRoom = useMutation({\n    mutationFn: (id: string) => apiRequest('DELETE', `/api/rooms/${id}`, null),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/rooms'] });\n      toast({ title: \"Room deleted successfully\" });\n    },\n  });\n\n  // Only show buildings that can have floor plans\n  const floorPlanEligibleBuildings = buildings.filter(b => canHaveFloorPlan(b.type as any));\n  \n  const filteredBuildings = filterType === \"all\" \n    ? floorPlanEligibleBuildings \n    : floorPlanEligibleBuildings.filter(b => b.type === filterType);\n\n  const buildingFloors = selectedBuildingId\n    ? floors.filter(f => f.buildingId === selectedBuildingId)\n    : [];\n\n  const floorRooms = selectedFloor\n    ? rooms.filter(r => r.floorId === selectedFloor.id)\n    : [];\n\n  const handleOpenFloorDialog = (floor?: Floor) => {\n    if (floor) {\n      setEditingFloor(floor);\n      setFloorData({\n        floorNumber: floor.floorNumber.toString(),\n        floorName: floor.floorName || \"\",\n        image: floor.floorPlanImage || \"\"\n      });\n    } else {\n      setEditingFloor(null);\n      setFloorData({ floorNumber: \"\", floorName: \"\", image: \"\" });\n    }\n    setIsFloorDialogOpen(true);\n  };\n\n  const handleCloseFloorDialog = () => {\n    setIsFloorDialogOpen(false);\n    setEditingFloor(null);\n    setFloorData({ floorNumber: \"\", floorName: \"\", image: \"\" });\n  };\n\n  const handleCreateFloor = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!selectedBuildingId) return;\n    \n    const data = {\n      buildingId: selectedBuildingId,\n      floorNumber: parseInt(floorData.floorNumber),\n      floorName: floorData.floorName || null,\n      floorPlanImage: floorData.image || null\n    };\n\n    if (editingFloor) {\n      updateFloor.mutate({ id: editingFloor.id, data });\n    } else {\n      createFloor.mutate(data);\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"p-8\">\n        <div className=\"mb-8 flex items-center justify-between flex-wrap gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-foreground\">Floor Plan Management</h1>\n            <p className=\"text-muted-foreground\">Manage building floor plans and room markers</p>\n          </div>\n          <Dialog open={isFloorDialogOpen} onOpenChange={(open) => open ? handleOpenFloorDialog() : handleCloseFloorDialog()}>\n            <DialogTrigger asChild>\n              <Button disabled={!selectedBuildingId} data-testid=\"button-add-floor\">\n                <Plus className=\"w-4 h-4 mr-2\" />\n                Add Floor\n              </Button>\n            </DialogTrigger>\n              <DialogContent>\n                <DialogHeader>\n                  <DialogTitle>{editingFloor ? 'Edit' : 'Add'} Floor Plan</DialogTitle>\n                  <p className=\"text-sm text-muted-foreground\">\n                    {editingFloor ? 'Update' : 'Create a new'} floor for the selected building\n                  </p>\n                </DialogHeader>\n                <form onSubmit={handleCreateFloor} className=\"space-y-4\">\n                  <div>\n                    <Label htmlFor=\"floorNumber\">Floor Number *</Label>\n                    <Input\n                      id=\"floorNumber\"\n                      type=\"number\"\n                      value={floorData.floorNumber}\n                      onChange={(e) => setFloorData({ ...floorData, floorNumber: e.target.value })}\n                      required\n                    />\n                  </div>\n                  <div>\n                    <Label htmlFor=\"floorName\">Floor Name</Label>\n                    <Input\n                      id=\"floorName\"\n                      value={floorData.floorName}\n                      onChange={(e) => setFloorData({ ...floorData, floorName: e.target.value })}\n                    />\n                  </div>\n                  <div>\n                    <Label htmlFor=\"image\">Floor Plan Image URL</Label>\n                    <Input\n                      id=\"image\"\n                      value={floorData.image}\n                      onChange={(e) => setFloorData({ ...floorData, image: e.target.value })}\n                      placeholder=\"https://example.com/floorplan.png\"\n                    />\n                  </div>\n                  <Button type=\"submit\" className=\"w-full\">{editingFloor ? 'Update Floor' : 'Create Floor'}</Button>\n                </form>\n              </DialogContent>\n            </Dialog>\n        </div>\n\n        <div className=\"grid lg:grid-cols-3 gap-6\">\n          <div className=\"lg:col-span-2\">\n            <Card className=\"p-6\">\n              <div className=\"mb-6 space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-foreground mb-2 flex items-center gap-2\">\n                    <Filter className=\"w-4 h-4\" />\n                    Filter by Building Type\n                  </label>\n                  <Select value={filterType} onValueChange={setFilterType}>\n                    <SelectTrigger data-testid=\"select-building-type-filter\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"all\">All Eligible Types</SelectItem>\n                      {Array.from(floorPlanEligibleTypes).map(type => (\n                        <SelectItem key={type} value={type}>\n                          {type}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-foreground mb-2\">\n                    Select Building\n                  </label>\n                  <Select value={selectedBuildingId} onValueChange={setSelectedBuildingId}>\n                    <SelectTrigger data-testid=\"select-building\">\n                      <SelectValue placeholder=\"Choose a building\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {filteredBuildings.map(building => (\n                        <SelectItem key={building.id} value={building.id}>\n                          {building.name} • {building.type}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n\n              {selectedBuildingId ? (\n                buildingFloors.length > 0 ? (\n                  <div className=\"space-y-3\">\n                    {buildingFloors.map((floor) => (\n                      <div\n                        key={floor.id}\n                        className={`flex items-center justify-between p-4 rounded-lg ${\n                          selectedFloor?.id === floor.id ? 'bg-primary/20 border-2 border-primary' : 'bg-muted/50'\n                        }`}\n                        data-testid={`floor-item-${floor.id}`}\n                      >\n                        <div \n                          className=\"flex items-center gap-3 flex-1 hover-elevate cursor-pointer rounded-md -m-4 p-4\"\n                          onClick={() => setSelectedFloor(floor)}\n                        >\n                          <div className={`w-10 h-10 rounded-lg flex items-center justify-center ${\n                            selectedFloor?.id === floor.id ? 'bg-primary text-primary-foreground' : 'bg-primary/10'\n                          }`}>\n                            <Layers className={`w-6 h-6 ${\n                              selectedFloor?.id === floor.id ? 'text-primary-foreground' : 'text-primary'\n                            }`} />\n                          </div>\n                          <div className=\"flex-1\">\n                            <p className=\"font-medium text-foreground\">\n                              {floor.floorName || `Floor ${floor.floorNumber}`}\n                            </p>\n                            <p className=\"text-sm text-muted-foreground\">\n                              Level {floor.floorNumber} • {rooms.filter(r => r.floorId === floor.id).length} rooms\n                            </p>\n                          </div>\n                        </div>\n                        <div className=\"flex gap-1\">\n                          <Button\n                            size=\"icon\"\n                            variant=\"ghost\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              handleOpenFloorDialog(floor);\n                            }}\n                            data-testid={`button-edit-floor-${floor.id}`}\n                          >\n                            <Pencil className=\"w-4 h-4\" />\n                          </Button>\n                          <Button\n                            size=\"icon\"\n                            variant=\"ghost\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              setDeletingFloor(floor);\n                            }}\n                            data-testid={`button-delete-floor-${floor.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4 text-destructive\" />\n                          </Button>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-16\">\n                    <Layers className=\"w-12 h-12 text-muted-foreground mx-auto mb-2\" />\n                    <p className=\"text-muted-foreground\">No floor plans for this building</p>\n                  </div>\n                )\n              ) : (\n                <div className=\"text-center py-16\">\n                  <Building2 className=\"w-12 h-12 text-muted-foreground mx-auto mb-2\" />\n                  <p className=\"text-muted-foreground\">Select a building to view floor plans</p>\n                </div>\n              )}\n            </Card>\n          </div>\n\n          <div>\n            <Card className=\"p-6\">\n              <h2 className=\"text-lg font-semibold text-foreground mb-4\">Floor Plan Editor</h2>\n              <div className=\"text-center py-8\">\n                <p className=\"text-sm text-muted-foreground mb-2\">\n                  Click on a floor plan to view and edit\n                </p>\n                <p className=\"text-xs text-muted-foreground\">\n                  Add room markers using the \"Add Room\" button\n                </p>\n              </div>\n            </Card>\n          </div>\n        </div>\n      </div>\n\n      {selectedFloor && (\n        <FloorPlanViewer\n          floor={selectedFloor}\n          rooms={floorRooms}\n          onClose={() => setSelectedFloor(null)}\n          onCreateRoom={(data) => {\n            createRoom.mutate(data);\n          }}\n          onUpdateRoom={(id, data) => {\n            updateRoom.mutate({ id, data });\n          }}\n          onDeleteRoom={(id) => {\n            deleteRoom.mutate(id);\n          }}\n        />\n      )}\n\n      <AlertDialog open={!!deletingFloor} onOpenChange={(open) => !open && setDeletingFloor(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Floor</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to delete \"{deletingFloor?.floorName || `Floor ${deletingFloor?.floorNumber}`}\"? This action cannot be undone and will also delete all rooms on this floor.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => {\n                if (deletingFloor) {\n                  deleteFloor.mutate(deletingFloor.id);\n                }\n              }}\n              className=\"bg-destructive text-destructive-foreground\"\n            >\n              Delete\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </AdminLayout>\n  );\n}\n","size_bytes":15734},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":1080},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-[1000] bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-[1001] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3856},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":21846},"client/src/pages/admin-login.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Map, LogIn } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nexport default function AdminLogin() {\n  const [, setLocation] = useLocation();\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const { toast } = useToast();\n\n  const handleLogin = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n\n    try {\n      const response = await fetch('/api/admin/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ username, password }),\n      });\n\n      if (response.ok) {\n        localStorage.setItem('isAdminAuthenticated', 'true');\n        toast({\n          title: \"Login Successful\",\n          description: \"Welcome to the admin panel\",\n        });\n        setLocation(\"/admin/dashboard\");\n      } else {\n        toast({\n          title: \"Login Failed\",\n          description: \"Invalid username or password\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error) {\n      toast({\n        title: \"Login Failed\",\n        description: \"Network error. Please try again.\",\n        variant: \"destructive\",\n      });\n    }\n\n    setIsLoading(false);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-primary/10 via-background to-accent/5 flex items-center justify-center p-6\">\n      <Card className=\"max-w-md w-full p-8\">\n        <div className=\"text-center mb-8\">\n          <div className=\"inline-flex items-center justify-center w-16 h-16 bg-primary rounded-lg mb-4\">\n            <Map className=\"w-10 h-10 text-primary-foreground\" />\n          </div>\n          <h1 className=\"text-3xl font-bold text-foreground mb-2\">Admin Access</h1>\n          <p className=\"text-muted-foreground\">Sign in to manage the kiosk system</p>\n        </div>\n\n        <form onSubmit={handleLogin} className=\"space-y-6\">\n          <div>\n            <Label htmlFor=\"username\" className=\"text-base\">Username</Label>\n            <Input\n              id=\"username\"\n              type=\"text\"\n              value={username}\n              onChange={(e) => setUsername(e.target.value)}\n              className=\"mt-2 h-12\"\n              placeholder=\"Enter your username\"\n              required\n              data-testid=\"input-username\"\n            />\n          </div>\n\n          <div>\n            <Label htmlFor=\"password\" className=\"text-base\">Password</Label>\n            <Input\n              id=\"password\"\n              type=\"password\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              className=\"mt-2 h-12\"\n              placeholder=\"Enter your password\"\n              required\n              data-testid=\"input-password\"\n            />\n          </div>\n\n          <Button\n            type=\"submit\"\n            className=\"w-full h-12\"\n            disabled={isLoading}\n            data-testid=\"button-login\"\n          >\n            <LogIn className=\"w-5 h-5 mr-2\" />\n            {isLoading ? \"Signing in...\" : \"Sign In\"}\n          </Button>\n\n          <div className=\"text-center\">\n            <a\n              href=\"/\"\n              className=\"text-sm text-muted-foreground hover:text-foreground\"\n              data-testid=\"link-back-home\"\n            >\n              ← Back to Kiosk\n            </a>\n          </div>\n        </form>\n\n        <div className=\"mt-8 p-4 bg-muted rounded-lg\">\n          <p className=\"text-xs text-muted-foreground text-center\">\n            Demo credentials: admin / admin123\n          </p>\n        </div>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":3934},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\nimport baselineData from \"./baseline-data.json\";\n\nconst DATA_CACHE_NAME = 'iccat-data-v3';\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\n\nconst offlineFirstQueryFn: QueryFunction = async ({ queryKey }) => {\n  const url = queryKey.join(\"/\") as string;\n  \n  try {\n    const res = await fetch(url, { credentials: \"include\" });\n    if (res.ok) {\n      return await res.json();\n    }\n  } catch (fetchError) {\n    console.log(`[OFFLINE-QUERY] Fetch failed for ${url} (offline or network error), trying cache...`);\n  }\n\n  if (window.caches) {\n    try {\n      const cache = await window.caches.open(DATA_CACHE_NAME);\n      const cachedResponse = await cache.match(url);\n      if (cachedResponse) {\n        console.log(`[OFFLINE-QUERY] Retrieved ${url} from CacheStorage`);\n        return await cachedResponse.json();\n      }\n    } catch (cacheError) {\n      console.error(`[OFFLINE-QUERY] CacheStorage error for ${url}:`, cacheError);\n    }\n  }\n\n  const dataKey = url.replace('/api/', '') as keyof typeof baselineData;\n  if (dataKey in baselineData) {\n    console.log(`[OFFLINE-QUERY] Using embedded baseline data for ${dataKey}`);\n    return baselineData[dataKey];\n  }\n\n  throw new Error(`No offline data available for ${url}`);\n};\n\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: offlineFirstQueryFn,\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":2552},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","size_bytes":1904},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/pages/landing.tsx":{"content":"import { Link } from \"wouter\";\nimport { Map, Calendar, Users, Info, Clock } from \"lucide-react\";\nimport { useEffect, useState } from \"react\";\nimport { useHomeInactivity } from \"@/hooks/use-inactivity\";\n\nexport default function Landing() {\n  const [currentTime, setCurrentTime] = useState(new Date());\n  \n  // Activate screensaver after 30 seconds of inactivity\n  useHomeInactivity();\n\n  useEffect(() => {\n    const timer = setInterval(() => {\n      setCurrentTime(new Date());\n    }, 1000);\n    return () => clearInterval(timer);\n  }, []);\n\n  const formatTime = (date: Date) => {\n    return date.toLocaleTimeString('en-US', {\n      hour: '2-digit',\n      minute: '2-digit',\n      second: '2-digit',\n      hour12: true\n    });\n  };\n\n  const formatDate = (date: Date) => {\n    return date.toLocaleDateString('en-US', {\n      weekday: 'long',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-primary/20 via-background to-accent/10 flex flex-col\">\n      <header className=\"p-6\">\n        <div className=\"max-w-7xl mx-auto\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-16 h-16 bg-primary rounded-lg flex items-center justify-center\">\n              <Map className=\"w-10 h-10 text-primary-foreground\" />\n            </div>\n            <div>\n              <h1 className=\"text-3xl font-bold text-foreground\">iCCAT</h1>\n              <p className=\"text-sm text-muted-foreground\">Interactive Campus Companion & Assistance Terminal</p>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"flex-1 flex items-center justify-center px-6 pb-12\">\n        <div className=\"max-w-5xl w-full\">\n          <div className=\"text-center mb-12\">\n            <div className=\"flex items-center justify-center gap-2 mb-4\">\n              <Clock className=\"w-5 h-5 text-primary\" />\n              <div className=\"text-lg text-muted-foreground\">{formatDate(currentTime)}</div>\n            </div>\n            <div className=\"text-5xl font-bold text-foreground mb-2\" data-testid=\"text-time\">\n              {formatTime(currentTime)}\n            </div>\n            <p className=\"text-xl text-muted-foreground\">\n              Welcome to Cavite State University CCAT Campus\n            </p>\n          </div>\n\n          <div className=\"grid lg:grid-cols-2 gap-6 max-w-4xl mx-auto\">\n            <Link href=\"/navigation\">\n              <button\n                data-testid=\"button-navigation\"\n                className=\"group w-full min-h-48 bg-card border border-card-border rounded-lg p-8 hover-elevate active-elevate-2 transition-all\"\n              >\n                <div className=\"flex flex-col items-center gap-4\">\n                  <div className=\"w-20 h-20 bg-primary/10 rounded-full flex items-center justify-center group-hover:bg-primary/20 transition-colors\">\n                    <Map className=\"w-12 h-12 text-primary\" />\n                  </div>\n                  <div>\n                    <h2 className=\"text-2xl font-semibold text-foreground mb-2\">Campus Navigation</h2>\n                    <p className=\"text-base text-muted-foreground\">Find your way around campus with turn-by-turn directions</p>\n                  </div>\n                </div>\n              </button>\n            </Link>\n\n            <Link href=\"/events\">\n              <button\n                data-testid=\"button-events\"\n                className=\"group w-full min-h-48 bg-card border border-card-border rounded-lg p-8 hover-elevate active-elevate-2 transition-all\"\n              >\n                <div className=\"flex flex-col items-center gap-4\">\n                  <div className=\"w-20 h-20 bg-primary/10 rounded-full flex items-center justify-center group-hover:bg-primary/20 transition-colors\">\n                    <Calendar className=\"w-12 h-12 text-primary\" />\n                  </div>\n                  <div>\n                    <h2 className=\"text-2xl font-semibold text-foreground mb-2\">Events & Announcements</h2>\n                    <p className=\"text-base text-muted-foreground\">Stay updated with campus activities and important notices</p>\n                  </div>\n                </div>\n              </button>\n            </Link>\n\n            <Link href=\"/staff\">\n              <button\n                data-testid=\"button-staff\"\n                className=\"group w-full min-h-48 bg-card border border-card-border rounded-lg p-8 hover-elevate active-elevate-2 transition-all\"\n              >\n                <div className=\"flex flex-col items-center gap-4\">\n                  <div className=\"w-20 h-20 bg-primary/10 rounded-full flex items-center justify-center group-hover:bg-primary/20 transition-colors\">\n                    <Users className=\"w-12 h-12 text-primary\" />\n                  </div>\n                  <div>\n                    <h2 className=\"text-2xl font-semibold text-foreground mb-2\">Staff Finder</h2>\n                    <p className=\"text-base text-muted-foreground\">Locate faculty and staff members across campus</p>\n                  </div>\n                </div>\n              </button>\n            </Link>\n\n            <Link href=\"/about\">\n              <button\n                data-testid=\"button-about\"\n                className=\"group w-full min-h-48 bg-card border border-card-border rounded-lg p-8 hover-elevate active-elevate-2 transition-all\"\n              >\n                <div className=\"flex flex-col items-center gap-4\">\n                  <div className=\"w-20 h-20 bg-primary/10 rounded-full flex items-center justify-center group-hover:bg-primary/20 transition-colors\">\n                    <Info className=\"w-12 h-12 text-primary\" />\n                  </div>\n                  <div>\n                    <h2 className=\"text-2xl font-semibold text-foreground mb-2\">About the Kiosk</h2>\n                    <p className=\"text-base text-muted-foreground\">Learn more about this information system</p>\n                  </div>\n                </div>\n              </button>\n            </Link>\n          </div>\n        </div>\n      </main>\n\n      <footer className=\"p-6\">\n        <div className=\"max-w-7xl mx-auto text-center\">\n          <Link href=\"/admin/login\">\n            <span className=\"text-sm text-muted-foreground hover:text-foreground underline cursor-pointer\" data-testid=\"link-admin\">\n              Admin Access\n            </span>\n          </Link>\n        </div>\n      </footer>\n    </div>\n  );\n}\n","size_bytes":6471},"client/src/pages/events.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { ArrowLeft, Calendar, Clock, MapPin, X, Navigation, Filter } from \"lucide-react\";\nimport { Link, useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Separator } from \"@/components/ui/separator\";\nimport GetDirectionsDialog from \"@/components/get-directions-dialog\";\nimport type { Event, Building } from \"@shared/schema\";\nimport { eventClassifications } from \"@shared/schema\";\nimport { useGlobalInactivity } from \"@/hooks/use-inactivity\";\n\n// Helper function to determine if event is upcoming/ongoing (green) or past (red)\nfunction getEventStatus(date: string, time?: string | null): 'upcoming' | 'past' {\n  const now = new Date();\n  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n  \n  // Parse event date in local timezone to avoid UTC offset issues\n  // Handle both ISO (YYYY-MM-DD) and other formats\n  let eventDateOnly: Date;\n  if (/^\\d{4}-\\d{2}-\\d{2}$/.test(date)) {\n    // ISO format: parse manually to avoid UTC interpretation\n    const [year, month, day] = date.split('-').map(Number);\n    eventDateOnly = new Date(year, month - 1, day);\n  } else {\n    // Other formats: parse with Date constructor\n    const eventDate = new Date(date);\n    eventDateOnly = new Date(eventDate.getFullYear(), eventDate.getMonth(), eventDate.getDate());\n  }\n  \n  // If event date is in the future, it's upcoming\n  if (eventDateOnly > today) {\n    return 'upcoming';\n  }\n  \n  // If event date is today and has a valid time\n  if (eventDateOnly.getTime() === today.getTime() && time && time.trim()) {\n    try {\n      const [hours, minutes] = time.split(':').map(Number);\n      if (!isNaN(hours) && !isNaN(minutes)) {\n        const eventDateTime = new Date();\n        eventDateTime.setHours(hours, minutes, 0, 0);\n        \n        // If event time hasn't passed yet, it's upcoming\n        if (eventDateTime >= now) {\n          return 'upcoming';\n        }\n      }\n    } catch {\n      // If time parsing fails, treat as upcoming for today's events\n      return 'upcoming';\n    }\n  }\n  \n  // If event date is today but no valid time specified, consider it upcoming\n  if (eventDateOnly.getTime() === today.getTime()) {\n    return 'upcoming';\n  }\n  \n  // Otherwise, event is past\n  return 'past';\n}\n\nexport default function Events() {\n  // Return to home after 3 minutes of inactivity\n  useGlobalInactivity();\n  \n  const [selectedEvent, setSelectedEvent] = useState<Event | null>(null);\n  const [showDirections, setShowDirections] = useState(false);\n  const [directionsDestination, setDirectionsDestination] = useState<string | null>(null);\n  const [classificationFilter, setClassificationFilter] = useState<string>(\"all\");\n  const [showPastEvents, setShowPastEvents] = useState(false);\n  const [, navigate] = useLocation();\n\n  const { data: events = [], isLoading } = useQuery<Event[]>({\n    queryKey: ['/api/events']\n  });\n\n  const { data: buildings = [] } = useQuery<Building[]>({\n    queryKey: ['/api/buildings']\n  });\n\n  // Filter events by classification\n  const filteredEvents = classificationFilter === \"all\" \n    ? events \n    : events.filter(event => event.classification === classificationFilter);\n\n  // Separate achievements from date-based events\n  const achievements = filteredEvents.filter(event => event.classification === \"Achievement\");\n  const dateBasedEvents = filteredEvents.filter(event => event.classification !== \"Achievement\");\n\n  // Separate ongoing/upcoming from ended events (only for non-achievements)\n  const ongoingUpcoming = dateBasedEvents.filter(event => getEventStatus(event.date, event.time) === 'upcoming');\n  const ended = dateBasedEvents.filter(event => getEventStatus(event.date, event.time) === 'past');\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"bg-card border-b border-card-border p-4 sticky top-0 z-10\">\n        <div className=\"max-w-7xl mx-auto flex items-center gap-4\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"icon\" data-testid=\"button-back\">\n              <ArrowLeft className=\"w-5 h-5\" />\n            </Button>\n          </Link>\n          <div>\n            <h1 className=\"text-2xl font-semibold text-foreground\">Events & Announcements</h1>\n            <p className=\"text-sm text-muted-foreground\">Stay updated with campus activities</p>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"max-w-7xl mx-auto px-6 py-8\">\n        {/* Classification Filter */}\n        <div className=\"mb-6\">\n          <Label className=\"flex items-center gap-2 mb-2 text-foreground\">\n            <Filter className=\"w-4 h-4\" />\n            Filter by Classification\n          </Label>\n          <Select\n            value={classificationFilter}\n            onValueChange={setClassificationFilter}\n          >\n            <SelectTrigger className=\"max-w-xs\" data-testid=\"select-classification-filter\">\n              <SelectValue placeholder=\"Select classification\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"all\">All Types</SelectItem>\n              {eventClassifications.map((classification) => (\n                <SelectItem key={classification} value={classification}>\n                  {classification}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n\n        {isLoading ? (\n          <div className=\"grid lg:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-6\">\n            {[1, 2, 3].map((i) => (\n              <Card key={i} className=\"h-96 animate-pulse bg-muted\" />\n            ))}\n          </div>\n        ) : filteredEvents.length === 0 ? (\n          <div className=\"text-center py-16\">\n            <Calendar className=\"w-16 h-16 text-muted-foreground mx-auto mb-4\" />\n            <h3 className=\"text-xl font-medium text-foreground mb-2\">\n              {classificationFilter === \"all\" ? \"No Events Yet\" : `No ${classificationFilter}s Found`}\n            </h3>\n            <p className=\"text-muted-foreground\">Check back soon for upcoming events and announcements</p>\n          </div>\n        ) : (\n          <div className=\"space-y-8\">\n            {/* Ongoing/Upcoming Events with Past Events toggle button */}\n            {ongoingUpcoming.length > 0 && (\n              <div>\n                <div className=\"flex items-center gap-4 mb-6\">\n                  <h2 className=\"text-2xl font-bold text-foreground\">Ongoing & Upcoming</h2>\n                  {ended.length > 0 && (\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => setShowPastEvents(!showPastEvents)}\n                      className=\"flex items-center gap-2\"\n                      data-testid=\"button-toggle-past-events\"\n                    >\n                      <Calendar className=\"w-4 h-4\" />\n                      {showPastEvents ? \"Hide Past Events\" : \"Show Past Events\"} ({ended.length})\n                    </Button>\n                  )}\n                  <Separator className=\"flex-1\" />\n                </div>\n                <div className=\"grid lg:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-6\">\n                  {ongoingUpcoming.map((event) => (\n                    <EventCard key={event.id} event={event} onSelect={setSelectedEvent} />\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Standalone Past Events toggle when there are no ongoing events */}\n            {ongoingUpcoming.length === 0 && ended.length > 0 && (\n              <div className=\"flex items-center gap-4 mb-6\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setShowPastEvents(!showPastEvents)}\n                  className=\"flex items-center gap-2\"\n                  data-testid=\"button-toggle-past-events-standalone\"\n                >\n                  <Calendar className=\"w-4 h-4\" />\n                  {showPastEvents ? \"Hide Past Events\" : \"Show Past Events\"} ({ended.length})\n                </Button>\n                <Separator className=\"flex-1\" />\n              </div>\n            )}\n\n            {/* Achievements - Horizontal Scrollable */}\n            {achievements.length > 0 && (\n              <div>\n                <div className=\"flex items-center gap-4 mb-6\">\n                  <h2 className=\"text-2xl font-bold text-foreground\">Achievements</h2>\n                  <Separator className=\"flex-1\" />\n                </div>\n                <div className=\"flex gap-6 overflow-x-auto pb-4 snap-x snap-mandatory scroll-smooth\">\n                  {achievements.map((event) => (\n                    <div key={event.id} className=\"flex-shrink-0 w-[340px] snap-start\">\n                      <EventCard event={event} onSelect={setSelectedEvent} />\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Collapsible Past Events Section */}\n            {ended.length > 0 && showPastEvents && (\n              <div>\n                <div className=\"flex items-center gap-4 mb-6\">\n                  <h2 className=\"text-2xl font-bold text-foreground\">Past Events</h2>\n                  <Separator className=\"flex-1\" />\n                </div>\n                <div className=\"grid lg:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-6\">\n                  {ended.map((event) => (\n                    <EventCard key={event.id} event={event} onSelect={setSelectedEvent} />\n                  ))}\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </main>\n\n      {selectedEvent && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4\">\n          <Card className=\"max-w-3xl w-full max-h-[90vh] overflow-y-auto shadow-2xl\" data-testid=\"modal-event-detail\">\n            <div className=\"sticky top-0 bg-card border-b border-card-border p-4 flex items-center justify-between z-10\">\n              <h2 className=\"text-xl font-semibold text-foreground\">Event Details</h2>\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                onClick={() => setSelectedEvent(null)}\n                data-testid=\"button-close-event-modal\"\n              >\n                <X className=\"w-5 h-5\" />\n              </Button>\n            </div>\n\n            <div className=\"p-6\">\n              {selectedEvent.image && (\n                <div className=\"w-full mb-6 rounded-lg bg-muted flex items-center justify-center\">\n                  <img\n                    src={selectedEvent.image}\n                    alt={selectedEvent.title}\n                    className=\"w-full h-auto object-contain max-h-[min(60vh,500px)]\"\n                  />\n                </div>\n              )}\n\n              <div className=\"mb-4\">\n                <Badge variant=\"secondary\">\n                  {selectedEvent.classification}\n                </Badge>\n              </div>\n\n              <h1 className=\"text-3xl font-bold text-foreground mb-4\">\n                {selectedEvent.title}\n              </h1>\n\n              {/* Only show date/time for non-Achievement events */}\n              {selectedEvent.classification !== \"Achievement\" && (\n                <div className=\"flex flex-wrap items-center gap-4 text-base mb-6 pb-6 border-b border-border\">\n                  <div className={`flex items-center gap-2 ${\n                    getEventStatus(selectedEvent.date, selectedEvent.time) === 'upcoming' \n                      ? 'text-green-600 dark:text-green-500' \n                      : 'text-red-600 dark:text-red-500'\n                  }`}>\n                    <Calendar className=\"w-5 h-5\" />\n                    <span>{selectedEvent.date}</span>\n                  </div>\n                  {selectedEvent.time && (\n                    <div className={`flex items-center gap-2 ${\n                      getEventStatus(selectedEvent.date, selectedEvent.time) === 'upcoming' \n                        ? 'text-green-600 dark:text-green-500' \n                        : 'text-red-600 dark:text-red-500'\n                    }`}>\n                      <Clock className=\"w-5 h-5\" />\n                      <span>{selectedEvent.time}</span>\n                    </div>\n                  )}\n                  {selectedEvent.location && (\n                    <div className=\"flex items-center gap-2 text-muted-foreground\">\n                      <MapPin className=\"w-5 h-5\" />\n                      <span>{selectedEvent.location}</span>\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {/* Show location separately for achievements if exists */}\n              {selectedEvent.classification === \"Achievement\" && selectedEvent.location && (\n                <div className=\"flex items-center gap-2 text-muted-foreground mb-6 pb-6 border-b border-border\">\n                  <MapPin className=\"w-5 h-5\" />\n                  <span>{selectedEvent.location}</span>\n                </div>\n              )}\n\n              {selectedEvent.description && (\n                <div className=\"prose prose-slate max-w-none mb-6\">\n                  <p className=\"text-lg text-foreground whitespace-pre-wrap\">\n                    {selectedEvent.description}\n                  </p>\n                </div>\n              )}\n\n              {selectedEvent.buildingId && (\n                <div className=\"mt-6 pt-6 border-t border-border\">\n                  <Button\n                    onClick={() => {\n                      setDirectionsDestination(selectedEvent.buildingId);\n                      setShowDirections(true);\n                    }}\n                    className=\"w-full\"\n                    data-testid=\"button-get-directions\"\n                  >\n                    <Navigation className=\"w-4 h-4 mr-2\" />\n                    Get Directions\n                  </Button>\n                </div>\n              )}\n            </div>\n          </Card>\n        </div>\n      )}\n\n      {showDirections && directionsDestination && (\n        <GetDirectionsDialog\n          open={showDirections}\n          destination={buildings.find(b => b.id === directionsDestination) || null}\n          buildings={buildings}\n          onClose={() => {\n            setShowDirections(false);\n            setDirectionsDestination(null);\n          }}\n          onNavigate={(startId: string, mode: 'walking' | 'driving') => {\n            navigate(`/navigation?from=${startId}&to=${directionsDestination}&mode=${mode}`);\n            setShowDirections(false);\n            setDirectionsDestination(null);\n          }}\n        />\n      )}\n    </div>\n  );\n}\n\n// EventCard component to avoid duplication\nfunction EventCard({ event, onSelect }: { event: Event; onSelect: (event: Event) => void }) {\n  return (\n    <Card\n      className=\"flex flex-col overflow-hidden cursor-pointer hover-elevate active-elevate-2 transition-all\"\n      onClick={() => onSelect(event)}\n      data-testid={`event-card-${event.id}`}\n    >\n      {event.image ? (\n        <div className=\"w-full aspect-[4/3] bg-muted\">\n          <img\n            src={event.image}\n            alt={event.title}\n            className=\"w-full h-full object-cover\"\n          />\n        </div>\n      ) : (\n        <div className=\"w-full aspect-[4/3] bg-gradient-to-br from-primary/20 to-primary/5 flex items-center justify-center\">\n          <Calendar className=\"w-16 h-16 text-primary/40\" />\n        </div>\n      )}\n      \n      <div className=\"p-6 flex flex-col flex-1\">\n        <div className=\"mb-3\">\n          <Badge variant=\"secondary\" className=\"mb-2\">\n            {event.classification}\n          </Badge>\n        </div>\n\n        {/* Only show date/time for non-Achievement events */}\n        {event.classification !== \"Achievement\" && (\n          <div className={`flex items-center gap-2 text-sm mb-3 ${\n            getEventStatus(event.date, event.time) === 'upcoming' \n              ? 'text-green-600 dark:text-green-500' \n              : 'text-red-600 dark:text-red-500'\n          }`}>\n            <Calendar className=\"w-4 h-4\" />\n            <span>{event.date}</span>\n            {event.time && (\n              <>\n                <span>•</span>\n                <Clock className=\"w-4 h-4\" />\n                <span>{event.time}</span>\n              </>\n            )}\n          </div>\n        )}\n\n        <h3 className=\"text-xl font-semibold text-foreground mb-2 line-clamp-2\">\n          {event.title}\n        </h3>\n\n        {event.description && (\n          <p className=\"text-base text-muted-foreground line-clamp-3 mb-4\">\n            {event.description}\n          </p>\n        )}\n\n        {event.location && (\n          <div className=\"flex items-center gap-2 text-sm text-muted-foreground mt-auto\">\n            <MapPin className=\"w-4 h-4\" />\n            <span>{event.location}</span>\n          </div>\n        )}\n\n        <div className=\"mt-4\">\n          <span className=\"text-sm text-primary font-medium\">Read More →</span>\n        </div>\n      </div>\n    </Card>\n  );\n}\n","size_bytes":17289},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\nimport { initializeFirebase } from \"./firebase\";\nimport { config } from \"dotenv\";\nimport { join } from \"path\";\n\n// Load environment variables from .env.local\nconfig({ path: join(process.cwd(), '.env.local') });\n\n// Initialize Firebase on startup (with fallback)\ntry {\n  initializeFirebase();\n} catch (error) {\n  console.warn('⚠️ Firebase initialization failed - using fallback mode with data.json');\n}\n\nconst app = express();\n\ndeclare module 'http' {\n  interface IncomingMessage {\n    rawBody: unknown\n  }\n}\napp.use(express.json({\n  verify: (req, _res, buf) => {\n    req.rawBody = buf;\n  }\n}));\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","size_bytes":2616},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/building-info-modal.tsx":{"content":"import { X, MapPin, Users as UsersIcon, Layers, Navigation } from \"lucide-react\";\nimport { Button } from \"./ui/button\";\nimport { Card } from \"./ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"./ui/tabs\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"./ui/avatar\";\nimport { Badge } from \"./ui/badge\";\nimport type { Building, Staff, Floor } from \"@shared/schema\";\nimport { canHaveDepartments, canHaveFloorPlan, isDescriptionOnly } from \"@shared/schema\";\nimport { useState, useRef, useEffect } from \"react\";\n\ninterface BuildingInfoModalProps {\n  building: Building;\n  staff?: Staff[];\n  floors?: Floor[];\n  onClose: () => void;\n  onOpenFloorPlan?: (floor: Floor) => void;\n  onGetDirections?: () => void;\n}\n\nexport default function BuildingInfoModal({\n  building,\n  staff = [],\n  floors = [],\n  onClose,\n  onOpenFloorPlan,\n  onGetDirections\n}: BuildingInfoModalProps) {\n  const [isDragging, setIsDragging] = useState(false);\n  const [position, setPosition] = useState({ x: 0, y: 0 });\n  const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });\n  const modalRef = useRef<HTMLDivElement>(null);\n\n  const handleMouseDown = (e: React.MouseEvent) => {\n    if ((e.target as HTMLElement).closest('.modal-header')) {\n      setIsDragging(true);\n      setDragOffset({\n        x: e.clientX - position.x,\n        y: e.clientY - position.y\n      });\n    }\n  };\n\n  useEffect(() => {\n    const handleMouseMove = (e: MouseEvent) => {\n      if (isDragging) {\n        setPosition({\n          x: e.clientX - dragOffset.x,\n          y: e.clientY - dragOffset.y\n        });\n      }\n    };\n\n    const handleMouseUp = () => {\n      setIsDragging(false);\n    };\n\n    if (isDragging) {\n      document.addEventListener('mousemove', handleMouseMove);\n      document.addEventListener('mouseup', handleMouseUp);\n    }\n\n    return () => {\n      document.removeEventListener('mousemove', handleMouseMove);\n      document.removeEventListener('mouseup', handleMouseUp);\n    };\n  }, [isDragging, dragOffset]);\n\n  return (\n    <div className=\"fixed inset-0 z-[1000] flex items-center justify-center bg-black/50 backdrop-blur-sm\">\n      <Card\n        ref={modalRef}\n        className=\"relative max-w-2xl w-full mx-4 shadow-2xl overflow-hidden z-[1001]\"\n        style={{\n          transform: `translate(${position.x}px, ${position.y}px)`,\n          cursor: isDragging ? 'grabbing' : 'default'\n        }}\n        data-testid=\"modal-building-info\"\n      >\n        <div\n          className=\"modal-header bg-primary p-4 flex items-center justify-between cursor-grab active:cursor-grabbing\"\n          onMouseDown={handleMouseDown}\n        >\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-10 h-10 bg-primary-foreground/20 rounded-lg flex items-center justify-center\">\n              <MapPin className=\"w-6 h-6 text-primary-foreground\" />\n            </div>\n            <div>\n              <h2 className=\"text-xl font-semibold text-primary-foreground\">{building.name}</h2>\n              <p className=\"text-sm text-primary-foreground/80\">Building Information</p>\n            </div>\n          </div>\n          <Button\n            size=\"icon\"\n            variant=\"ghost\"\n            onClick={onClose}\n            className=\"text-primary-foreground hover:bg-primary-foreground/20\"\n            data-testid=\"button-close-modal\"\n          >\n            <X className=\"w-5 h-5\" />\n          </Button>\n        </div>\n\n        <Tabs defaultValue=\"overview\" className=\"w-full\">\n          <TabsList className=\"w-full justify-start px-4 pt-4 bg-transparent\">\n            <TabsTrigger value=\"overview\" data-testid=\"tab-overview\">Overview</TabsTrigger>\n            {!isDescriptionOnly(building.type as any) && (\n              <TabsTrigger value=\"staff\" data-testid=\"tab-staff\">Staff</TabsTrigger>\n            )}\n            {canHaveFloorPlan(building.type as any) && (\n              <TabsTrigger value=\"floors\" data-testid=\"tab-floors\">Floor Plans</TabsTrigger>\n            )}\n          </TabsList>\n\n          <TabsContent value=\"overview\" className=\"p-6\">\n            {building.image && (\n              <div className=\"w-full mb-4 rounded-lg bg-muted flex items-center justify-center\">\n                <img\n                  src={building.image}\n                  alt={building.name}\n                  className=\"w-full h-auto object-contain max-h-[min(60vh,400px)]\"\n                />\n              </div>\n            )}\n\n            <div className=\"space-y-4\">\n              <div>\n                <h3 className=\"text-lg font-medium text-foreground mb-2\">Description</h3>\n                <p className=\"text-base text-muted-foreground\">\n                  {building.description || \"No description available\"}\n                </p>\n              </div>\n\n              {canHaveDepartments(building.type as any) && (\n                <div>\n                  <h3 className=\"text-lg font-medium text-foreground mb-2\">Departments</h3>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {building.departments && building.departments.length > 0 ? (\n                      building.departments.map((dept, index) => (\n                        <Badge key={index} variant=\"secondary\">\n                          {dept}\n                        </Badge>\n                      ))\n                    ) : (\n                      <p className=\"text-sm text-muted-foreground\">No departments listed</p>\n                    )}\n                  </div>\n                </div>\n              )}\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Latitude</p>\n                  <p className=\"text-base font-medium text-foreground\">{building.lat.toFixed(6)}</p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Longitude</p>\n                  <p className=\"text-base font-medium text-foreground\">{building.lng.toFixed(6)}</p>\n                </div>\n              </div>\n\n              {onGetDirections && (\n                <div className=\"pt-4\">\n                  <Button\n                    className=\"w-full\"\n                    onClick={onGetDirections}\n                    data-testid=\"button-get-directions\"\n                  >\n                    <Navigation className=\"w-4 h-4 mr-2\" />\n                    Get Directions\n                  </Button>\n                </div>\n              )}\n            </div>\n          </TabsContent>\n\n          {!isDescriptionOnly(building.type as any) && (\n            <TabsContent value=\"staff\" className=\"p-6\">\n              <div className=\"space-y-3\">\n                {staff.length > 0 ? (\n                  staff.map((member) => (\n                    <div\n                      key={member.id}\n                      className=\"flex items-center gap-3 p-3 rounded-lg bg-muted/50 hover-elevate\"\n                      data-testid={`staff-card-${member.id}`}\n                    >\n                      <Avatar className=\"w-12 h-12\">\n                        <AvatarImage src={member.photo || undefined} alt={member.name} />\n                        <AvatarFallback className=\"bg-primary text-primary-foreground\">\n                          {member.name.split(' ').map(n => n[0]).join('').slice(0, 2)}\n                        </AvatarFallback>\n                      </Avatar>\n                      <div className=\"flex-1\">\n                        <p className=\"font-medium text-foreground\">{member.name}</p>\n                        <p className=\"text-sm text-muted-foreground\">{member.position}</p>\n                        {member.department && (\n                          <p className=\"text-xs text-muted-foreground\">{member.department}</p>\n                        )}\n                      </div>\n                    </div>\n                  ))\n                ) : (\n                  <div className=\"text-center py-8\">\n                    <UsersIcon className=\"w-12 h-12 text-muted-foreground mx-auto mb-2\" />\n                    <p className=\"text-muted-foreground\">No staff members assigned</p>\n                  </div>\n                )}\n              </div>\n            </TabsContent>\n          )}\n\n          {canHaveFloorPlan(building.type as any) && (\n            <TabsContent value=\"floors\" className=\"p-6\">\n              <div className=\"space-y-3\">\n                {floors.length > 0 ? (\n                  floors.map((floor) => (\n                    <div\n                      key={floor.id}\n                      className=\"flex items-center justify-between p-4 rounded-lg bg-muted/50 hover-elevate\"\n                      data-testid={`floor-card-${floor.id}`}\n                    >\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center\">\n                          <Layers className=\"w-6 h-6 text-primary\" />\n                        </div>\n                        <div>\n                          <p className=\"font-medium text-foreground\">\n                            {floor.floorName || `Floor ${floor.floorNumber}`}\n                          </p>\n                          <p className=\"text-sm text-muted-foreground\">Level {floor.floorNumber}</p>\n                        </div>\n                      </div>\n                      {onOpenFloorPlan && (\n                        <Button\n                          size=\"sm\"\n                          onClick={() => onOpenFloorPlan(floor)}\n                          data-testid={`button-view-floor-${floor.id}`}\n                        >\n                          View Floor Plan\n                        </Button>\n                      )}\n                    </div>\n                  ))\n                ) : (\n                  <div className=\"text-center py-8\">\n                    <Layers className=\"w-12 h-12 text-muted-foreground mx-auto mb-2\" />\n                    <p className=\"text-muted-foreground\">No floor plans available</p>\n                  </div>\n                )}\n              </div>\n            </TabsContent>\n          )}\n        </Tabs>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":10150},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { OfflineIndicator } from \"@/components/offline-indicator\";\n\nimport Landing from \"@/pages/landing\";\nimport Navigation from \"@/pages/navigation\";\nimport Events from \"@/pages/events\";\nimport StaffDirectory from \"@/pages/staff\";\nimport About from \"@/pages/about\";\nimport Screensaver from \"@/pages/screensaver\";\n\nimport AdminLogin from \"@/pages/admin-login\";\nimport AdminDashboard from \"@/pages/admin-dashboard\";\nimport AdminBuildings from \"@/pages/admin-buildings\";\nimport AdminPaths from \"@/pages/admin-paths\";\nimport AdminFloorPlans from \"@/pages/admin-floor-plans\";\nimport AdminStaff from \"@/pages/admin-staff\";\nimport AdminEvents from \"@/pages/admin-events\";\nimport AdminSettings from \"@/pages/admin-settings\";\n\nimport NotFound from \"@/pages/not-found\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={Landing} />\n      <Route path=\"/navigation\" component={Navigation} />\n      <Route path=\"/events\" component={Events} />\n      <Route path=\"/staff\" component={StaffDirectory} />\n      <Route path=\"/about\" component={About} />\n      <Route path=\"/screensaver\" component={Screensaver} />\n      \n      <Route path=\"/admin/login\" component={AdminLogin} />\n      <Route path=\"/admin/dashboard\" component={AdminDashboard} />\n      <Route path=\"/admin/buildings\" component={AdminBuildings} />\n      <Route path=\"/admin/paths\" component={AdminPaths} />\n      <Route path=\"/admin/floor-plans\" component={AdminFloorPlans} />\n      <Route path=\"/admin/staff\" component={AdminStaff} />\n      <Route path=\"/admin/events\" component={AdminEvents} />\n      <Route path=\"/admin/settings\" component={AdminSettings} />\n      \n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <Toaster />\n        <OfflineIndicator />\n        <Router />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":2212},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/campus-map.tsx":{"content":"import { useEffect, useRef, useState } from \"react\";\nimport type { Building } from \"@shared/schema\";\nimport { KIOSK_LOCATION } from \"@shared/schema\";\n\nimport buildingIcon from '@assets/generated_images/Building_icon_green_background_3206ffb3.png';\nimport kioskIcon from '@assets/generated_images/You_are_Here_location_icon_294f7572.png';\nimport gateIcon from '@assets/generated_images/Gate_entrance_icon_green_b8dfb5ed.png';\nimport canteenIcon from '@assets/generated_images/Canteen_dining_icon_green_8cdb8c87.png';\nimport foodStallIcon from '@assets/generated_images/Food_stall_cart_icon_117edf54.png';\nimport libraryIcon from '@assets/generated_images/Library_books_icon_green_8639e524.png';\nimport studentLoungeIcon from '@assets/generated_images/Student_lounge_sofa_icon_91f45151.png';\nimport carParkingIcon from '@assets/generated_images/Car_parking_icon_green_15c240c8.png';\nimport motorcycleParkingIcon from '@assets/generated_images/Motorcycle_parking_icon_green_58dd1569.png';\nimport comfortRoomIcon from '@assets/generated_images/Restroom_comfort_room_icon_6cad7368.png';\nimport lectureHallIcon from '@assets/generated_images/Lecture_hall_classroom_icon_6a8a28ad.png';\nimport adminOfficeIcon from '@assets/generated_images/Administrative_office_briefcase_icon_1a31163b.png';\nimport dormitoryIcon from '@assets/generated_images/Dormitory_residence_hall_icon_0b08552a.png';\nimport clinicIcon from '@assets/generated_images/Health_clinic_medical_cross_2e3bb4e2.png';\nimport gymIcon from '@assets/generated_images/Gym_sports_dumbbell_icon_5be0961e.png';\nimport auditoriumIcon from '@assets/generated_images/Auditorium_theater_stage_icon_2f744312.png';\nimport laboratoryIcon from '@assets/generated_images/Laboratory_flask_test_tube_60e02462.png';\nimport facultyLoungeIcon from '@assets/generated_images/Faculty_lounge_coffee_mug_cc34405d.png';\nimport studyAreaIcon from '@assets/generated_images/Study_area_desk_lamp_de2acdc7.png';\nimport bookstoreIcon from '@assets/generated_images/Bookstore_book_price_tag_83e37414.png';\nimport atmIcon from '@assets/generated_images/ATM_cash_machine_icon_848adad9.png';\nimport chapelIcon from '@assets/generated_images/Chapel_prayer_room_cross_76e35c33.png';\nimport greenSpaceIcon from '@assets/generated_images/Green_space_tree_courtyard_d57ea32f.png';\nimport busStopIcon from '@assets/generated_images/Bus_stop_shuttle_icon_f080cef5.png';\nimport bikeParkingIcon from '@assets/generated_images/Bike_parking_bicycle_icon_9b6db414.png';\nimport securityOfficeIcon from '@assets/generated_images/Security_office_shield_badge_a19124a2.png';\nimport wasteStationIcon from '@assets/generated_images/Waste_recycling_station_icon_81c2fdf4.png';\nimport waterFountainIcon from '@assets/generated_images/Water_fountain_drinking_icon_690799ab.png';\nimport printCenterIcon from '@assets/generated_images/Print_copy_center_printer_7c56d319.png';\nimport otherIcon from '@assets/generated_images/Other_generic_question_mark_40bcf8cf.png';\n\ninterface CampusMapProps {\n  buildings?: Building[];\n  onBuildingClick?: (building: Building) => void;\n  selectedBuilding?: Building | null;\n  routePolyline?: Array<{ lat: number; lng: number }>;\n  routeMode?: 'walking' | 'driving';\n  className?: string;\n  onMapClick?: (lat: number, lng: number) => void;\n  centerLat?: number;\n  centerLng?: number;\n}\n\ndeclare global {\n  interface Window {\n    L: any;\n  }\n}\n\nconst getMarkerIconImage = (poiType?: string | null) => {\n  const iconMap: Record<string, string> = {\n    'Building': buildingIcon,\n    'Gate': gateIcon,\n    'Canteen': canteenIcon,\n    'Food Stall': foodStallIcon,\n    'Library': libraryIcon,\n    'Student Lounge': studentLoungeIcon,\n    'Car Parking': carParkingIcon,\n    'Motorcycle Parking': motorcycleParkingIcon,\n    'Comfort Room': comfortRoomIcon,\n    'Lecture Hall / Classroom': lectureHallIcon,\n    'Administrative Office': adminOfficeIcon,\n    'Residence Hall / Dormitory': dormitoryIcon,\n    'Health Services / Clinic': clinicIcon,\n    'Gym / Sports Facility': gymIcon,\n    'Auditorium / Theater': auditoriumIcon,\n    'Laboratory': laboratoryIcon,\n    'Faculty Lounge / Staff Room': facultyLoungeIcon,\n    'Study Area': studyAreaIcon,\n    'Bookstore': bookstoreIcon,\n    'ATM': atmIcon,\n    'Chapel / Prayer Room': chapelIcon,\n    'Green Space / Courtyard': greenSpaceIcon,\n    'Bus Stop / Shuttle Stop': busStopIcon,\n    'Bike Parking': bikeParkingIcon,\n    'Security Office / Campus Police': securityOfficeIcon,\n    'Waste / Recycling Station': wasteStationIcon,\n    'Water Fountain': waterFountainIcon,\n    'Print/Copy Center': printCenterIcon,\n    'Other': otherIcon,\n  };\n  return iconMap[poiType || 'Building'] || buildingIcon;\n};\n\nconst getMarkerIconSVG = (iconType?: string | null) => {\n  const icons: Record<string, string> = {\n    building: `<path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\"></path>`,\n    school: `<path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 14l9-5-9-5-9 5 9 5z M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z\"></path>`,\n    hospital: `<path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"></path>`,\n    store: `<path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z\"></path>`,\n    home: `<path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6\"></path>`,\n  };\n  return icons[iconType || 'building'] || icons.building;\n};\n\nexport default function CampusMap({\n  buildings = [],\n  onBuildingClick,\n  selectedBuilding,\n  routePolyline,\n  routeMode,\n  className = \"h-full w-full\",\n  onMapClick,\n  centerLat,\n  centerLng\n}: CampusMapProps) {\n  const mapRef = useRef<HTMLDivElement>(null);\n  const mapInstanceRef = useRef<any>(null);\n  const markersRef = useRef<any[]>([]);\n  const routeLayerRef = useRef<any>(null);\n  const routeMarkersRef = useRef<any[]>([]);\n\n  useEffect(() => {\n    if (!mapRef.current || mapInstanceRef.current) return;\n\n    const L = window.L;\n    if (!L) {\n      console.error(\"Leaflet not loaded\");\n      return;\n    }\n\n    const map = L.map(mapRef.current, {\n      center: [centerLat || 14.402598, centerLng || 120.866280],\n      zoom: 17.5,\n      minZoom: 17.5,\n      zoomControl: true,\n      attributionControl: true,\n    });\n\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: '© OpenStreetMap contributors',\n      maxZoom: 19,\n    }).addTo(map);\n\n    mapInstanceRef.current = map;\n\n    return () => {\n      if (mapInstanceRef.current) {\n        mapInstanceRef.current.remove();\n        mapInstanceRef.current = null;\n      }\n    };\n  }, [centerLat, centerLng]);\n\n  useEffect(() => {\n    if (!mapInstanceRef.current) return;\n\n    const map = mapInstanceRef.current;\n\n    const handleClick = (e: any) => {\n      if (onMapClick) {\n        onMapClick(e.latlng.lat, e.latlng.lng);\n      }\n    };\n\n    map.on('click', handleClick);\n\n    return () => {\n      map.off('click', handleClick);\n    };\n  }, [onMapClick]);\n\n  useEffect(() => {\n    if (!mapInstanceRef.current) return;\n    \n    const defaultLat = 14.402598;\n    const defaultLng = 120.866280;\n    const lat = centerLat || defaultLat;\n    const lng = centerLng || defaultLng;\n    \n    mapInstanceRef.current.setView([lat, lng], 17.5);\n  }, [centerLat, centerLng]);\n\n  useEffect(() => {\n    if (!mapInstanceRef.current || !window.L) return;\n\n    const L = window.L;\n\n    markersRef.current.forEach(marker => marker.remove());\n    markersRef.current = [];\n\n    const kioskIconHtml = L.divIcon({\n      html: `\n        <div class=\"relative flex items-center justify-center\">\n          <div class=\"absolute w-10 h-10 bg-blue-500/30 rounded-full animate-ping\"></div>\n          <div class=\"relative\">\n            <img src=\"${kioskIcon}\" alt=\"You are Here\" class=\"w-16 h-16 object-contain drop-shadow-lg\" />\n          </div>\n        </div>\n      `,\n      className: 'kiosk-marker',\n      iconSize: [64, 64],\n      iconAnchor: [32, 32],\n    });\n\n    const kioskMarker = L.marker([KIOSK_LOCATION.lat, KIOSK_LOCATION.lng], { icon: kioskIconHtml })\n      .addTo(mapInstanceRef.current)\n      .bindTooltip(KIOSK_LOCATION.name, {\n        permanent: false,\n        direction: 'top',\n        offset: [0, -32],\n        className: 'bg-blue-600 text-white px-3 py-2 rounded-lg shadow-lg font-semibold'\n      });\n\n    markersRef.current.push(kioskMarker);\n\n    buildings.forEach(building => {\n      const iconImage = getMarkerIconImage(building.type);\n      const icon = L.divIcon({\n        html: `\n          <div class=\"relative flex items-center justify-center\">\n            <div class=\"absolute w-8 h-8 bg-primary/20 rounded-full animate-ping ${selectedBuilding?.id === building.id ? 'scale-125' : ''}\"></div>\n            <div class=\"relative ${selectedBuilding?.id === building.id ? 'scale-125' : ''}\">\n              <img src=\"${iconImage}\" alt=\"${building.type || 'Building'}\" class=\"w-12 h-12 object-contain\" />\n            </div>\n          </div>\n        `,\n        className: 'building-marker',\n        iconSize: [48, 48],\n        iconAnchor: [24, 24],\n      });\n\n      const marker = L.marker([building.lat, building.lng], { icon })\n        .addTo(mapInstanceRef.current)\n        .bindTooltip(building.name, {\n          permanent: false,\n          direction: 'top',\n          offset: [0, -24],\n          className: 'bg-card text-card-foreground px-3 py-2 rounded-lg shadow-lg border border-card-border'\n        });\n\n      if (onBuildingClick) {\n        marker.on('click', () => onBuildingClick(building));\n      }\n\n      markersRef.current.push(marker);\n    });\n  }, [buildings, onBuildingClick, selectedBuilding]);\n\n  useEffect(() => {\n    if (!mapInstanceRef.current || !window.L) return;\n\n    const L = window.L;\n\n    if (routeLayerRef.current) {\n      routeLayerRef.current.remove();\n      routeLayerRef.current = null;\n    }\n\n    routeMarkersRef.current.forEach(marker => marker.remove());\n    routeMarkersRef.current = [];\n\n    if (routePolyline && routePolyline.length > 0) {\n      const color = routeMode === 'driving' ? '#22c55e' : '#3b82f6';\n      \n      routeLayerRef.current = L.polyline(routePolyline, {\n        color: color,\n        weight: 6,\n        opacity: 0.8,\n        smoothFactor: 1\n      }).addTo(mapInstanceRef.current);\n\n      if (routePolyline.length > 1) {\n        const startIcon = L.divIcon({\n          html: `\n            <div class=\"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center shadow-lg border-2 border-white\">\n              <svg class=\"w-6 h-6 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fill-rule=\"evenodd\" d=\"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z\" clip-rule=\"evenodd\"></path>\n              </svg>\n            </div>\n          `,\n          className: 'route-marker',\n          iconSize: [40, 40],\n          iconAnchor: [20, 40],\n        });\n\n        const endIcon = L.divIcon({\n          html: `\n            <div class=\"w-10 h-10 bg-red-500 rounded-full flex items-center justify-center shadow-lg border-2 border-white\">\n              <svg class=\"w-6 h-6 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fill-rule=\"evenodd\" d=\"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z\" clip-rule=\"evenodd\"></path>\n              </svg>\n            </div>\n          `,\n          className: 'route-marker',\n          iconSize: [40, 40],\n          iconAnchor: [20, 40],\n        });\n\n        const startMarker = L.marker(routePolyline[0], { icon: startIcon }).addTo(mapInstanceRef.current);\n        const endMarker = L.marker(routePolyline[routePolyline.length - 1], { icon: endIcon }).addTo(mapInstanceRef.current);\n        \n        routeMarkersRef.current.push(startMarker, endMarker);\n\n        const bounds = L.latLngBounds(routePolyline);\n        mapInstanceRef.current.fitBounds(bounds, { padding: [50, 50], maxZoom: 17.5 });\n      }\n    } else {\n      const defaultLat = 14.402598;\n      const defaultLng = 120.866280;\n      const lat = centerLat || defaultLat;\n      const lng = centerLng || defaultLng;\n      \n      mapInstanceRef.current.setView([lat, lng], 17.5);\n    }\n  }, [routePolyline, routeMode, centerLat, centerLng]);\n\n  return <div ref={mapRef} className={className} data-testid=\"map-container\" />;\n}\n","size_bytes":12949},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1202},"client/src/components/floor-plan-viewer.tsx":{"content":"import { useRef, useEffect, useState } from \"react\";\nimport { X, ZoomIn, ZoomOut, Maximize2, Plus, Trash2 } from \"lucide-react\";\nimport { Button } from \"./ui/button\";\nimport { Card } from \"./ui/card\";\nimport { Badge } from \"./ui/badge\";\nimport { Input } from \"./ui/input\";\nimport { Label } from \"./ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"./ui/select\";\nimport { ScrollArea } from \"./ui/scroll-area\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"./ui/dialog\";\nimport type { Floor, Room } from \"@shared/schema\";\n\ninterface FloorPlanViewerProps {\n  floor: Floor;\n  rooms?: Room[];\n  onClose: () => void;\n  onPlaceRoom?: (x: number, y: number) => void;\n  onCreateRoom?: (data: any) => void;\n  onUpdateRoom?: (id: string, data: any) => void;\n  onDeleteRoom?: (id: string) => void;\n}\n\nexport default function FloorPlanViewer({ floor, rooms = [], onClose, onPlaceRoom, onCreateRoom, onUpdateRoom, onDeleteRoom }: FloorPlanViewerProps) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [zoom, setZoom] = useState(1);\n  const [image, setImage] = useState<HTMLImageElement | null>(null);\n  const [selectedRoom, setSelectedRoom] = useState<Room | null>(null);\n  const [editingRoom, setEditingRoom] = useState<Room | null>(null);\n  const [roomFormData, setRoomFormData] = useState({ name: \"\", type: \"classroom\", description: \"\", x: 0.5, y: 0.5 });\n  const [viewingRoomInfo, setViewingRoomInfo] = useState<Room | null>(null);\n  \n  const isAdminMode = !!(onCreateRoom || onUpdateRoom || onDeleteRoom);\n\n  useEffect(() => {\n    if (floor.floorPlanImage) {\n      const img = new Image();\n      img.src = floor.floorPlanImage;\n      img.onload = () => {\n        setImage(img);\n      };\n    }\n  }, [floor.floorPlanImage]);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const container = containerRef.current;\n    if (!canvas || !container) return;\n\n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n\n    canvas.width = container.clientWidth;\n    canvas.height = container.clientHeight;\n\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    ctx.save();\n    ctx.scale(zoom, zoom);\n\n    if (image) {\n      const scale = Math.min(canvas.width / image.width, canvas.height / image.height) * 0.9;\n      const x = (canvas.width / zoom - image.width * scale) / 2;\n      const y = (canvas.height / zoom - image.height * scale) / 2;\n      \n      ctx.drawImage(image, x, y, image.width * scale, image.height * scale);\n\n      rooms.forEach(room => {\n        const roomX = x + room.x * image.width * scale;\n        const roomY = y + room.y * image.height * scale;\n\n        // Draw pin/marker icon (teardrop shape)\n        const pinSize = 20 / zoom;\n        const roomColor = getRoomColor(room.type);\n        \n        // Draw the pin shape\n        ctx.beginPath();\n        // Top circle part of the pin\n        ctx.arc(roomX, roomY - pinSize / 2, pinSize / 2, 0, Math.PI * 2);\n        ctx.fillStyle = roomColor;\n        ctx.fill();\n        ctx.strokeStyle = '#ffffff';\n        ctx.lineWidth = 2 / zoom;\n        ctx.stroke();\n        \n        // Bottom point of the pin (triangle)\n        ctx.beginPath();\n        ctx.moveTo(roomX - pinSize / 3, roomY - pinSize / 4);\n        ctx.lineTo(roomX + pinSize / 3, roomY - pinSize / 4);\n        ctx.lineTo(roomX, roomY + pinSize);\n        ctx.closePath();\n        ctx.fillStyle = roomColor;\n        ctx.fill();\n        ctx.strokeStyle = '#ffffff';\n        ctx.lineWidth = 2 / zoom;\n        ctx.stroke();\n      });\n    } else {\n      ctx.fillStyle = '#f3f4f6';\n      ctx.fillRect(0, 0, canvas.width / zoom, canvas.height / zoom);\n      ctx.fillStyle = '#9ca3af';\n      ctx.font = `${16 / zoom}px sans-serif`;\n      ctx.textAlign = 'center';\n      ctx.fillText('No floor plan image available', canvas.width / (2 * zoom), canvas.height / (2 * zoom));\n    }\n\n    ctx.restore();\n  }, [image, zoom, rooms]);\n\n  const getRoomColor = (type: string) => {\n    const colors: Record<string, string> = {\n      classroom: '#3b82f6',\n      office: '#22c55e',\n      lab: '#a855f7',\n      library: '#f59e0b',\n      restroom: '#06b6d4',\n      default: '#6b7280'\n    };\n    return colors[type.toLowerCase()] || colors.default;\n  };\n\n  const handleZoomIn = () => {\n    setZoom(prev => Math.min(prev * 1.2, 5));\n  };\n\n  const handleZoomOut = () => {\n    setZoom(prev => Math.max(prev / 1.2, 0.5));\n  };\n\n  const handleReset = () => {\n    setZoom(1);\n  };\n\n  const handleCanvasClick = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    if (!image) return;\n\n    const canvas = canvasRef.current;\n    const container = containerRef.current;\n    if (!canvas || !container) return;\n\n    const rect = canvas.getBoundingClientRect();\n    const x = (e.clientX - rect.left) / zoom;\n    const y = (e.clientY - rect.top) / zoom;\n\n    const scale = Math.min(canvas.width / image.width, canvas.height / image.height) * 0.9;\n    const offsetX = (canvas.width / zoom - image.width * scale) / 2;\n    const offsetY = (canvas.height / zoom - image.height * scale) / 2;\n\n    const clickedRoom = rooms.find(room => {\n      const roomX = offsetX + room.x * image.width * scale;\n      const roomY = offsetY + room.y * image.height * scale;\n      const pinSize = 20 / zoom;\n      \n      // Check if click is within the pin shape (circle at top + triangle at bottom)\n      // Top circle part of pin\n      const circleCenterY = roomY - pinSize / 2;\n      const distanceToCircle = Math.sqrt(Math.pow(x - roomX, 2) + Math.pow(y - circleCenterY, 2));\n      if (distanceToCircle < pinSize / 2) return true;\n      \n      // Bottom triangle part of pin (simple bounding box check)\n      const triangleTop = roomY - pinSize / 4;\n      const triangleBottom = roomY + pinSize;\n      const triangleLeft = roomX - pinSize / 3;\n      const triangleRight = roomX + pinSize / 3;\n      \n      if (y >= triangleTop && y <= triangleBottom && x >= triangleLeft && x <= triangleRight) {\n        return true;\n      }\n      \n      return false;\n    });\n\n    if (clickedRoom) {\n      if (isAdminMode) {\n        // Admin mode: edit the room\n        setEditingRoom(clickedRoom);\n        setRoomFormData({\n          name: clickedRoom.name,\n          type: clickedRoom.type,\n          description: clickedRoom.description || \"\",\n          x: clickedRoom.x,\n          y: clickedRoom.y\n        });\n      } else {\n        // View-only mode: show room info\n        setViewingRoomInfo(clickedRoom);\n      }\n    } else if (isAdminMode) {\n      // Admin mode: place new room marker\n      const relativeX = Math.max(0, Math.min(1, (x - offsetX) / (image.width * scale)));\n      const relativeY = Math.max(0, Math.min(1, (y - offsetY) / (image.height * scale)));\n      \n      if (relativeX >= 0 && relativeX <= 1 && relativeY >= 0 && relativeY <= 1) {\n        setEditingRoom(null);\n        setRoomFormData({ name: \"\", type: \"classroom\", description: \"\", x: relativeX, y: relativeY });\n      }\n    }\n  };\n\n  const handleSaveRoom = (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!roomFormData.type || !roomFormData.name) {\n      return;\n    }\n    \n    const data = {\n      floorId: floor.id,\n      buildingId: floor.buildingId,\n      name: roomFormData.name,\n      type: roomFormData.type,\n      description: roomFormData.description || null,\n      x: roomFormData.x,\n      y: roomFormData.y\n    };\n\n    if (editingRoom && onUpdateRoom) {\n      onUpdateRoom(editingRoom.id, data);\n    } else if (onCreateRoom) {\n      onCreateRoom(data);\n    }\n\n    setEditingRoom(null);\n    setRoomFormData({ name: \"\", type: \"classroom\", description: \"\", x: 0.5, y: 0.5 });\n  };\n\n  const handleCancelEdit = () => {\n    setEditingRoom(null);\n    setRoomFormData({ name: \"\", type: \"classroom\", description: \"\", x: 0.5, y: 0.5 });\n  };\n\n  const handleDeleteRoom = (room: Room) => {\n    if (onDeleteRoom) {\n      onDeleteRoom(room.id);\n      if (editingRoom?.id === room.id) {\n        handleCancelEdit();\n      }\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-[1100] bg-black/50 backdrop-blur-sm\">\n      <div className=\"h-screen flex flex-col\">\n        <div className=\"bg-card border-b border-card-border p-4 flex items-center justify-between\">\n          <div>\n            <h2 className=\"text-xl font-semibold text-foreground\">\n              {floor.floorName || `Floor ${floor.floorNumber}`}\n            </h2>\n            <p className=\"text-sm text-muted-foreground\">Floor Plan Viewer</p>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"icon\"\n              onClick={handleZoomOut}\n              data-testid=\"button-zoom-out\"\n            >\n              <ZoomOut className=\"w-5 h-5\" />\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"icon\"\n              onClick={handleZoomIn}\n              data-testid=\"button-zoom-in\"\n            >\n              <ZoomIn className=\"w-5 h-5\" />\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"icon\"\n              onClick={handleReset}\n              data-testid=\"button-reset-view\"\n            >\n              <Maximize2 className=\"w-5 h-5\" />\n            </Button>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={onClose}\n              data-testid=\"button-close-floor-plan\"\n            >\n              <X className=\"w-5 h-5\" />\n            </Button>\n          </div>\n        </div>\n\n        <div className=\"flex-1 flex overflow-hidden\">\n          {isAdminMode && (\n          <div className=\"w-96 bg-card border-r border-card-border flex flex-col\">\n            <div className=\"p-6 border-b border-card-border\">\n              <h3 className=\"text-lg font-semibold text-foreground mb-2\">\n                {editingRoom ? 'Edit Room' : 'Add Room'}\n              </h3>\n              <p className=\"text-sm text-muted-foreground\">\n                {editingRoom ? 'Update room information' : 'Click on the floor plan to place a new room marker'}\n              </p>\n            </div>\n\n            <ScrollArea className=\"flex-1\">\n              <div className=\"p-6\">\n                <form onSubmit={handleSaveRoom} className=\"space-y-4\">\n                  <div>\n                    <Label htmlFor=\"roomName\">Room Name *</Label>\n                    <Input\n                      id=\"roomName\"\n                      value={roomFormData.name}\n                      onChange={(e) => setRoomFormData({ ...roomFormData, name: e.target.value })}\n                      required\n                      data-testid=\"input-room-name\"\n                    />\n                  </div>\n                  <div>\n                    <Label htmlFor=\"roomType\">Type *</Label>\n                    <Select \n                      value={roomFormData.type} \n                      onValueChange={(v) => setRoomFormData({ ...roomFormData, type: v })}\n                    >\n                      <SelectTrigger data-testid=\"select-room-type\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent className=\"z-[1200]\" position=\"popper\" sideOffset={5}>\n                        <SelectItem value=\"classroom\">Classroom</SelectItem>\n                        <SelectItem value=\"office\">Office</SelectItem>\n                        <SelectItem value=\"lab\">Lab</SelectItem>\n                        <SelectItem value=\"library\">Library</SelectItem>\n                        <SelectItem value=\"restroom\">Restroom</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  <div>\n                    <Label htmlFor=\"description\">Room Description</Label>\n                    <Input\n                      id=\"description\"\n                      value={roomFormData.description}\n                      onChange={(e) => setRoomFormData({ ...roomFormData, description: e.target.value })}\n                      data-testid=\"input-room-description\"\n                    />\n                  </div>\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <Label htmlFor=\"x\">X Position</Label>\n                      <Input\n                        id=\"x\"\n                        type=\"text\"\n                        value={roomFormData.x.toFixed(3)}\n                        readOnly\n                        className=\"bg-muted/50\"\n                        data-testid=\"input-room-x\"\n                      />\n                    </div>\n                    <div>\n                      <Label htmlFor=\"y\">Y Position</Label>\n                      <Input\n                        id=\"y\"\n                        type=\"text\"\n                        value={roomFormData.y.toFixed(3)}\n                        readOnly\n                        className=\"bg-muted/50\"\n                        data-testid=\"input-room-y\"\n                      />\n                    </div>\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Button type=\"submit\" className=\"flex-1\" data-testid=\"button-save-room\">\n                      {editingRoom ? 'Update Room' : 'Create Room'}\n                    </Button>\n                    {editingRoom && (\n                      <Button \n                        type=\"button\" \n                        variant=\"outline\" \n                        onClick={handleCancelEdit}\n                        data-testid=\"button-cancel-edit\"\n                      >\n                        Cancel\n                      </Button>\n                    )}\n                  </div>\n                </form>\n\n                <div className=\"mt-8\">\n                  <h4 className=\"text-sm font-semibold text-foreground mb-3\">Rooms on this floor ({rooms.length})</h4>\n                  <div className=\"space-y-2\">\n                    {rooms.length > 0 ? (\n                      rooms.map(room => (\n                        <div\n                          key={room.id}\n                          className={`p-3 rounded-md border ${\n                            editingRoom?.id === room.id ? 'bg-primary/10 border-primary' : 'bg-muted/50 border-transparent'\n                          } hover-elevate cursor-pointer`}\n                          onClick={() => {\n                            setEditingRoom(room);\n                            setRoomFormData({\n                              name: room.name,\n                              type: room.type,\n                              description: room.description || \"\",\n                              x: room.x,\n                              y: room.y\n                            });\n                          }}\n                          data-testid={`room-item-${room.id}`}\n                        >\n                          <div className=\"flex items-start justify-between gap-2\">\n                            <div className=\"flex-1 min-w-0\">\n                              <p className=\"font-medium text-foreground truncate\">{room.name}</p>\n                              <Badge variant=\"secondary\" className=\"capitalize text-xs mt-1\">\n                                {room.type}\n                              </Badge>\n                            </div>\n                            <Button\n                              size=\"icon\"\n                              variant=\"ghost\"\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                handleDeleteRoom(room);\n                              }}\n                              data-testid={`button-delete-room-${room.id}`}\n                            >\n                              <Trash2 className=\"w-4 h-4 text-destructive\" />\n                            </Button>\n                          </div>\n                        </div>\n                      ))\n                    ) : (\n                      <p className=\"text-sm text-muted-foreground text-center py-4\">\n                        No rooms added yet. Click on the floor plan to add a room.\n                      </p>\n                    )}\n                  </div>\n                </div>\n\n                <div className=\"mt-8 pt-6 border-t border-card-border\">\n                  <h4 className=\"text-sm font-semibold text-foreground mb-3\">Room Types</h4>\n                  <div className=\"space-y-2\">\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-4 h-4 rounded-full bg-[#3b82f6]\"></div>\n                      <span className=\"text-sm text-muted-foreground\">Classroom</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-4 h-4 rounded-full bg-[#22c55e]\"></div>\n                      <span className=\"text-sm text-muted-foreground\">Office</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-4 h-4 rounded-full bg-[#a855f7]\"></div>\n                      <span className=\"text-sm text-muted-foreground\">Lab</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-4 h-4 rounded-full bg-[#f59e0b]\"></div>\n                      <span className=\"text-sm text-muted-foreground\">Library</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-4 h-4 rounded-full bg-[#06b6d4]\"></div>\n                      <span className=\"text-sm text-muted-foreground\">Restroom</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </ScrollArea>\n          </div>\n          )}\n\n          <div\n            ref={containerRef}\n            className=\"flex-1 bg-muted relative\"\n          >\n            <canvas\n              ref={canvasRef}\n              className=\"cursor-pointer\"\n              onClick={handleCanvasClick}\n              data-testid=\"canvas-floor-plan\"\n            />\n          </div>\n        </div>\n      </div>\n\n      {/* Room Information Dialog for view-only mode */}\n      {!isAdminMode && (\n        <Dialog open={!!viewingRoomInfo} onOpenChange={(open) => !open && setViewingRoomInfo(null)}>\n          <DialogContent className=\"z-[1200]\">\n            <DialogHeader>\n              <DialogTitle>{viewingRoomInfo?.name}</DialogTitle>\n            </DialogHeader>\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center gap-3\">\n                <div \n                  className=\"w-8 h-8 rounded-full\" \n                  style={{ backgroundColor: viewingRoomInfo ? getRoomColor(viewingRoomInfo.type) : '#6b7280' }}\n                />\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Room Type</p>\n                  <p className=\"font-medium capitalize\">{viewingRoomInfo?.type}</p>\n                </div>\n              </div>\n              {viewingRoomInfo?.description && (\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Room Description</p>\n                  <p className=\"font-medium\">{viewingRoomInfo.description}</p>\n                </div>\n              )}\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">X Position</p>\n                  <p className=\"font-mono text-sm\">{viewingRoomInfo?.x.toFixed(3)}</p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Y Position</p>\n                  <p className=\"font-mono text-sm\">{viewingRoomInfo?.y.toFixed(3)}</p>\n                </div>\n              </div>\n            </div>\n          </DialogContent>\n        </Dialog>\n      )}\n    </div>\n  );\n}\n","size_bytes":19919},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/admin-layout.tsx":{"content":"import { useEffect } from \"react\";\nimport { useLocation, Link } from \"wouter\";\nimport {\n  Building2,\n  Route,\n  Users,\n  Calendar,\n  Layers,\n  LogOut,\n  Map,\n  Settings\n} from \"lucide-react\";\nimport { Button } from \"./ui/button\";\nimport { Sidebar, SidebarContent, SidebarGroup, SidebarGroupContent, SidebarGroupLabel, SidebarMenu, SidebarMenuButton, SidebarMenuItem, SidebarProvider } from \"./ui/sidebar\";\n\ninterface AdminLayoutProps {\n  children: React.ReactNode;\n}\n\nexport default function AdminLayout({ children }: AdminLayoutProps) {\n  const [location, setLocation] = useLocation();\n\n  useEffect(() => {\n    const isAuthenticated = localStorage.getItem('isAdminAuthenticated');\n    if (!isAuthenticated) {\n      setLocation('/admin/login');\n    }\n  }, [setLocation]);\n\n  const handleLogout = () => {\n    localStorage.removeItem('isAdminAuthenticated');\n    setLocation('/');\n  };\n\n  const menuItems = [\n    {\n      title: \"Buildings\",\n      url: \"/admin/buildings\",\n      icon: Building2,\n    },\n    {\n      title: \"Paths\",\n      url: \"/admin/paths\",\n      icon: Route,\n    },\n    {\n      title: \"Floor Plans\",\n      url: \"/admin/floor-plans\",\n      icon: Layers,\n    },\n    {\n      title: \"Staff\",\n      url: \"/admin/staff\",\n      icon: Users,\n    },\n    {\n      title: \"Events\",\n      url: \"/admin/events\",\n      icon: Calendar,\n    },\n    {\n      title: \"Settings\",\n      url: \"/admin/settings\",\n      icon: Settings,\n    },\n  ];\n\n  const style = {\n    \"--sidebar-width\": \"16rem\",\n    \"--sidebar-width-icon\": \"3rem\",\n  };\n\n  return (\n    <SidebarProvider style={style as React.CSSProperties}>\n      <div className=\"flex h-screen w-full\">\n        <Sidebar>\n          <SidebarContent>\n            <SidebarGroup>\n              <div className=\"px-4 py-6 border-b border-sidebar-border\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"w-10 h-10 bg-sidebar-primary rounded-lg flex items-center justify-center\">\n                    <Map className=\"w-6 h-6 text-sidebar-primary-foreground\" />\n                  </div>\n                  <div>\n                    <h2 className=\"font-semibold text-sidebar-foreground\">iCCAT Admin</h2>\n                    <p className=\"text-xs text-sidebar-foreground/70\">Management Panel</p>\n                  </div>\n                </div>\n              </div>\n            </SidebarGroup>\n\n            <SidebarGroup>\n              <SidebarGroupLabel>Management</SidebarGroupLabel>\n              <SidebarGroupContent>\n                <SidebarMenu>\n                  {menuItems.map((item) => (\n                    <SidebarMenuItem key={item.title}>\n                      <SidebarMenuButton asChild isActive={location === item.url} data-testid={`nav-${item.title.toLowerCase().replace(' ', '-')}`}>\n                        <Link href={item.url}>\n                          <item.icon className=\"w-5 h-5\" />\n                          <span>{item.title}</span>\n                        </Link>\n                      </SidebarMenuButton>\n                    </SidebarMenuItem>\n                  ))}\n                </SidebarMenu>\n              </SidebarGroupContent>\n            </SidebarGroup>\n\n            <SidebarGroup className=\"mt-auto\">\n              <SidebarGroupContent>\n                <SidebarMenu>\n                  <SidebarMenuItem>\n                    <SidebarMenuButton onClick={handleLogout} data-testid=\"button-logout\">\n                      <LogOut className=\"w-5 h-5\" />\n                      <span>Logout</span>\n                    </SidebarMenuButton>\n                  </SidebarMenuItem>\n                </SidebarMenu>\n              </SidebarGroupContent>\n            </SidebarGroup>\n          </SidebarContent>\n        </Sidebar>\n\n        <div className=\"flex flex-col flex-1 overflow-hidden\">\n          <main className=\"flex-1 overflow-y-auto bg-background\">\n            {children}\n          </main>\n        </div>\n      </div>\n    </SidebarProvider>\n  );\n}\n","size_bytes":3949},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":2359},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/public/sw.js":{"content":"const CACHE_NAME = 'iccat-v3';\nconst DATA_CACHE_NAME = 'iccat-data-v3';\n\nconst urlsToCache = [\n  '/',\n  '/index.html',\n  '/data.json',\n  'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css',\n  'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js',\n  'https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&family=Roboto+Mono:wght@400;500;700&display=swap'\n];\n\nconst apiEndpointsToCache = [\n  '/api/buildings',\n  '/api/walkpaths',\n  '/api/drivepaths',\n  '/api/events',\n  '/api/staff',\n  '/api/floors',\n  '/api/rooms'\n];\n\nself.addEventListener('install', (event) => {\n  event.waitUntil(\n    caches.open(CACHE_NAME).then((cache) => {\n      console.log('[SW] Caching static assets');\n      return cache.addAll(urlsToCache).catch(err => {\n        console.warn('[SW] Some static assets failed to cache:', err);\n        return Promise.resolve();\n      });\n    }).then(() => {\n      return caches.open(DATA_CACHE_NAME);\n    }).then((cache) => {\n      console.log('[SW] Pre-caching API endpoints for offline use');\n      return Promise.allSettled(\n        apiEndpointsToCache.map(url =>\n          fetch(url)\n            .then(response => {\n              if (response.ok) {\n                console.log(`[SW] Cached ${url}`);\n                return cache.put(url, response);\n              } else {\n                console.warn(`[SW] Failed to cache ${url}: HTTP ${response.status}`);\n              }\n            })\n            .catch(err => {\n              console.warn(`[SW] Failed to fetch ${url} (offline or error):`, err.message);\n            })\n        )\n      ).then(results => {\n        const successful = results.filter(r => r.status === 'fulfilled').length;\n        const failed = results.filter(r => r.status === 'rejected').length;\n        console.log(`[SW] Pre-caching complete: ${successful} succeeded, ${failed} failed`);\n      });\n    })\n  );\n  self.skipWaiting();\n});\n\nself.addEventListener('fetch', (event) => {\n  const { request } = event;\n  const url = new URL(request.url);\n\n  if (request.method !== 'GET') {\n    return;\n  }\n\n  if (url.pathname.startsWith('/api/')) {\n    event.respondWith(\n      caches.open(DATA_CACHE_NAME).then((cache) => {\n        return cache.match(request).then((cachedResponse) => {\n          if (cachedResponse) {\n            console.log(`[SW] Serving ${url.pathname} from cache`);\n            fetch(request)\n              .then((response) => {\n                if (response.status === 200) {\n                  cache.put(request, response.clone());\n                }\n              })\n              .catch(() => {});\n            return cachedResponse;\n          }\n          \n          console.log(`[SW] Fetching ${url.pathname} from network`);\n          return fetch(request)\n            .then((response) => {\n              if (response.status === 200) {\n                cache.put(request, response.clone());\n              }\n              return response;\n            })\n            .catch((error) => {\n              console.error(`[SW] Failed to fetch ${url.pathname}:`, error);\n              throw error;\n            });\n        });\n      })\n    );\n    return;\n  }\n\n  if (url.origin.includes('tile.openstreetmap.org')) {\n    event.respondWith(\n      caches.open(CACHE_NAME).then((cache) => {\n        return cache.match(request).then((response) => {\n          if (response) {\n            return response;\n          }\n          return fetch(request).then((response) => {\n            if (response.status === 200) {\n              cache.put(request, response.clone());\n            }\n            return response;\n          });\n        });\n      })\n    );\n    return;\n  }\n\n  event.respondWith(\n    caches.match(request)\n      .then((response) => {\n        if (response) {\n          return response;\n        }\n\n        return fetch(request).then((response) => {\n          if (!response || response.status !== 200) {\n            return response;\n          }\n\n          const responseToCache = response.clone();\n          caches.open(CACHE_NAME).then((cache) => {\n            cache.put(request, responseToCache);\n          });\n\n          return response;\n        });\n      })\n  );\n});\n\nself.addEventListener('activate', (event) => {\n  const cacheWhitelist = [CACHE_NAME, DATA_CACHE_NAME];\n  \n  event.waitUntil(\n    caches.keys().then((cacheNames) => {\n      return Promise.all(\n        cacheNames.map((cacheName) => {\n          if (cacheWhitelist.indexOf(cacheName) === -1) {\n            return caches.delete(cacheName);\n          }\n        })\n      );\n    })\n  );\n});\n","size_bytes":4505},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":844},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n  --opaque-button-border-intensity: -8;\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n  --background: 0 0% 100%;\n  --foreground: 0 0% 9%;\n  --border: 0 0% 90%;\n  --card: 0 0% 98%;\n  --card-foreground: 0 0% 9%;\n  --card-border: 0 0% 94%;\n  --sidebar: 0 0% 96%;\n  --sidebar-foreground: 0 0% 9%;\n  --sidebar-border: 0 0% 92%;\n  --sidebar-primary: 142 76% 36%;\n  --sidebar-primary-foreground: 144 100% 96%;\n  --sidebar-accent: 0 0% 92%;\n  --sidebar-accent-foreground: 0 0% 9%;\n  --sidebar-ring: 142 76% 36%;\n  --popover: 0 0% 94%;\n  --popover-foreground: 0 0% 9%;\n  --popover-border: 0 0% 88%;\n  --primary: 142 76% 36%;\n  --primary-foreground: 144 100% 96%;\n  --secondary: 0 0% 90%;\n  --secondary-foreground: 0 0% 9%;\n  --muted: 0 2% 92%;\n  --muted-foreground: 0 0% 40%;\n  --accent: 142 8% 88%;\n  --accent-foreground: 0 0% 9%;\n  --destructive: 0 84% 42%;\n  --destructive-foreground: 0 0% 98%;\n  --input: 0 0% 75%;\n  --ring: 142 76% 36%;\n  --chart-1: 142 76% 36%;\n  --chart-2: 197 92% 38%;\n  --chart-3: 271 91% 42%;\n  --chart-4: 43 96% 48%;\n  --chart-5: 27 87% 52%;\n  --font-sans: Open Sans, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: Menlo, monospace;\n  --radius: .5rem;\n  --shadow-2xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 2px 4px -1px hsl(0 0% 0% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 4px 6px -1px hsl(0 0% 0% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 8px 10px -1px hsl(0 0% 0% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n  --opaque-button-border-intensity: 9;\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n  --background: 0 0% 7%;\n  --foreground: 0 0% 98%;\n  --border: 0 0% 16%;\n  --card: 0 0% 9%;\n  --card-foreground: 0 0% 98%;\n  --card-border: 0 0% 12%;\n  --sidebar: 0 0% 11%;\n  --sidebar-foreground: 0 0% 98%;\n  --sidebar-border: 0 0% 14%;\n  --sidebar-primary: 142 76% 36%;\n  --sidebar-primary-foreground: 144 100% 96%;\n  --sidebar-accent: 0 0% 15%;\n  --sidebar-accent-foreground: 0 0% 98%;\n  --sidebar-ring: 142 76% 36%;\n  --popover: 0 0% 13%;\n  --popover-foreground: 0 0% 98%;\n  --popover-border: 0 0% 17%;\n  --primary: 142 76% 36%;\n  --primary-foreground: 144 100% 96%;\n  --secondary: 0 0% 17%;\n  --secondary-foreground: 0 0% 98%;\n  --muted: 0 2% 16%;\n  --muted-foreground: 0 0% 65%;\n  --accent: 142 8% 14%;\n  --accent-foreground: 0 0% 98%;\n  --destructive: 0 84% 42%;\n  --destructive-foreground: 0 0% 98%;\n  --input: 0 0% 28%;\n  --ring: 142 76% 36%;\n  --chart-1: 142 70% 65%;\n  --chart-2: 197 82% 68%;\n  --chart-3: 271 81% 72%;\n  --chart-4: 43 86% 68%;\n  --chart-5: 27 77% 72%;\n  --shadow-2xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 2px 4px -1px hsl(0 0% 0% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 4px 6px -1px hsl(0 0% 0% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 8px 10px -1px hsl(0 0% 0% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}\n","size_bytes":10543},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"replit.md":{"content":"# iCCAT Smart Campus Information Kiosk\n\n## Overview\niCCAT (Interactive Campus Companion and Assistance Terminal) is a full-stack web application designed as an **offline-first** smart kiosk system for Cavite State University's CCAT Campus. Its primary purpose is to provide interactive campus navigation, wayfinding, staff directory, and event information through a touch-optimized interface for public kiosk deployment. The system includes public-facing modules and a comprehensive admin panel for content management, built with complete offline capability including client-side pathfinding and embedded baseline datasets.\n\n## User Preferences\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n- **Framework & Build System:** React 18 with TypeScript, Vite, Wouter for routing, SPA architecture.\n- **UI Component System:** Shadcn/ui (Radix UI primitives), Material Design principles (48px tap targets), Tailwind CSS, Roboto font family.\n- **State Management:** TanStack Query for server state, local React state for UI interactions.\n- **Key Frontend Features:** Interactive map with Leaflet.js, offline-first design (Service Worker), touch-optimized interface, responsive layouts.\n\n### Backend Architecture\n- **Server Framework:** Express.js with TypeScript, RESTful API.\n- **API Structure:** CRUD operations for `buildings`, `floors`, `rooms`, `staff`, `events`, `walkpaths`, `drivepaths`, and admin login.\n- **Data Persistence:** PostgreSQL database, Drizzle ORM, schema-first approach with Zod validation, UUID primary keys.\n- **Development Environment:** HMR via Vite, custom logging, standardized JSON error handling.\n\n### Data Schema Design\n- **Core Entities:** Buildings (geolocation, departments), Floors (hierarchical to buildings), Rooms (x/y coordinates on floor plans), Staff (linked to locations), Events (temporal, optional building link), Walkpaths/Drivepaths (coordinate nodes).\n- **Relationships:** One-to-many relationships (Buildings to Floors, Floors to Rooms), direct references, and JSONB arrays for paths.\n\n### Authentication & Authorization\n- **Admin Access:** Simple username/password via `/api/admin/login`, localStorage flag for session persistence, client-side protected routes.\n\n### Navigation & Pathfinding\n- **Algorithm:** Dijkstra's shortest path algorithm (client-side implementation).\n- **Offline Capability:** Complete pathfinding operates in browser without server dependency.\n- **Graph Construction:** Paths converted to graph of nodes and weighted edges. Node snapping merges nodes from *different* paths within 10 meters, while preserving same-path structure. Edge weights use Haversine distance. Building start/end points project onto nearest path segment.\n- **Path Calculation:** Finds shortest route between buildings, returning waypoints along actual paths.\n- **Walkpath Network Design:** Supports unlimited branching paths with `pathId`-based merge control, ensuring correct junction creation and preservation of individual path structures.\n\n### Offline-First Architecture\n- **Embedded Baseline Data:** All critical datasets (buildings, staff, floors, rooms, events, walkpaths, drivepaths) bundled in JavaScript build at `client/src/lib/baseline-data.json`.\n- **Triple-Tier Fallback Strategy:** \n  1. **Tier 1:** Try fetch from API (served from Service Worker cache if available)\n  2. **Tier 2:** Read directly from CacheStorage if fetch fails\n  3. **Tier 3:** Use embedded baseline data (guaranteed to work)\n- **Global React Query Integration:** All queries automatically use offline-first strategy via custom `offlineFirstQueryFn` in queryClient.\n- **First-Boot Offline Support:** Kiosk works perfectly on first boot with zero network connectivity - all features render from embedded data.\n- **Service Worker Caching:** Cache-first strategy for API requests, resilient install process tolerates offline conditions, pre-caches critical endpoints when online.\n- **Browser Compatibility:** Uses `window.caches` API for proper browser main-thread compatibility.\n\n## External Dependencies\n\n### Third-Party Services\n- **Mapping Services:** OpenStreetMap tile servers, Leaflet.js library (v1.9.4).\n- **CDN Resources:** Google Fonts API.\n\n### Database\n- **PostgreSQL:** Configured via `DATABASE_URL`, uses `@neondatabase/serverless` driver, Drizzle Kit for migrations.\n\n### Build & Development Tools\n- **Core Dependencies:** Node.js, TypeScript, esbuild, PostCSS with Autoprefixer.\n\n### UI Component Libraries\n- **Radix UI Primitives:** Dialog, Alert Dialog, Dropdown Menu, Select, Tabs, Toast, Tooltips, Popovers, Form controls, Navigation components.\n- **Additional UI:** `class-variance-authority`, `cmdk`, `embla-carousel-react`, `date-fns`, `lucide-react`.\n\n### Form Management\n- `react-hook-form` for state management, `@hookform/resolvers` with Zod for validation, `drizzle-zod`.\n\n### Service Worker\n- **Offline Caching:** Static assets cached on install, network-first strategy with cache fallback for API calls, separate cache namespaces for static and data, opportunistic map tile caching.","size_bytes":5097},"client/src/components/path-drawing-map.tsx":{"content":"import { useEffect, useRef, useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Trash2, Undo } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\n\ninterface PathNode {\n  lat: number;\n  lng: number;\n}\n\ninterface PathDrawingMapProps {\n  nodes: PathNode[];\n  onNodesChange: (nodes: PathNode[]) => void;\n  mode?: 'walking' | 'driving';\n  className?: string;\n}\n\ndeclare global {\n  interface Window {\n    L: any;\n  }\n}\n\nexport default function PathDrawingMap({\n  nodes,\n  onNodesChange,\n  mode = 'walking',\n  className = \"h-[500px] w-full\"\n}: PathDrawingMapProps) {\n  const mapRef = useRef<HTMLDivElement>(null);\n  const mapInstanceRef = useRef<any>(null);\n  const markersRef = useRef<any[]>([]);\n  const polylineRef = useRef<any>(null);\n  const [isDrawing, setIsDrawing] = useState(true);\n\n  useEffect(() => {\n    if (!mapRef.current || mapInstanceRef.current) return;\n\n    const L = window.L;\n    if (!L) {\n      console.error(\"Leaflet not loaded\");\n      return;\n    }\n\n    const map = L.map(mapRef.current, {\n      center: [14.4035451, 120.8659794],\n      zoom: 17,\n      zoomControl: true,\n      attributionControl: true,\n    });\n\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: '© OpenStreetMap contributors',\n      maxZoom: 19,\n    }).addTo(map);\n\n    mapInstanceRef.current = map;\n\n    return () => {\n      if (mapInstanceRef.current) {\n        mapInstanceRef.current.remove();\n        mapInstanceRef.current = null;\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!mapInstanceRef.current || !window.L) return;\n\n    const L = window.L;\n    const map = mapInstanceRef.current;\n\n    const handleClick = (e: any) => {\n      if (isDrawing) {\n        const newNode = { lat: e.latlng.lat, lng: e.latlng.lng };\n        onNodesChange([...nodes, newNode]);\n      }\n    };\n\n    map.on('click', handleClick);\n\n    return () => {\n      map.off('click', handleClick);\n    };\n  }, [isDrawing, nodes, onNodesChange]);\n\n  useEffect(() => {\n    if (!mapInstanceRef.current || !window.L) return;\n\n    const L = window.L;\n\n    markersRef.current.forEach(marker => marker.remove());\n    markersRef.current = [];\n\n    if (polylineRef.current) {\n      polylineRef.current.remove();\n      polylineRef.current = null;\n    }\n\n    if (nodes.length > 0) {\n      const color = mode === 'driving' ? '#22c55e' : '#3b82f6';\n\n      nodes.forEach((node, index) => {\n        const isFirst = index === 0;\n        const isLast = index === nodes.length - 1;\n\n        let iconHtml = '';\n        if (isFirst) {\n          iconHtml = `\n            <div class=\"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center shadow-lg border-2 border-white\">\n              <svg class=\"w-5 h-5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fill-rule=\"evenodd\" d=\"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z\" clip-rule=\"evenodd\"></path>\n              </svg>\n            </div>\n          `;\n        } else if (isLast) {\n          iconHtml = `\n            <div class=\"w-8 h-8 bg-red-500 rounded-full flex items-center justify-center shadow-lg border-2 border-white\">\n              <svg class=\"w-5 h-5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fill-rule=\"evenodd\" d=\"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z\" clip-rule=\"evenodd\"></path>\n              </svg>\n            </div>\n          `;\n        } else {\n          iconHtml = `\n            <div class=\"w-6 h-6 bg-white rounded-full flex items-center justify-center shadow-lg border-2\" style=\"border-color: ${color}\">\n              <div class=\"w-3 h-3 rounded-full\" style=\"background-color: ${color}\"></div>\n            </div>\n          `;\n        }\n\n        const icon = L.divIcon({\n          html: iconHtml,\n          className: 'waypoint-marker',\n          iconSize: isFirst || isLast ? [32, 32] : [24, 24],\n          iconAnchor: isFirst || isLast ? [16, 32] : [12, 12],\n        });\n\n        const marker = L.marker([node.lat, node.lng], { icon })\n          .addTo(mapInstanceRef.current)\n          .bindTooltip(\n            isFirst ? 'Start' : isLast ? 'End' : `Waypoint ${index}`,\n            {\n              permanent: false,\n              direction: 'top',\n              offset: [0, -10],\n            }\n          );\n\n        marker.on('click', (e: any) => {\n          L.DomEvent.stopPropagation(e);\n          if (!isDrawing) {\n            const newNodes = nodes.filter((_, i) => i !== index);\n            onNodesChange(newNodes);\n          }\n        });\n\n        markersRef.current.push(marker);\n      });\n\n      if (nodes.length > 1) {\n        polylineRef.current = L.polyline(nodes, {\n          color: color,\n          weight: 4,\n          opacity: 0.7,\n          smoothFactor: 1\n        }).addTo(mapInstanceRef.current);\n      }\n\n      if (nodes.length === 1) {\n        mapInstanceRef.current.setView([nodes[0].lat, nodes[0].lng], 17);\n      } else if (nodes.length > 1) {\n        const bounds = L.latLngBounds(nodes);\n        mapInstanceRef.current.fitBounds(bounds, { padding: [50, 50] });\n      }\n    }\n  }, [nodes, mode, isDrawing, onNodesChange]);\n\n  const handleUndo = () => {\n    if (nodes.length > 0) {\n      onNodesChange(nodes.slice(0, -1));\n    }\n  };\n\n  const handleClear = () => {\n    onNodesChange([]);\n  };\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex items-center justify-between gap-2\">\n        <div className=\"flex items-center gap-2 flex-wrap\">\n          <Badge variant={isDrawing ? \"default\" : \"secondary\"}>\n            {isDrawing ? 'Drawing Mode: Click to add waypoints' : 'Edit Mode: Click waypoints to remove'}\n          </Badge>\n          <Badge variant=\"outline\">\n            {nodes.length} waypoint{nodes.length !== 1 ? 's' : ''}\n          </Badge>\n        </div>\n        <div className=\"flex gap-1\">\n          <Button\n            size=\"sm\"\n            variant={isDrawing ? \"secondary\" : \"default\"}\n            onClick={() => setIsDrawing(!isDrawing)}\n            data-testid=\"button-toggle-drawing\"\n          >\n            {isDrawing ? 'Stop Drawing' : 'Start Drawing'}\n          </Button>\n          <Button\n            size=\"sm\"\n            variant=\"outline\"\n            onClick={handleUndo}\n            disabled={nodes.length === 0}\n            data-testid=\"button-undo\"\n          >\n            <Undo className=\"w-4 h-4\" />\n          </Button>\n          <Button\n            size=\"sm\"\n            variant=\"outline\"\n            onClick={handleClear}\n            disabled={nodes.length === 0}\n            data-testid=\"button-clear\"\n          >\n            <Trash2 className=\"w-4 h-4\" />\n          </Button>\n        </div>\n      </div>\n      <div ref={mapRef} className={`${className} rounded-lg overflow-hidden border`} data-testid=\"path-drawing-map\" />\n      {nodes.length > 0 && (\n        <div className=\"text-xs text-muted-foreground p-2 bg-muted/50 rounded-md\">\n          <p className=\"font-medium mb-1\">Path Nodes:</p>\n          <div className=\"max-h-32 overflow-y-auto space-y-0.5\">\n            {nodes.map((node, i) => (\n              <div key={i} className=\"flex items-center gap-2\">\n                <span className=\"text-muted-foreground\">{i + 1}.</span>\n                <code className=\"text-xs\">\n                  {node.lat.toFixed(6)}, {node.lng.toFixed(6)}\n                </code>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":7519},"server/db.ts":{"content":"import { getFirestore } from \"./firebase\";\nimport admin from 'firebase-admin';\n\nlet dbInstance: admin.firestore.Firestore | null = null;\n\nexport const db = new Proxy({} as admin.firestore.Firestore, {\n  get(_target, prop) {\n    if (!dbInstance) {\n      try {\n        dbInstance = getFirestore();\n      } catch (error) {\n        throw new Error('Firebase not initialized. Check your .env.local file for credentials.');\n      }\n    }\n    return (dbInstance as any)[prop];\n  }\n});\n","size_bytes":478},"server/pathfinding.ts":{"content":"import type { LatLng, Building, Walkpath, Drivepath } from \"@shared/schema\";\n\ninterface Node {\n  lat: number;\n  lng: number;\n}\n\ninterface GraphNode {\n  id: string;\n  lat: number;\n  lng: number;\n  pathId?: string;\n}\n\ninterface Edge {\n  from: string;\n  to: string;\n  distance: number;\n}\n\nfunction calculateDistance(lat1: number, lng1: number, lat2: number, lng2: number): number {\n  const R = 6371000;\n  const dLat = (lat2 - lat1) * Math.PI / 180;\n  const dLng = (lng2 - lng1) * Math.PI / 180;\n  const a = \n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\n    Math.sin(dLng / 2) * Math.sin(dLng / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return R * c;\n}\n\nfunction nodeKey(lat: number, lng: number): string {\n  return `${lat.toFixed(7)},${lng.toFixed(7)}`;\n}\n\nfunction projectPointOntoSegment(\n  point: LatLng,\n  segmentStart: LatLng,\n  segmentEnd: LatLng\n): { lat: number; lng: number; distance: number } {\n  const dx = segmentEnd.lng - segmentStart.lng;\n  const dy = segmentEnd.lat - segmentStart.lat;\n  \n  if (dx === 0 && dy === 0) {\n    return {\n      lat: segmentStart.lat,\n      lng: segmentStart.lng,\n      distance: calculateDistance(point.lat, point.lng, segmentStart.lat, segmentStart.lng)\n    };\n  }\n\n  const t = Math.max(0, Math.min(1,\n    ((point.lng - segmentStart.lng) * dx + (point.lat - segmentStart.lat) * dy) /\n    (dx * dx + dy * dy)\n  ));\n\n  const projectedLat = segmentStart.lat + t * dy;\n  const projectedLng = segmentStart.lng + t * dx;\n  const distance = calculateDistance(point.lat, point.lng, projectedLat, projectedLng);\n\n  return { lat: projectedLat, lng: projectedLng, distance };\n}\n\nfunction findClosestSegmentProjection(\n  point: LatLng,\n  paths: (Walkpath | Drivepath)[]\n): { lat: number; lng: number; pathIndex: number; segmentIndex: number } | null {\n  let minDistance = Infinity;\n  let bestProjection: { lat: number; lng: number; pathIndex: number; segmentIndex: number } | null = null;\n\n  paths.forEach((path, pathIndex) => {\n    const pathNodes = path.nodes as LatLng[];\n    for (let i = 0; i < pathNodes.length - 1; i++) {\n      const projection = projectPointOntoSegment(point, pathNodes[i], pathNodes[i + 1]);\n      if (projection.distance < minDistance) {\n        minDistance = projection.distance;\n        bestProjection = {\n          lat: projection.lat,\n          lng: projection.lng,\n          pathIndex,\n          segmentIndex: i\n        };\n      }\n    }\n  });\n\n  return bestProjection;\n}\n\nfunction mergeNearbyNodes(\n  nodes: Map<string, GraphNode>,\n  edges: Edge[],\n  snapThreshold: number = 10\n): { nodes: Map<string, GraphNode>, edges: Edge[], nodeMapping: Map<string, string> } {\n  const nodeArray = Array.from(nodes.entries());\n  \n  const parent = new Map<string, string>();\n  nodeArray.forEach(([key]) => parent.set(key, key));\n  \n  function find(key: string): string {\n    if (parent.get(key) !== key) {\n      parent.set(key, find(parent.get(key)!));\n    }\n    return parent.get(key)!;\n  }\n  \n  function union(a: string, b: string): void {\n    const rootA = find(a);\n    const rootB = find(b);\n    if (rootA !== rootB) {\n      parent.set(rootB, rootA);\n    }\n  }\n  \n  let mergeCount = 0;\n  let skippedSamePathCount = 0;\n  let missingPathIdCount = 0;\n  for (let i = 0; i < nodeArray.length; i++) {\n    const [keyA, nodeA] = nodeArray[i];\n    for (let j = i + 1; j < nodeArray.length; j++) {\n      const [keyB, nodeB] = nodeArray[j];\n      const dist = calculateDistance(nodeA.lat, nodeA.lng, nodeB.lat, nodeB.lng);\n      if (dist <= snapThreshold) {\n        if (!nodeA.pathId || !nodeB.pathId) {\n          missingPathIdCount++;\n          console.warn(`[WARN] Skipping merge due to missing pathId: ${keyA.substring(0, 20)}... (${nodeA.pathId || 'MISSING'}) <-> ${keyB.substring(0, 20)}... (${nodeB.pathId || 'MISSING'})`);\n          continue;\n        }\n        \n        if (nodeA.pathId === nodeB.pathId) {\n          skippedSamePathCount++;\n          continue;\n        }\n        \n        console.log(`[DEBUG] Merging nodes ${dist.toFixed(1)}m apart: ${keyA.substring(0, 20)}... <-> ${keyB.substring(0, 20)}... (pathIds: ${nodeA.pathId.substring(0, 8)} <-> ${nodeB.pathId.substring(0, 8)})`);\n        union(keyA, keyB);\n        mergeCount++;\n      }\n    }\n  }\n  console.log(`[DEBUG] Total nodes merged: ${mergeCount}, skipped same-path merges: ${skippedSamePathCount}, missing pathId: ${missingPathIdCount}`);\n  \n  const clusters = new Map<string, string[]>();\n  nodeArray.forEach(([key]) => {\n    const root = find(key);\n    if (!clusters.has(root)) {\n      clusters.set(root, []);\n    }\n    clusters.get(root)!.push(key);\n  });\n  \n  const nodeMapping = new Map<string, string>();\n  const mergedNodes = new Map<string, GraphNode>();\n  \n  clusters.forEach((clusterKeys, representative) => {\n    let sumLat = 0;\n    let sumLng = 0;\n    const pathIds = new Set<string>();\n    \n    clusterKeys.forEach(key => {\n      const node = nodes.get(key)!;\n      sumLat += node.lat;\n      sumLng += node.lng;\n      if (node.pathId) {\n        pathIds.add(node.pathId);\n      }\n      nodeMapping.set(key, representative);\n    });\n    \n    const avgLat = sumLat / clusterKeys.length;\n    const avgLng = sumLng / clusterKeys.length;\n    \n    const mergedNode: GraphNode = {\n      id: representative,\n      lat: avgLat,\n      lng: avgLng\n    };\n    \n    if (pathIds.size === 1) {\n      mergedNode.pathId = Array.from(pathIds)[0];\n    }\n    \n    mergedNodes.set(representative, mergedNode);\n  });\n  \n  const mergedEdges: Edge[] = [];\n  const edgeSet = new Set<string>();\n  \n  edges.forEach(edge => {\n    const fromMapped = nodeMapping.get(edge.from) || edge.from;\n    const toMapped = nodeMapping.get(edge.to) || edge.to;\n    \n    if (fromMapped === toMapped) return;\n    \n    const edgeKey = `${fromMapped}|${toMapped}`;\n    const reverseKey = `${toMapped}|${fromMapped}`;\n    \n    if (!edgeSet.has(edgeKey) && !edgeSet.has(reverseKey)) {\n      const fromNode = mergedNodes.get(fromMapped)!;\n      const toNode = mergedNodes.get(toMapped)!;\n      const distance = calculateDistance(fromNode.lat, fromNode.lng, toNode.lat, toNode.lng);\n      \n      mergedEdges.push({ from: fromMapped, to: toMapped, distance });\n      mergedEdges.push({ from: toMapped, to: fromMapped, distance });\n      edgeSet.add(edgeKey);\n      edgeSet.add(reverseKey);\n    }\n  });\n  \n  return { nodes: mergedNodes, edges: mergedEdges, nodeMapping };\n}\n\nexport function buildGraph(paths: (Walkpath | Drivepath)[]): {\n  nodes: Map<string, GraphNode>,\n  edges: Edge[]\n} {\n  const nodes = new Map<string, GraphNode>();\n  const edges: Edge[] = [];\n\n  console.log(`[DEBUG] Building graph from ${paths.length} paths`);\n\n  paths.forEach((path) => {\n    const pathNodes = path.nodes as LatLng[];\n    \n    pathNodes.forEach((node) => {\n      const key = nodeKey(node.lat, node.lng);\n      if (!nodes.has(key)) {\n        nodes.set(key, { id: key, lat: node.lat, lng: node.lng, pathId: path.id });\n      }\n    });\n\n    for (let i = 0; i < pathNodes.length - 1; i++) {\n      const fromKey = nodeKey(pathNodes[i].lat, pathNodes[i].lng);\n      const toKey = nodeKey(pathNodes[i + 1].lat, pathNodes[i + 1].lng);\n      const distance = calculateDistance(\n        pathNodes[i].lat,\n        pathNodes[i].lng,\n        pathNodes[i + 1].lat,\n        pathNodes[i + 1].lng\n      );\n\n      edges.push({ from: fromKey, to: toKey, distance });\n      edges.push({ from: toKey, to: fromKey, distance });\n    }\n  });\n\n  console.log(`[DEBUG] Before merge: ${nodes.size} nodes, ${edges.length} edges`);\n  const merged = mergeNearbyNodes(nodes, edges, 10);\n  console.log(`[DEBUG] After merge: ${merged.nodes.size} nodes, ${merged.edges.length} edges`);\n  \n  return { nodes: merged.nodes, edges: merged.edges };\n}\n\nfunction findClosestNode(\n  point: LatLng,\n  nodes: Map<string, GraphNode>\n): string | null {\n  let minDist = Infinity;\n  let closest: string | null = null;\n\n  nodes.forEach((node, key) => {\n    const dist = calculateDistance(point.lat, point.lng, node.lat, node.lng);\n    if (dist < minDist) {\n      minDist = dist;\n      closest = key;\n    }\n  });\n\n  return closest;\n}\n\nexport function findShortestPath(\n  start: Building,\n  end: Building,\n  paths: (Walkpath | Drivepath)[]\n): LatLng[] | null {\n  const { nodes, edges } = buildGraph(paths);\n\n  console.log(`[DEBUG] Pathfinding from \"${start.name}\" to \"${end.name}\"`);\n  const startPoint = { lat: start.lat, lng: start.lng };\n  const endPoint = { lat: end.lat, lng: end.lng };\n\n  const startProjection = findClosestSegmentProjection(startPoint, paths);\n  const endProjection = findClosestSegmentProjection(endPoint, paths);\n\n  if (!startProjection || !endProjection) {\n    console.log(`[DEBUG] Could not find projections for buildings`);\n    return null;\n  }\n\n  let startProjKey = nodeKey(startProjection.lat, startProjection.lng);\n  let endProjKey = nodeKey(endProjection.lat, endProjection.lng);\n  const startKey = nodeKey(startPoint.lat, startPoint.lng);\n  const endKey = nodeKey(endPoint.lat, endPoint.lng);\n  \n  console.log(`[DEBUG] Start projection: ${startProjKey.substring(0, 30)}... on path ${startProjection.pathIndex}`);\n  console.log(`[DEBUG] End projection: ${endProjKey.substring(0, 30)}... on path ${endProjection.pathIndex}`);\n\n  const snapThreshold = 10;\n  \n  nodes.forEach((node, key) => {\n    const distToStart = calculateDistance(startProjection.lat, startProjection.lng, node.lat, node.lng);\n    if (distToStart <= snapThreshold && distToStart > 0) {\n      console.log(`[DEBUG] Snapping start projection to existing node ${key.substring(0, 30)}... (${distToStart.toFixed(1)}m away)`);\n      startProjKey = key;\n    }\n    \n    const distToEnd = calculateDistance(endProjection.lat, endProjection.lng, node.lat, node.lng);\n    if (distToEnd <= snapThreshold && distToEnd > 0) {\n      console.log(`[DEBUG] Snapping end projection to existing node ${key.substring(0, 30)}... (${distToEnd.toFixed(1)}m away)`);\n      endProjKey = key;\n    }\n  });\n\n  const augmentedNodes = new Map(nodes);\n  let augmentedEdges = [...edges];\n\n  augmentedNodes.set(startKey, { id: startKey, lat: startPoint.lat, lng: startPoint.lng });\n  augmentedNodes.set(endKey, { id: endKey, lat: endPoint.lat, lng: endPoint.lng });\n\n  const segmentProjections = new Map<string, Array<{ key: string; lat: number; lng: number; t: number }>>();\n\n  const projectionsToAdd = [\n    { key: startProjKey, ...startProjection },\n    { key: endProjKey, ...endProjection }\n  ];\n\n  projectionsToAdd.forEach(proj => {\n    if (!augmentedNodes.has(proj.key)) {\n      augmentedNodes.set(proj.key, {\n        id: proj.key,\n        lat: proj.lat,\n        lng: proj.lng\n      });\n    }\n\n    const path = paths[proj.pathIndex];\n    const pathNodes = path.nodes as LatLng[];\n    const segStart = pathNodes[proj.segmentIndex];\n    const segEnd = pathNodes[proj.segmentIndex + 1];\n    const segKey = `${proj.pathIndex}-${proj.segmentIndex}`;\n\n    const dx = segEnd.lng - segStart.lng;\n    const dy = segEnd.lat - segStart.lat;\n    const t = dx === 0 && dy === 0 ? 0 : Math.max(0, Math.min(1,\n      ((proj.lng - segStart.lng) * dx + (proj.lat - segStart.lat) * dy) /\n      (dx * dx + dy * dy)\n    ));\n\n    if (!segmentProjections.has(segKey)) {\n      segmentProjections.set(segKey, []);\n    }\n    segmentProjections.get(segKey)!.push({ key: proj.key, lat: proj.lat, lng: proj.lng, t });\n  });\n\n  segmentProjections.forEach((projs, segKey) => {\n    const [pathIndex, segmentIndex] = segKey.split('-').map(Number);\n    const path = paths[pathIndex];\n    const pathNodes = path.nodes as LatLng[];\n    const segStart = pathNodes[segmentIndex];\n    const segEnd = pathNodes[segmentIndex + 1];\n    const segStartKey = nodeKey(segStart.lat, segStart.lng);\n    const segEndKey = nodeKey(segEnd.lat, segEnd.lng);\n\n    augmentedEdges = augmentedEdges.filter(\n      e => !(e.from === segStartKey && e.to === segEndKey) &&\n           !(e.from === segEndKey && e.to === segStartKey)\n    );\n\n    projs.sort((a, b) => a.t - b.t);\n\n    const allPoints = [\n      { key: segStartKey, lat: segStart.lat, lng: segStart.lng },\n      ...projs,\n      { key: segEndKey, lat: segEnd.lat, lng: segEnd.lng }\n    ];\n\n    for (let i = 0; i < allPoints.length - 1; i++) {\n      const from = allPoints[i];\n      const to = allPoints[i + 1];\n      const dist = calculateDistance(from.lat, from.lng, to.lat, to.lng);\n      \n      if (dist > 0) {\n        augmentedEdges.push({ from: from.key, to: to.key, distance: dist });\n        augmentedEdges.push({ from: to.key, to: from.key, distance: dist });\n      }\n    }\n  });\n\n  const startToProjDist = calculateDistance(startPoint.lat, startPoint.lng, startProjection.lat, startProjection.lng);\n  const endToProjDist = calculateDistance(endPoint.lat, endPoint.lng, endProjection.lat, endProjection.lng);\n\n  augmentedEdges.push({ from: startKey, to: startProjKey, distance: startToProjDist });\n  augmentedEdges.push({ from: startProjKey, to: startKey, distance: startToProjDist });\n  augmentedEdges.push({ from: endKey, to: endProjKey, distance: endToProjDist });\n  augmentedEdges.push({ from: endProjKey, to: endKey, distance: endToProjDist });\n\n  const distances = new Map<string, number>();\n  const previous = new Map<string, string | null>();\n  const unvisited = new Set<string>();\n\n  augmentedNodes.forEach((_, key) => {\n    distances.set(key, Infinity);\n    previous.set(key, null);\n    unvisited.add(key);\n  });\n\n  distances.set(startKey, 0);\n\n  while (unvisited.size > 0) {\n    let current: string | null = null;\n    let minDist = Infinity;\n\n    unvisited.forEach((key) => {\n      const dist = distances.get(key)!;\n      if (dist < minDist) {\n        minDist = dist;\n        current = key;\n      }\n    });\n\n    if (current === null || current === endKey) {\n      break;\n    }\n\n    unvisited.delete(current);\n\n    const neighbors = augmentedEdges.filter(e => e.from === current);\n\n    neighbors.forEach(edge => {\n      if (!unvisited.has(edge.to)) return;\n\n      const alt = distances.get(current!)! + edge.distance;\n      if (alt < distances.get(edge.to)!) {\n        distances.set(edge.to, alt);\n        previous.set(edge.to, current);\n      }\n    });\n  }\n\n  if (distances.get(endKey) === Infinity || (previous.get(endKey) === undefined && endKey !== startKey)) {\n    console.warn(`WARNING: No road connection found between \"${start.name}\" and \"${end.name}\" - drivepaths are not connected!`);\n    console.warn('TIP: Make sure your drivepaths share common waypoints to form junctions.');\n    return [startPoint, endPoint];\n  }\n\n  const path: string[] = [];\n  let current: string | null = endKey;\n\n  while (current !== null) {\n    path.unshift(current);\n    current = previous.get(current) || null;\n  }\n\n  const route: LatLng[] = path.map(key => {\n    const node = augmentedNodes.get(key);\n    return node ? { lat: node.lat, lng: node.lng } : null;\n  }).filter((p): p is LatLng => p !== null);\n\n  return route;\n}\n","size_bytes":14915},"client/src/components/get-directions-dialog.tsx":{"content":"import React from \"react\";\nimport { Navigation, MapPin } from \"lucide-react\";\nimport { Button } from \"./ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"./ui/dialog\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"./ui/select\";\nimport { Tabs, TabsList, TabsTrigger } from \"./ui/tabs\";\nimport type { Building } from \"@shared/schema\";\nimport { KIOSK_LOCATION } from \"@shared/schema\";\n\ninterface GetDirectionsDialogProps {\n  open: boolean;\n  destination: Building | null;\n  buildings: Building[];\n  onClose: () => void;\n  onNavigate: (startId: string, mode: 'walking' | 'driving') => void;\n}\n\nexport default function GetDirectionsDialog({\n  open,\n  destination,\n  buildings,\n  onClose,\n  onNavigate\n}: GetDirectionsDialogProps) {\n  const [selectedStart, setSelectedStart] = React.useState<string>(\"kiosk\");\n  const [mode, setMode] = React.useState<'walking' | 'driving'>('walking');\n\n  const handleNavigate = () => {\n    if (selectedStart) {\n      onNavigate(selectedStart, mode);\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"sm:max-w-md\" data-testid=\"dialog-get-directions\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Navigation className=\"w-5 h-5\" />\n            Get Directions\n          </DialogTitle>\n          <DialogDescription>\n            Choose your starting point and travel mode to navigate to {destination?.name}.\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4 pt-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-foreground mb-2\">\n              Starting Point\n            </label>\n            <Select value={selectedStart} onValueChange={setSelectedStart}>\n              <SelectTrigger data-testid=\"select-dialog-start\">\n                <SelectValue placeholder=\"Select starting location\" />\n              </SelectTrigger>\n              <SelectContent className=\"z-[1002]\">\n                <SelectItem value=\"kiosk\">\n                  <div className=\"flex items-center gap-2\">\n                    <MapPin className=\"w-4 h-4 text-blue-600\" />\n                    <span className=\"font-semibold\">{KIOSK_LOCATION.name}</span>\n                  </div>\n                </SelectItem>\n                {buildings\n                  .filter(b => b.id !== destination?.id)\n                  .map(building => (\n                    <SelectItem key={building.id} value={building.id}>\n                      {building.name}\n                    </SelectItem>\n                  ))}\n              </SelectContent>\n            </Select>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-foreground mb-2\">\n              Travel Mode\n            </label>\n            <Tabs value={mode} onValueChange={(v) => setMode(v as 'walking' | 'driving')}>\n              <TabsList className=\"w-full\">\n                <TabsTrigger value=\"walking\" className=\"flex-1\" data-testid=\"dialog-tab-walking\">\n                  Walking\n                </TabsTrigger>\n                <TabsTrigger value=\"driving\" className=\"flex-1\" data-testid=\"dialog-tab-driving\">\n                  Driving\n                </TabsTrigger>\n              </TabsList>\n            </Tabs>\n          </div>\n\n          <div className=\"flex gap-2 pt-2\">\n            <Button\n              variant=\"outline\"\n              onClick={onClose}\n              className=\"flex-1\"\n              data-testid=\"button-dialog-cancel\"\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={handleNavigate}\n              disabled={!selectedStart}\n              className=\"flex-1\"\n              data-testid=\"button-dialog-navigate\"\n            >\n              <Navigation className=\"w-4 h-4 mr-2\" />\n              Navigate\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":4011},"client/src/hooks/use-inactivity.ts":{"content":"import { useEffect, useRef, useState } from \"react\";\nimport { useLocation } from \"wouter\";\n\n/**\n * Hook for global inactivity timeout\n * Used on Navigation, Events, Staff, and About pages\n * Redirects to home page after configured timeout (default 3 minutes)\n * Timeout can be configured by admin via /api/settings/global_inactivity_timeout\n */\nexport function useGlobalInactivity() {\n  const [, setLocation] = useLocation();\n  const timeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const [inactivityTimeout, setInactivityTimeout] = useState<number>(180000); // Default 3 minutes (180 seconds)\n\n  // Fetch configured timeout from settings\n  useEffect(() => {\n    fetch('/api/settings/global_inactivity_timeout')\n      .then(res => {\n        if (res.ok) {\n          return res.json();\n        }\n        return null;\n      })\n      .then(setting => {\n        if (setting && setting.value) {\n          // Value is stored in seconds, convert to milliseconds\n          const timeoutMs = parseInt(setting.value, 10) * 1000;\n          if (!isNaN(timeoutMs) && timeoutMs > 0) {\n            setInactivityTimeout(timeoutMs);\n          }\n        }\n      })\n      .catch(() => {\n        // If fetch fails, use default timeout\n      });\n  }, []);\n\n  const resetTimer = () => {\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n    }\n\n    timeoutRef.current = setTimeout(() => {\n      setLocation(\"/\");\n    }, inactivityTimeout);\n  };\n\n  useEffect(() => {\n    // Set up event listeners for user activity\n    const events = [\"mousedown\", \"mousemove\", \"keypress\", \"scroll\", \"touchstart\", \"click\"];\n\n    events.forEach((event) => {\n      document.addEventListener(event, resetTimer);\n    });\n\n    // Start the initial timer\n    resetTimer();\n\n    // Cleanup on unmount\n    return () => {\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n      }\n      events.forEach((event) => {\n        document.removeEventListener(event, resetTimer);\n      });\n    };\n  }, [inactivityTimeout]);\n}\n\n/**\n * Hook for home page inactivity timeout\n * Used only on the home/landing page\n * Redirects to screensaver after configured timeout (default 30 seconds)\n * Timeout can be configured by admin via /api/settings/home_inactivity_timeout\n */\nexport function useHomeInactivity() {\n  const [, setLocation] = useLocation();\n  const timeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const [inactivityTimeout, setInactivityTimeout] = useState<number>(30000); // Default 30 seconds\n\n  // Fetch configured timeout from settings\n  useEffect(() => {\n    fetch('/api/settings/home_inactivity_timeout')\n      .then(res => {\n        if (res.ok) {\n          return res.json();\n        }\n        return null;\n      })\n      .then(setting => {\n        if (setting && setting.value) {\n          // Value is stored in seconds, convert to milliseconds\n          const timeoutMs = parseInt(setting.value, 10) * 1000;\n          if (!isNaN(timeoutMs) && timeoutMs > 0) {\n            setInactivityTimeout(timeoutMs);\n          }\n        }\n      })\n      .catch(() => {\n        // If fetch fails, use default timeout\n      });\n  }, []);\n\n  const resetTimer = () => {\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n    }\n\n    timeoutRef.current = setTimeout(() => {\n      setLocation(\"/screensaver\");\n    }, inactivityTimeout);\n  };\n\n  useEffect(() => {\n    // Set up event listeners for user activity\n    const events = [\"mousedown\", \"mousemove\", \"keypress\", \"scroll\", \"touchstart\", \"click\"];\n\n    events.forEach((event) => {\n      document.addEventListener(event, resetTimer);\n    });\n\n    // Start the initial timer\n    resetTimer();\n\n    // Cleanup on unmount\n    return () => {\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n      }\n      events.forEach((event) => {\n        document.removeEventListener(event, resetTimer);\n      });\n    };\n  }, [inactivityTimeout]);\n}\n","size_bytes":3916},"client/src/pages/screensaver.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { format } from \"date-fns\";\nimport { Hand, Clock } from \"lucide-react\";\n\ninterface Event {\n  id: string;\n  title: string;\n  description: string;\n  date: string;\n  time: string;\n  location: string;\n  image: string;\n  classification: \"Event\" | \"Announcement\" | \"Achievement\";\n}\n\n// Safe date parser - handles both ISO and other formats\nfunction parseEventDate(dateString: string): Date | null {\n  if (!dateString) return null;\n  \n  try {\n    // Try ISO format first (YYYY-MM-DD)\n    if (/^\\d{4}-\\d{2}-\\d{2}$/.test(dateString)) {\n      const [year, month, day] = dateString.split('-').map(Number);\n      return new Date(year, month - 1, day);\n    }\n    \n    // Fallback to Date constructor for other formats\n    const date = new Date(dateString);\n    if (isNaN(date.getTime())) return null;\n    \n    return new Date(date.getFullYear(), date.getMonth(), date.getDate());\n  } catch {\n    return null;\n  }\n}\n\n// Parse time string (handles \"H:MM AM/PM\" and \"HH:MM\" formats)\nfunction parseEventTime(timeString: string): { hours: number; minutes: number } | null {\n  if (!timeString || !timeString.trim()) return null;\n  \n  try {\n    const timeStr = timeString.trim();\n    \n    // Match \"H:MM AM/PM\" or \"HH:MM AM/PM\" format\n    const amPmMatch = timeStr.match(/^(\\d{1,2}):(\\d{2})\\s*(AM|PM)$/i);\n    if (amPmMatch) {\n      let hours = parseInt(amPmMatch[1], 10);\n      const minutes = parseInt(amPmMatch[2], 10);\n      const meridiem = amPmMatch[3].toUpperCase();\n      \n      if (isNaN(hours) || isNaN(minutes)) return null;\n      \n      // Convert to 24-hour format\n      if (meridiem === 'PM' && hours !== 12) {\n        hours += 12;\n      } else if (meridiem === 'AM' && hours === 12) {\n        hours = 0;\n      }\n      \n      return { hours, minutes };\n    }\n    \n    // Match 24-hour format \"HH:MM\"\n    const match24h = timeStr.match(/^(\\d{1,2}):(\\d{2})$/);\n    if (match24h) {\n      const hours = parseInt(match24h[1], 10);\n      const minutes = parseInt(match24h[2], 10);\n      \n      if (isNaN(hours) || isNaN(minutes)) return null;\n      \n      return { hours, minutes };\n    }\n    \n    return null;\n  } catch {\n    return null;\n  }\n}\n\nexport default function Screensaver() {\n  const [, setLocation] = useLocation();\n  const [currentSlide, setCurrentSlide] = useState(0);\n  const [currentTime, setCurrentTime] = useState(new Date());\n  const [particles, setParticles] = useState<Array<{\n    x: number, \n    y: number, \n    opacity: number,\n    targetY: number,\n    targetOpacity: number,\n    duration: number\n  }>>([]);\n\n  // Update clock every second\n  useEffect(() => {\n    const timer = setInterval(() => {\n      setCurrentTime(new Date());\n    }, 1000);\n    return () => clearInterval(timer);\n  }, []);\n\n  // Helper functions to format date and time\n  const formatTime = (date: Date) => {\n    return date.toLocaleTimeString('en-US', {\n      hour: '2-digit',\n      minute: '2-digit',\n      second: '2-digit',\n      hour12: true\n    });\n  };\n\n  const formatDate = (date: Date) => {\n    return date.toLocaleDateString('en-US', {\n      weekday: 'long',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  // Initialize particles safely on mount with all animation properties precomputed\n  useEffect(() => {\n    if (typeof window !== 'undefined') {\n      setParticles(\n        Array.from({ length: 50 }, () => ({\n          x: Math.random() * window.innerWidth,\n          y: Math.random() * window.innerHeight,\n          opacity: Math.random() * 0.5 + 0.2,\n          targetY: Math.random() * window.innerHeight,\n          targetOpacity: Math.random() * 0.5 + 0.2,\n          duration: Math.random() * 10 + 10,\n        }))\n      );\n    }\n  }, []);\n\n  // Fetch events and achievements\n  const { data: events = [] } = useQuery<Event[]>({\n    queryKey: [\"/api/events\"],\n  });\n\n  // Filter ongoing, upcoming events and achievements\n  const now = new Date();\n  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n  \n  const ongoingAndUpcomingEvents = events.filter((event) => {\n    // Skip achievements (they're handled separately)\n    if (event.classification === \"Achievement\") return false;\n    if (!event.date) return false;\n    \n    const eventDate = parseEventDate(event.date);\n    if (!eventDate) return false;\n    \n    // If event is in the future, include it\n    if (eventDate > today) return true;\n    \n    // If event is today, check the time\n    if (eventDate.getTime() === today.getTime()) {\n      // If no time specified, include it (ongoing all day)\n      if (!event.time || !event.time.trim()) return true;\n      \n      const parsedTime = parseEventTime(event.time);\n      \n      // If time parsing failed, include the event (safer to show)\n      if (!parsedTime) return true;\n      \n      // Create datetime for comparison\n      const eventDateTime = new Date();\n      eventDateTime.setHours(parsedTime.hours, parsedTime.minutes, 0, 0);\n      \n      // Include if time hasn't passed yet\n      return eventDateTime >= now;\n    }\n    \n    // Event is in the past\n    return false;\n  });\n\n  const achievements = events.filter((event) => event.classification === \"Achievement\");\n\n  // Combine events and achievements for carousel (2 events + 1 achievement per slide)\n  const carouselSlides: Event[][] = [];\n  let eventIndex = 0;\n  let achievementIndex = 0;\n\n  while (eventIndex < ongoingAndUpcomingEvents.length || achievementIndex < achievements.length) {\n    const slide: Event[] = [];\n    \n    // Add up to 2 events\n    if (eventIndex < ongoingAndUpcomingEvents.length) {\n      slide.push(ongoingAndUpcomingEvents[eventIndex]);\n      eventIndex++;\n    }\n    if (eventIndex < ongoingAndUpcomingEvents.length) {\n      slide.push(ongoingAndUpcomingEvents[eventIndex]);\n      eventIndex++;\n    }\n    \n    // Add 1 achievement\n    if (achievementIndex < achievements.length) {\n      slide.push(achievements[achievementIndex]);\n      achievementIndex++;\n    }\n    \n    if (slide.length > 0) {\n      carouselSlides.push(slide);\n    }\n  }\n\n  // Auto-rotate carousel every 10 seconds\n  useEffect(() => {\n    if (carouselSlides.length === 0) return;\n\n    const interval = setInterval(() => {\n      setCurrentSlide((prev) => (prev + 1) % carouselSlides.length);\n    }, 10000);\n\n    return () => clearInterval(interval);\n  }, [carouselSlides.length]);\n\n  // Exit screensaver on any touch/click\n  const handleExit = () => {\n    setLocation(\"/\");\n  };\n\n  return (\n    <div\n      className=\"h-screen w-full overflow-hidden relative cursor-pointer\"\n      onClick={handleExit}\n      onTouchStart={handleExit}\n      style={{\n        background: \"linear-gradient(135deg, hsl(142, 60%, 25%) 0%, hsl(142, 50%, 35%) 50%, hsl(142, 55%, 30%) 100%)\",\n      }}\n    >\n      {/* Animated particle background */}\n      <div className=\"absolute inset-0 overflow-hidden pointer-events-none\">\n        {particles.map((particle, i) => (\n          <motion.div\n            key={i}\n            className=\"absolute w-1 h-1 bg-white rounded-full\"\n            initial={{\n              x: particle.x,\n              y: particle.y,\n              opacity: particle.opacity,\n            }}\n            animate={{\n              y: [null, particle.targetY],\n              opacity: [null, particle.targetOpacity],\n            }}\n            transition={{\n              duration: particle.duration,\n              repeat: Infinity,\n              ease: \"linear\",\n            }}\n          />\n        ))}\n      </div>\n\n      {/* Content */}\n      <div className=\"relative z-10 h-full flex flex-col items-center justify-center px-8 py-12\">\n        {/* Date and Time */}\n        <motion.div\n          className=\"text-center mb-8\"\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.8 }}\n        >\n          <div className=\"flex items-center justify-center gap-2 mb-2\">\n            <Clock className=\"w-5 h-5 text-white\" />\n            <div className=\"text-lg text-white/90\">{formatDate(currentTime)}</div>\n          </div>\n          <div className=\"text-5xl font-bold text-white\" data-testid=\"text-screensaver-time\">\n            {formatTime(currentTime)}\n          </div>\n        </motion.div>\n\n        {/* Title */}\n        <motion.h1\n          className=\"text-4xl md:text-5xl lg:text-6xl font-bold text-white text-center mb-16\"\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.8, delay: 0.2 }}\n        >\n          UNIVERSITY EVENTS & ACHIEVEMENTS\n        </motion.h1>\n\n        {/* Carousel */}\n        <div className=\"w-full max-w-7xl flex-1 flex items-center justify-center mb-16\">\n          <AnimatePresence mode=\"wait\">\n            {carouselSlides.length > 0 && (\n              <motion.div\n                key={currentSlide}\n                initial={{ opacity: 0, x: 100 }}\n                animate={{ opacity: 1, x: 0 }}\n                exit={{ opacity: 0, x: -100 }}\n                transition={{ duration: 0.5 }}\n                className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 w-full\"\n              >\n                {carouselSlides[currentSlide].map((item) => (\n                  <div\n                    key={item.id}\n                    className=\"bg-white/10 backdrop-blur-md rounded-lg overflow-hidden border border-white/20 shadow-2xl\"\n                  >\n                    {/* Image */}\n                    {item.image && (\n                      <div className=\"h-48 overflow-hidden bg-black/20\">\n                        <img\n                          src={item.image}\n                          alt={item.title}\n                          className=\"w-full h-full object-contain\"\n                        />\n                      </div>\n                    )}\n\n                    {/* Content */}\n                    <div className=\"p-6\">\n                      {/* Classification badge */}\n                      <div className=\"mb-3\">\n                        <span\n                          className={`inline-block px-3 py-1 text-xs font-semibold rounded-full ${\n                            item.classification === \"Achievement\"\n                              ? \"bg-yellow-500/90 text-yellow-950\"\n                              : \"bg-primary/90 text-primary-foreground\"\n                          }`}\n                        >\n                          {item.classification}\n                        </span>\n                      </div>\n\n                      {/* Title */}\n                      <h3 className=\"text-xl font-bold text-white mb-2 line-clamp-2\">\n                        {item.title}\n                      </h3>\n\n                      {/* Date/Time (only for events, not achievements) */}\n                      {item.classification !== \"Achievement\" && item.date && (() => {\n                        const eventDate = parseEventDate(item.date);\n                        return eventDate ? (\n                          <p className=\"text-sm text-white/80 mb-2\">\n                            {format(eventDate, \"MMMM d, yyyy\")}\n                            {item.time && ` • ${item.time}`}\n                          </p>\n                        ) : null;\n                      })()}\n\n                      {/* Description */}\n                      <p className=\"text-sm text-white/70 line-clamp-3 mb-3\">\n                        {item.description}\n                      </p>\n\n                      {/* Location */}\n                      {item.location && (\n                        <p className=\"text-xs text-white/60\">📍 {item.location}</p>\n                      )}\n                    </div>\n                  </div>\n                ))}\n              </motion.div>\n            )}\n          </AnimatePresence>\n\n          {/* Empty state */}\n          {carouselSlides.length === 0 && (\n            <motion.div\n              initial={{ opacity: 0, scale: 0.9 }}\n              animate={{ opacity: 1, scale: 1 }}\n              transition={{ duration: 0.5 }}\n              className=\"text-center text-white max-w-2xl\"\n            >\n              <div className=\"bg-white/10 backdrop-blur-md rounded-lg border border-white/20 p-12 shadow-2xl\">\n                <h2 className=\"text-4xl font-bold mb-4\">Welcome to CVSU CCAT</h2>\n                <p className=\"text-xl mb-2 text-white/90\">No upcoming events or achievements at this time</p>\n                <p className=\"text-lg text-white/70\">Stay tuned for exciting updates from our university community!</p>\n              </div>\n            </motion.div>\n          )}\n        </div>\n\n        {/* Touch to begin message */}\n        <motion.div\n          className=\"flex flex-col items-center gap-4\"\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          transition={{ delay: 0.5, duration: 0.8 }}\n        >\n          <motion.div\n            animate={{\n              scale: [1, 1.1, 1],\n              opacity: [0.8, 1, 0.8],\n            }}\n            transition={{\n              duration: 2,\n              repeat: Infinity,\n              ease: \"easeInOut\",\n            }}\n          >\n            <Hand className=\"w-16 h-16 text-white\" />\n          </motion.div>\n          <p className=\"text-2xl md:text-3xl font-semibold text-white text-center\">\n            Touch the screen to begin\n          </p>\n        </motion.div>\n\n        {/* Slide indicators */}\n        {carouselSlides.length > 1 && (\n          <div className=\"absolute bottom-32 left-1/2 transform -translate-x-1/2 flex gap-2\">\n            {carouselSlides.map((_, index) => (\n              <div\n                key={index}\n                className={`w-2 h-2 rounded-full transition-all ${\n                  index === currentSlide ? \"bg-white w-8\" : \"bg-white/40\"\n                }`}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":13976},"client/src/pages/admin-settings.tsx":{"content":"import { useEffect } from \"react\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Settings, Loader2 } from \"lucide-react\";\nimport AdminLayout from \"@/components/admin-layout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormDescription, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient } from \"@/lib/queryClient\";\n\ninterface Setting {\n  id: string;\n  key: string;\n  value: string;\n  description: string | null;\n}\n\nconst settingsFormSchema = z.object({\n  homeTimeout: z.string()\n    .refine((val) => !isNaN(parseInt(val, 10)), {\n      message: \"Must be a valid number\"\n    })\n    .refine((val) => {\n      const num = parseInt(val, 10);\n      return num >= 1 && num <= 300;\n    }, {\n      message: \"Timeout must be between 1 and 300 seconds\"\n    }),\n  globalTimeout: z.string()\n    .refine((val) => !isNaN(parseInt(val, 10)), {\n      message: \"Must be a valid number\"\n    })\n    .refine((val) => {\n      const num = parseInt(val, 10);\n      return num >= 30 && num <= 600;\n    }, {\n      message: \"Timeout must be between 30 and 600 seconds (0.5 to 10 minutes)\"\n    })\n});\n\ntype SettingsFormValues = z.infer<typeof settingsFormSchema>;\n\nexport default function AdminSettings() {\n  const { toast } = useToast();\n\n  const form = useForm<SettingsFormValues>({\n    resolver: zodResolver(settingsFormSchema),\n    defaultValues: {\n      homeTimeout: \"30\",\n      globalTimeout: \"180\"\n    }\n  });\n\n  // Fetch current home timeout setting\n  const { data: homeTimeoutSetting, isLoading: isLoadingHome, error: homeError } = useQuery<Setting>({\n    queryKey: ['/api/settings/home_inactivity_timeout'],\n    queryFn: async () => {\n      const response = await fetch('/api/settings/home_inactivity_timeout');\n      if (response.status === 404) {\n        // Setting doesn't exist yet, return null to use default\n        return null;\n      }\n      if (!response.ok) {\n        throw new Error('Failed to fetch setting');\n      }\n      return response.json();\n    }\n  });\n\n  // Fetch current global timeout setting\n  const { data: globalTimeoutSetting, isLoading: isLoadingGlobal, error: globalError } = useQuery<Setting>({\n    queryKey: ['/api/settings/global_inactivity_timeout'],\n    queryFn: async () => {\n      const response = await fetch('/api/settings/global_inactivity_timeout');\n      if (response.status === 404) {\n        // Setting doesn't exist yet, return null to use default\n        return null;\n      }\n      if (!response.ok) {\n        throw new Error('Failed to fetch setting');\n      }\n      return response.json();\n    }\n  });\n\n  const isLoading = isLoadingHome || isLoadingGlobal;\n  const error = homeError || globalError;\n\n  useEffect(() => {\n    // Reset form when data is loaded (even if settings are null/don't exist)\n    if (!isLoading && !error) {\n      form.reset({\n        homeTimeout: homeTimeoutSetting?.value || \"30\",\n        globalTimeout: globalTimeoutSetting?.value || \"180\"\n      });\n    }\n  }, [homeTimeoutSetting, globalTimeoutSetting, isLoading, error, form]);\n\n  // Update timeout mutation\n  const updateTimeoutMutation = useMutation({\n    mutationFn: async (values: SettingsFormValues) => {\n      // Update home timeout\n      const homeResponse = await fetch('/api/settings/home_inactivity_timeout', {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ value: values.homeTimeout })\n      });\n      \n      if (!homeResponse.ok) {\n        const errorData = await homeResponse.json();\n        throw new Error(errorData.error || 'Failed to update home timeout');\n      }\n\n      // Update global timeout\n      const globalResponse = await fetch('/api/settings/global_inactivity_timeout', {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ value: values.globalTimeout })\n      });\n      \n      if (!globalResponse.ok) {\n        const errorData = await globalResponse.json();\n        throw new Error(errorData.error || 'Failed to update global timeout');\n      }\n      \n      return { home: await homeResponse.json(), global: await globalResponse.json() };\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/settings/home_inactivity_timeout'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/settings/global_inactivity_timeout'] });\n      toast({\n        title: \"Settings Updated\",\n        description: \"Inactivity timeouts have been updated successfully.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update settings. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (values: SettingsFormValues) => {\n    updateTimeoutMutation.mutate(values);\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"p-8\">\n        <div className=\"flex items-center gap-3 mb-6\">\n          <Settings className=\"w-8 h-8 text-foreground\" />\n          <h1 className=\"text-3xl font-bold text-foreground\">Settings</h1>\n        </div>\n\n        <div className=\"max-w-2xl space-y-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Homepage Inactivity Timeout</CardTitle>\n              <CardDescription>\n                Configure how long the homepage should wait before showing the screensaver (in seconds)\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              {isLoading ? (\n                <div className=\"flex items-center gap-2 text-muted-foreground py-4\">\n                  <Loader2 className=\"w-4 h-4 animate-spin\" />\n                  <span>Loading settings...</span>\n                </div>\n              ) : error ? (\n                <div className=\"text-destructive py-4\">\n                  Failed to load settings. Please refresh the page.\n                </div>\n              ) : (\n                <Form {...form}>\n                  <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n                    <FormField\n                      control={form.control}\n                      name=\"homeTimeout\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Homepage Timeout (seconds)</FormLabel>\n                          <FormControl>\n                            <Input\n                              type=\"number\"\n                              min=\"1\"\n                              max=\"300\"\n                              placeholder=\"30\"\n                              data-testid=\"input-home-timeout\"\n                              {...field}\n                            />\n                          </FormControl>\n                          <FormDescription>\n                            Enter a value between 1 and 300 seconds. Default is 30 seconds.\n                          </FormDescription>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <div className=\"pt-4 border-t border-border\">\n                      <h3 className=\"text-lg font-medium mb-2\">Page Inactivity Timeout</h3>\n                      <p className=\"text-sm text-muted-foreground mb-4\">\n                        Configure how long other pages should wait before returning to homepage due to inactivity\n                      </p>\n                      \n                      <FormField\n                        control={form.control}\n                        name=\"globalTimeout\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Page Timeout (seconds)</FormLabel>\n                            <FormControl>\n                              <Input\n                                type=\"number\"\n                                min=\"30\"\n                                max=\"600\"\n                                placeholder=\"180\"\n                                data-testid=\"input-global-timeout\"\n                                {...field}\n                              />\n                            </FormControl>\n                            <FormDescription>\n                              Enter a value between 30 and 600 seconds (0.5 to 10 minutes). Default is 180 seconds (3 minutes).\n                            </FormDescription>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n\n                    <Button\n                      type=\"submit\"\n                      disabled={updateTimeoutMutation.isPending}\n                      data-testid=\"button-save-settings\"\n                    >\n                      {updateTimeoutMutation.isPending && (\n                        <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                      )}\n                      {updateTimeoutMutation.isPending ? \"Saving...\" : \"Save Changes\"}\n                    </Button>\n                  </form>\n                </Form>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","size_bytes":9549},"migrate-to-firebase.js":{"content":"import admin from 'firebase-admin';\nimport { readFileSync } from 'fs';\nimport { createRequire } from 'module';\n\nconst require = createRequire(import.meta.url);\n\n// Load service account key\nconst serviceAccount = JSON.parse(\n  readFileSync('./serviceAccountKey.json', 'utf8')\n);\n\n// Initialize Firebase Admin\nadmin.initializeApp({\n  credential: admin.credential.cert(serviceAccount)\n});\n\nconst db = admin.firestore();\n\n// Load your data.json (corrected path - in root directory)\nconst data = JSON.parse(readFileSync('./data.json', 'utf8'));\n\nasync function migrateData() {\n  try {\n    console.log('🚀 Starting data migration to Firestore...\\n');\n\n    // Migrate Buildings\n    if (data.buildings && data.buildings.length > 0) {\n      console.log('📍 Migrating buildings...');\n      for (const building of data.buildings) {\n        await db.collection('buildings').doc(building.id.toString()).set(building);\n        console.log(`  ✅ ${building.name}`);\n      }\n    }\n\n    // Migrate Staff\n    if (data.staff && data.staff.length > 0) {\n      console.log('\\n👥 Migrating staff...');\n      for (const staff of data.staff) {\n        await db.collection('staff').doc(staff.id.toString()).set(staff);\n        console.log(`  ✅ ${staff.name}`);\n      }\n    }\n\n    // Migrate Events\n    if (data.events && data.events.length > 0) {\n      console.log('\\n📅 Migrating events...');\n      for (const event of data.events) {\n        await db.collection('events').doc(event.id.toString()).set(event);\n        console.log(`  ✅ ${event.title}`);\n      }\n    }\n\n    // Migrate Floors\n    if (data.floors && data.floors.length > 0) {\n      console.log('\\n🏢 Migrating floors...');\n      for (const floor of data.floors) {\n        await db.collection('floors').doc(floor.id.toString()).set(floor);\n        console.log(`  ✅ Floor ${floor.floorNumber} - Building ${floor.buildingId}`);\n      }\n    }\n\n    // Migrate Rooms\n    if (data.rooms && data.rooms.length > 0) {\n      console.log('\\n🚪 Migrating rooms...');\n      for (const room of data.rooms) {\n        await db.collection('rooms').doc(room.id.toString()).set(room);\n        console.log(`  ✅ ${room.name || room.type}`);\n      }\n    }\n\n    // Migrate Walkpaths\n    if (data.walkpaths && data.walkpaths.length > 0) {\n      console.log('\\n🚶 Migrating walkpaths...');\n      for (const path of data.walkpaths) {\n        await db.collection('walkpaths').doc(path.id.toString()).set(path);\n        console.log(`  ✅ Walkpath ${path.id}`);\n      }\n    }\n\n    // Migrate Drivepaths\n    if (data.drivepaths && data.drivepaths.length > 0) {\n      console.log('\\n🚗 Migrating drivepaths...');\n      for (const path of data.drivepaths) {\n        await db.collection('drivepaths').doc(path.id.toString()).set(path);\n        console.log(`  ✅ Drivepath ${path.id}`);\n      }\n    }\n\n    // Migrate Admins\n    if (data.admins && data.admins.length > 0) {\n      console.log('\\n👨‍💼 Migrating admins...');\n      for (const adminUser of data.admins) {\n        await db.collection('admins').doc(adminUser.id.toString()).set(adminUser);\n        console.log(`  ✅ ${adminUser.username}`);\n      }\n    }\n\n    // Migrate Settings\n    if (data.settings && data.settings.length > 0) {\n      console.log('\\n⚙️ Migrating settings...');\n      for (const setting of data.settings) {\n        await db.collection('settings').doc(setting.key).set(setting);\n        console.log(`  ✅ ${setting.key}`);\n      }\n    }\n\n    console.log('\\n\\n✨ Migration complete! All data transferred to Firestore.');\n    console.log('\\n📊 Summary:');\n    console.log(`   Buildings: ${data.buildings?.length || 0}`);\n    console.log(`   Staff: ${data.staff?.length || 0}`);\n    console.log(`   Events: ${data.events?.length || 0}`);\n    console.log(`   Floors: ${data.floors?.length || 0}`);\n    console.log(`   Rooms: ${data.rooms?.length || 0}`);\n    console.log(`   Walkpaths: ${data.walkpaths?.length || 0}`);\n    console.log(`   Drivepaths: ${data.drivepaths?.length || 0}`);\n    console.log(`   Admins: ${data.admins?.length || 0}`);\n    console.log(`   Settings: ${data.settings?.length || 0}`);\n    \n    console.log('\\n🌐 View your data at:');\n    console.log('   https://console.firebase.google.com/');\n    \n    process.exit(0);\n  } catch (error) {\n    console.error('\\n❌ Migration error:', error);\n    console.error('\\nPlease check:');\n    console.error('   1. serviceAccountKey.json exists in project root');\n    console.error('   2. data.json exists in project root');\n    console.error('   3. Firebase project has Firestore enabled');\n    console.error('   4. Service account has proper permissions');\n    process.exit(1);\n  }\n}\n\n// Run the migration\nmigrateData();","size_bytes":4709},"functions/index.js":{"content":"const functions = require('firebase-functions');\nconst admin = require('firebase-admin');\nconst express = require('express');\nconst cors = require('cors');\n\n// Initialize Firebase Admin\nadmin.initializeApp();\n\n// Configure Firestore\nconst db = admin.firestore();\n\n// Use Firestore emulator when running locally\nif (process.env.FUNCTIONS_EMULATOR === 'true') {\n  db.settings({\n    host: 'localhost:8080',\n    ssl: false\n  });\n}\n\nconst app = express();\napp.use(cors({ origin: true }));\napp.use(express.json());\n\n// ============= BUILDINGS API =============\napp.get('/api/buildings', async (req, res) => {\n  try {\n    const snapshot = await db.collection('buildings').get();\n    const buildings = snapshot.docs.map(doc => {\n      const data = doc.data();\n      return {\n        id: parseInt(doc.id),\n        ...data\n      };\n    });\n    res.json(buildings);\n  } catch (error) {\n    console.error('Error fetching buildings:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.get('/api/buildings/:id', async (req, res) => {\n  try {\n    const doc = await db.collection('buildings').doc(req.params.id).get();\n    if (!doc.exists) {\n      return res.status(404).json({ error: 'Building not found' });\n    }\n    const data = doc.data();\n    res.json({ id: parseInt(doc.id), ...data });\n  } catch (error) {\n    console.error('Error fetching building:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.post('/api/buildings', async (req, res) => {\n  try {\n    // Get the highest ID and increment\n    const snapshot = await db.collection('buildings').orderBy('id', 'desc').limit(1).get();\n    let newId = 1;\n    if (!snapshot.empty) {\n      const maxId = snapshot.docs[0].data().id;\n      newId = maxId + 1;\n    }\n    \n    const buildingData = { ...req.body, id: newId };\n    await db.collection('buildings').doc(newId.toString()).set(buildingData);\n    res.json(buildingData);\n  } catch (error) {\n    console.error('Error creating building:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.patch('/api/buildings/:id', async (req, res) => {\n  try {\n    const docRef = db.collection('buildings').doc(req.params.id);\n    const doc = await docRef.get();\n    \n    if (!doc.exists) {\n      return res.status(404).json({ error: 'Building not found' });\n    }\n    \n    await docRef.update(req.body);\n    const updated = await docRef.get();\n    res.json({ id: parseInt(updated.id), ...updated.data() });\n  } catch (error) {\n    console.error('Error updating building:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.delete('/api/buildings/:id', async (req, res) => {\n  try {\n    await db.collection('buildings').doc(req.params.id).delete();\n    res.json({ success: true });\n  } catch (error) {\n    console.error('Error deleting building:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\n// ============= STAFF API =============\napp.get('/api/staff', async (req, res) => {\n  try {\n    const snapshot = await db.collection('staff').get();\n    const staff = snapshot.docs.map(doc => ({\n      id: parseInt(doc.id),\n      ...doc.data()\n    }));\n    res.json(staff);\n  } catch (error) {\n    console.error('Error fetching staff:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.get('/api/staff/:id', async (req, res) => {\n  try {\n    const doc = await db.collection('staff').doc(req.params.id).get();\n    if (!doc.exists) {\n      return res.status(404).json({ error: 'Staff not found' });\n    }\n    res.json({ id: parseInt(doc.id), ...doc.data() });\n  } catch (error) {\n    console.error('Error fetching staff:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.post('/api/staff', async (req, res) => {\n  try {\n    const snapshot = await db.collection('staff').orderBy('id', 'desc').limit(1).get();\n    let newId = 1;\n    if (!snapshot.empty) {\n      newId = snapshot.docs[0].data().id + 1;\n    }\n    \n    const staffData = { ...req.body, id: newId };\n    await db.collection('staff').doc(newId.toString()).set(staffData);\n    res.json(staffData);\n  } catch (error) {\n    console.error('Error creating staff:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.patch('/api/staff/:id', async (req, res) => {\n  try {\n    const docRef = db.collection('staff').doc(req.params.id);\n    const doc = await docRef.get();\n    \n    if (!doc.exists) {\n      return res.status(404).json({ error: 'Staff not found' });\n    }\n    \n    await docRef.update(req.body);\n    const updated = await docRef.get();\n    res.json({ id: parseInt(updated.id), ...updated.data() });\n  } catch (error) {\n    console.error('Error updating staff:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.delete('/api/staff/:id', async (req, res) => {\n  try {\n    await db.collection('staff').doc(req.params.id).delete();\n    res.json({ success: true });\n  } catch (error) {\n    console.error('Error deleting staff:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\n// ============= EVENTS API =============\napp.get('/api/events', async (req, res) => {\n  try {\n    const snapshot = await db.collection('events').get();\n    const events = snapshot.docs.map(doc => ({\n      id: parseInt(doc.id),\n      ...doc.data()\n    }));\n    res.json(events);\n  } catch (error) {\n    console.error('Error fetching events:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.get('/api/events/:id', async (req, res) => {\n  try {\n    const doc = await db.collection('events').doc(req.params.id).get();\n    if (!doc.exists) {\n      return res.status(404).json({ error: 'Event not found' });\n    }\n    res.json({ id: parseInt(doc.id), ...doc.data() });\n  } catch (error) {\n    console.error('Error fetching event:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.post('/api/events', async (req, res) => {\n  try {\n    const snapshot = await db.collection('events').orderBy('id', 'desc').limit(1).get();\n    let newId = 1;\n    if (!snapshot.empty) {\n      newId = snapshot.docs[0].data().id + 1;\n    }\n    \n    const eventData = { ...req.body, id: newId };\n    await db.collection('events').doc(newId.toString()).set(eventData);\n    res.json(eventData);\n  } catch (error) {\n    console.error('Error creating event:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.patch('/api/events/:id', async (req, res) => {\n  try {\n    const docRef = db.collection('events').doc(req.params.id);\n    const doc = await docRef.get();\n    \n    if (!doc.exists) {\n      return res.status(404).json({ error: 'Event not found' });\n    }\n    \n    await docRef.update(req.body);\n    const updated = await docRef.get();\n    res.json({ id: parseInt(updated.id), ...updated.data() });\n  } catch (error) {\n    console.error('Error updating event:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.delete('/api/events/:id', async (req, res) => {\n  try {\n    await db.collection('events').doc(req.params.id).delete();\n    res.json({ success: true });\n  } catch (error) {\n    console.error('Error deleting event:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\n// ============= FLOORS API =============\napp.get('/api/floors', async (req, res) => {\n  try {\n    let query = db.collection('floors');\n    \n    if (req.query.buildingId) {\n      query = query.where('buildingId', '==', parseInt(req.query.buildingId));\n    }\n    \n    const snapshot = await query.get();\n    const floors = snapshot.docs.map(doc => ({\n      id: parseInt(doc.id),\n      ...doc.data()\n    }));\n    res.json(floors);\n  } catch (error) {\n    console.error('Error fetching floors:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.get('/api/floors/:id', async (req, res) => {\n  try {\n    const doc = await db.collection('floors').doc(req.params.id).get();\n    if (!doc.exists) {\n      return res.status(404).json({ error: 'Floor not found' });\n    }\n    res.json({ id: parseInt(doc.id), ...doc.data() });\n  } catch (error) {\n    console.error('Error fetching floor:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.post('/api/floors', async (req, res) => {\n  try {\n    const snapshot = await db.collection('floors').orderBy('id', 'desc').limit(1).get();\n    let newId = 1;\n    if (!snapshot.empty) {\n      newId = snapshot.docs[0].data().id + 1;\n    }\n    \n    const floorData = { ...req.body, id: newId };\n    await db.collection('floors').doc(newId.toString()).set(floorData);\n    res.json(floorData);\n  } catch (error) {\n    console.error('Error creating floor:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.patch('/api/floors/:id', async (req, res) => {\n  try {\n    const docRef = db.collection('floors').doc(req.params.id);\n    const doc = await docRef.get();\n    \n    if (!doc.exists) {\n      return res.status(404).json({ error: 'Floor not found' });\n    }\n    \n    await docRef.update(req.body);\n    const updated = await docRef.get();\n    res.json({ id: parseInt(updated.id), ...updated.data() });\n  } catch (error) {\n    console.error('Error updating floor:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.delete('/api/floors/:id', async (req, res) => {\n  try {\n    await db.collection('floors').doc(req.params.id).delete();\n    res.json({ success: true });\n  } catch (error) {\n    console.error('Error deleting floor:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\n// ============= ROOMS API =============\napp.get('/api/rooms', async (req, res) => {\n  try {\n    let query = db.collection('rooms');\n    \n    if (req.query.floorId) {\n      query = query.where('floorId', '==', parseInt(req.query.floorId));\n    }\n    \n    const snapshot = await query.get();\n    const rooms = snapshot.docs.map(doc => ({\n      id: parseInt(doc.id),\n      ...doc.data()\n    }));\n    res.json(rooms);\n  } catch (error) {\n    console.error('Error fetching rooms:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.get('/api/rooms/:id', async (req, res) => {\n  try {\n    const doc = await db.collection('rooms').doc(req.params.id).get();\n    if (!doc.exists) {\n      return res.status(404).json({ error: 'Room not found' });\n    }\n    res.json({ id: parseInt(doc.id), ...doc.data() });\n  } catch (error) {\n    console.error('Error fetching room:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.post('/api/rooms', async (req, res) => {\n  try {\n    const snapshot = await db.collection('rooms').orderBy('id', 'desc').limit(1).get();\n    let newId = 1;\n    if (!snapshot.empty) {\n      newId = snapshot.docs[0].data().id + 1;\n    }\n    \n    const roomData = { ...req.body, id: newId };\n    await db.collection('rooms').doc(newId.toString()).set(roomData);\n    res.json(roomData);\n  } catch (error) {\n    console.error('Error creating room:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.patch('/api/rooms/:id', async (req, res) => {\n  try {\n    const docRef = db.collection('rooms').doc(req.params.id);\n    const doc = await docRef.get();\n    \n    if (!doc.exists) {\n      return res.status(404).json({ error: 'Room not found' });\n    }\n    \n    await docRef.update(req.body);\n    const updated = await docRef.get();\n    res.json({ id: parseInt(updated.id), ...updated.data() });\n  } catch (error) {\n    console.error('Error updating room:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.delete('/api/rooms/:id', async (req, res) => {\n  try {\n    await db.collection('rooms').doc(req.params.id).delete();\n    res.json({ success: true });\n  } catch (error) {\n    console.error('Error deleting room:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\n// ============= WALKPATHS API =============\napp.get('/api/walkpaths', async (req, res) => {\n  try {\n    const snapshot = await db.collection('walkpaths').get();\n    const walkpaths = snapshot.docs.map(doc => ({\n      id: parseInt(doc.id),\n      ...doc.data()\n    }));\n    res.json(walkpaths);\n  } catch (error) {\n    console.error('Error fetching walkpaths:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.post('/api/walkpaths', async (req, res) => {\n  try {\n    const snapshot = await db.collection('walkpaths').orderBy('id', 'desc').limit(1).get();\n    let newId = 1;\n    if (!snapshot.empty) {\n      newId = snapshot.docs[0].data().id + 1;\n    }\n    \n    const pathData = { ...req.body, id: newId };\n    await db.collection('walkpaths').doc(newId.toString()).set(pathData);\n    res.json(pathData);\n  } catch (error) {\n    console.error('Error creating walkpath:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.patch('/api/walkpaths/:id', async (req, res) => {\n  try {\n    const docRef = db.collection('walkpaths').doc(req.params.id);\n    const doc = await docRef.get();\n    \n    if (!doc.exists) {\n      return res.status(404).json({ error: 'Walkpath not found' });\n    }\n    \n    await docRef.update(req.body);\n    const updated = await docRef.get();\n    res.json({ id: parseInt(updated.id), ...updated.data() });\n  } catch (error) {\n    console.error('Error updating walkpath:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.delete('/api/walkpaths/:id', async (req, res) => {\n  try {\n    await db.collection('walkpaths').doc(req.params.id).delete();\n    res.json({ success: true });\n  } catch (error) {\n    console.error('Error deleting walkpath:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\n// ============= DRIVEPATHS API =============\napp.get('/api/drivepaths', async (req, res) => {\n  try {\n    const snapshot = await db.collection('drivepaths').get();\n    const drivepaths = snapshot.docs.map(doc => ({\n      id: parseInt(doc.id),\n      ...doc.data()\n    }));\n    res.json(drivepaths);\n  } catch (error) {\n    console.error('Error fetching drivepaths:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.post('/api/drivepaths', async (req, res) => {\n  try {\n    const snapshot = await db.collection('drivepaths').orderBy('id', 'desc').limit(1).get();\n    let newId = 1;\n    if (!snapshot.empty) {\n      newId = snapshot.docs[0].data().id + 1;\n    }\n    \n    const pathData = { ...req.body, id: newId };\n    await db.collection('drivepaths').doc(newId.toString()).set(pathData);\n    res.json(pathData);\n  } catch (error) {\n    console.error('Error creating drivepath:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.patch('/api/drivepaths/:id', async (req, res) => {\n  try {\n    const docRef = db.collection('drivepaths').doc(req.params.id);\n    const doc = await docRef.get();\n    \n    if (!doc.exists) {\n      return res.status(404).json({ error: 'Drivepath not found' });\n    }\n    \n    await docRef.update(req.body);\n    const updated = await docRef.get();\n    res.json({ id: parseInt(updated.id), ...updated.data() });\n  } catch (error) {\n    console.error('Error updating drivepath:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.delete('/api/drivepaths/:id', async (req, res) => {\n  try {\n    await db.collection('drivepaths').doc(req.params.id).delete();\n    res.json({ success: true });\n  } catch (error) {\n    console.error('Error deleting drivepath:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\n// ============= SETTINGS API =============\napp.get('/api/settings/:key', async (req, res) => {\n  try {\n    const doc = await db.collection('settings').doc(req.params.key).get();\n    if (!doc.exists) {\n      return res.status(404).json({ error: 'Setting not found' });\n    }\n    res.json(doc.data());\n  } catch (error) {\n    console.error('Error fetching setting:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.put('/api/settings/:key', async (req, res) => {\n  try {\n    const settingData = { key: req.params.key, ...req.body };\n    await db.collection('settings').doc(req.params.key).set(settingData, { merge: true });\n    res.json(settingData);\n  } catch (error) {\n    console.error('Error updating setting:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\n// ============= ADMIN AUTH API =============\napp.post('/api/auth/login', async (req, res) => {\n  try {\n    const { username, password } = req.body;\n    \n    // Query admins collection for matching username\n    const snapshot = await db.collection('admins')\n      .where('username', '==', username)\n      .limit(1)\n      .get();\n    \n    if (snapshot.empty) {\n      return res.status(401).json({ error: 'Invalid credentials' });\n    }\n    \n    const admin = snapshot.docs[0].data();\n    \n    // In production, you should use bcrypt to compare hashed passwords\n    // For now, assuming plaintext comparison (INSECURE - FIX THIS!)\n    if (admin.password !== password) {\n      return res.status(401).json({ error: 'Invalid credentials' });\n    }\n    \n    // Return admin data (without password)\n    const { password: _, ...adminData } = admin;\n    res.json({\n      id: parseInt(snapshot.docs[0].id),\n      ...adminData\n    });\n  } catch (error) {\n    console.error('Error during login:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\napp.post('/api/auth/logout', (req, res) => {\n  // Since we're using Firebase Functions, sessions are handled client-side\n  res.json({ success: true });\n});\n\napp.get('/api/auth/me', async (req, res) => {\n  // For Firebase, you'd typically use Firebase Authentication\n  // This is a placeholder - implement proper auth later\n  res.status(401).json({ error: 'Not authenticated' });\n});\n\n// ============= ROUTES CALCULATION API =============\napp.post('/api/routes/calculate', async (req, res) => {\n  try {\n    const { startBuildingId, endBuildingId, mode } = req.body;\n    \n    // Fetch necessary data from Firestore\n    const [buildingsSnap, walkpathsSnap, drivepathsSnap] = await Promise.all([\n      db.collection('buildings').get(),\n      db.collection('walkpaths').get(),\n      db.collection('drivepaths').get()\n    ]);\n\n    const buildings = buildingsSnap.docs.map(doc => ({\n      id: parseInt(doc.id),\n      ...doc.data()\n    }));\n    \n    const walkpaths = walkpathsSnap.docs.map(doc => ({\n      id: parseInt(doc.id),\n      ...doc.data()\n    }));\n    \n    const drivepaths = drivepathsSnap.docs.map(doc => ({\n      id: parseInt(doc.id),\n      ...doc.data()\n    }));\n\n    // Find start and end buildings\n    const startBuilding = buildings.find(b => b.id === parseInt(startBuildingId));\n    const endBuilding = buildings.find(b => b.id === parseInt(endBuildingId));\n\n    if (!startBuilding || !endBuilding) {\n      return res.status(404).json({ error: 'Building not found' });\n    }\n\n    // PATHFINDING ALGORITHM (Dijkstra with node snapping)\n    const result = calculateRoute(startBuilding, endBuilding, mode, walkpaths, drivepaths);\n    \n    res.json(result);\n  } catch (error) {\n    console.error('Error calculating route:', error);\n    res.status(500).json({ error: error.message });\n  }\n});\n\n// ============= PATHFINDING HELPER FUNCTIONS =============\nfunction calculateRoute(startBuilding, endBuilding, mode, walkpaths, drivepaths) {\n  const SNAPPING_THRESHOLD = 10; // meters\n  \n  // Select paths based on mode\n  const paths = mode === 'driving' ? drivepaths : walkpaths;\n  \n  // Build graph with node snapping\n  const { nodes, edges } = buildGraph(startBuilding, endBuilding, paths, SNAPPING_THRESHOLD);\n  \n  // Run Dijkstra's algorithm\n  const shortestPath = dijkstra(nodes, edges, 'start', 'end');\n  \n  if (!shortestPath) {\n    return {\n      waypoints: [\n        [startBuilding.latitude, startBuilding.longitude],\n        [endBuilding.latitude, endBuilding.longitude]\n      ],\n      distance: calculateDistance(\n        startBuilding.latitude,\n        startBuilding.longitude,\n        endBuilding.latitude,\n        endBuilding.longitude\n      ),\n      duration: 0,\n      mode\n    };\n  }\n  \n  // Calculate total distance and duration\n  let totalDistance = 0;\n  for (let i = 0; i < shortestPath.length - 1; i++) {\n    const current = nodes[shortestPath[i]];\n    const next = nodes[shortestPath[i + 1]];\n    totalDistance += calculateDistance(current.lat, current.lon, next.lat, next.lon);\n  }\n  \n  // Estimate duration (walking: 5 km/h, driving: 20 km/h)\n  const speed = mode === 'driving' ? 20 : 5;\n  const durationMinutes = (totalDistance / speed) * 60;\n  \n  return {\n    waypoints: shortestPath.map(nodeId => [nodes[nodeId].lat, nodes[nodeId].lon]),\n    distance: totalDistance,\n    duration: Math.ceil(durationMinutes),\n    mode\n  };\n}\n\nfunction buildGraph(startBuilding, endBuilding, paths, snapThreshold) {\n  const nodes = {};\n  const edges = [];\n  let nodeId = 0;\n  \n  // Add start and end nodes\n  nodes['start'] = {\n    lat: startBuilding.latitude,\n    lon: startBuilding.longitude,\n    pathId: null\n  };\n  \n  nodes['end'] = {\n    lat: endBuilding.latitude,\n    lon: endBuilding.longitude,\n    pathId: null\n  };\n  \n  // Add path nodes\n  paths.forEach(path => {\n    const coords = path.coordinates;\n    for (let i = 0; i < coords.length; i++) {\n      const id = `path${path.id}_node${i}`;\n      nodes[id] = {\n        lat: coords[i][0],\n        lon: coords[i][1],\n        pathId: path.id\n      };\n      \n      // Connect consecutive nodes in the path\n      if (i > 0) {\n        const prevId = `path${path.id}_node${i - 1}`;\n        const dist = calculateDistance(\n          nodes[prevId].lat,\n          nodes[prevId].lon,\n          nodes[id].lat,\n          nodes[id].lon\n        );\n        edges.push({ from: prevId, to: id, weight: dist });\n        edges.push({ from: id, to: prevId, weight: dist });\n      }\n    }\n  });\n  \n  // Merge nearby nodes from different paths (node snapping)\n  const mergedNodes = mergeNearbyNodes(nodes, snapThreshold);\n  \n  // Connect start and end to nearest path nodes\n  connectBuildingToPath('start', nodes, edges, snapThreshold);\n  connectBuildingToPath('end', nodes, edges, snapThreshold);\n  \n  return { nodes: mergedNodes.nodes, edges: mergedNodes.edges };\n}\n\nfunction mergeNearbyNodes(nodes, threshold) {\n  const nodeIds = Object.keys(nodes);\n  const clusters = new UnionFind(nodeIds);\n  \n  // Find nodes within threshold distance\n  for (let i = 0; i < nodeIds.length; i++) {\n    for (let j = i + 1; j < nodeIds.length; j++) {\n      const id1 = nodeIds[i];\n      const id2 = nodeIds[j];\n      const node1 = nodes[id1];\n      const node2 = nodes[id2];\n      \n      // Only merge nodes from different paths\n      if (node1.pathId !== node2.pathId || (node1.pathId === null && node2.pathId === null)) {\n        const dist = calculateDistance(node1.lat, node1.lon, node2.lat, node2.lon);\n        \n        if (dist <= threshold) {\n          clusters.union(id1, id2);\n        }\n      }\n    }\n  }\n  \n  // Create merged nodes\n  const mergedNodes = {};\n  const clusterMap = {};\n  \n  nodeIds.forEach(id => {\n    const root = clusters.find(id);\n    if (!clusterMap[root]) {\n      clusterMap[root] = [];\n    }\n    clusterMap[root].push(id);\n  });\n  \n  // Average coordinates for merged nodes\n  Object.entries(clusterMap).forEach(([root, members]) => {\n    const avgLat = members.reduce((sum, id) => sum + nodes[id].lat, 0) / members.length;\n    const avgLon = members.reduce((sum, id) => sum + nodes[id].lon, 0) / members.length;\n    \n    mergedNodes[root] = {\n      lat: avgLat,\n      lon: avgLon,\n      pathId: nodes[root].pathId\n    };\n  });\n  \n  return { nodes: mergedNodes, edges: [] };\n}\n\nfunction connectBuildingToPath(buildingId, nodes, edges, threshold) {\n  const building = nodes[buildingId];\n  let nearest = null;\n  let minDist = Infinity;\n  \n  Object.entries(nodes).forEach(([id, node]) => {\n    if (id === buildingId) return;\n    \n    const dist = calculateDistance(building.lat, building.lon, node.lat, node.lon);\n    if (dist < minDist) {\n      minDist = dist;\n      nearest = id;\n    }\n  });\n  \n  if (nearest) {\n    edges.push({ from: buildingId, to: nearest, weight: minDist });\n    edges.push({ from: nearest, to: buildingId, weight: minDist });\n  }\n}\n\nfunction dijkstra(nodes, edges, startId, endId) {\n  const distances = {};\n  const previous = {};\n  const unvisited = new Set(Object.keys(nodes));\n  \n  Object.keys(nodes).forEach(id => {\n    distances[id] = Infinity;\n  });\n  distances[startId] = 0;\n  \n  while (unvisited.size > 0) {\n    let current = null;\n    let minDist = Infinity;\n    \n    unvisited.forEach(id => {\n      if (distances[id] < minDist) {\n        minDist = distances[id];\n        current = id;\n      }\n    });\n    \n    if (current === null || current === endId) break;\n    \n    unvisited.delete(current);\n    \n    edges.forEach(edge => {\n      if (edge.from === current && unvisited.has(edge.to)) {\n        const newDist = distances[current] + edge.weight;\n        if (newDist < distances[edge.to]) {\n          distances[edge.to] = newDist;\n          previous[edge.to] = current;\n        }\n      }\n    });\n  }\n  \n  if (distances[endId] === Infinity) return null;\n  \n  const path = [];\n  let current = endId;\n  while (current) {\n    path.unshift(current);\n    current = previous[current];\n  }\n  \n  return path;\n}\n\n// Union-Find data structure\nclass UnionFind {\n  constructor(elements) {\n    this.parent = {};\n    this.rank = {};\n    elements.forEach(e => {\n      this.parent[e] = e;\n      this.rank[e] = 0;\n    });\n  }\n  \n  find(x) {\n    if (this.parent[x] !== x) {\n      this.parent[x] = this.find(this.parent[x]);\n    }\n    return this.parent[x];\n  }\n  \n  union(x, y) {\n    const rootX = this.find(x);\n    const rootY = this.find(y);\n    \n    if (rootX === rootY) return;\n    \n    if (this.rank[rootX] < this.rank[rootY]) {\n      this.parent[rootX] = rootY;\n    } else if (this.rank[rootX] > this.rank[rootY]) {\n      this.parent[rootY] = rootX;\n    } else {\n      this.parent[rootY] = rootX;\n      this.rank[rootX]++;\n    }\n  }\n}\n\nfunction calculateDistance(lat1, lon1, lat2, lon2) {\n  const R = 6371e3; // Earth's radius in meters\n  const φ1 = (lat1 * Math.PI) / 180;\n  const φ2 = (lat2 * Math.PI) / 180;\n  const Δφ = ((lat2 - lat1) * Math.PI) / 180;\n  const Δλ = ((lon2 - lon1) * Math.PI) / 180;\n\n  const a =\n    Math.sin(Δφ / 2) * Math.sin(Δφ / 2) +\n    Math.cos(φ1) * Math.cos(φ2) * Math.sin(Δλ / 2) * Math.sin(Δλ / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n\n  return R * c / 1000; // Return in kilometers\n}\n\n// Export Express app as Firebase Function\nexports.api = functions.https.onRequest(app);","size_bytes":26520},"server/firebase.ts":{"content":"import admin from 'firebase-admin';\n\nlet firebaseApp: admin.app.App;\nlet firestoreDb: admin.firestore.Firestore;\nlet initializationFailed = false;\n\nexport function initializeFirebase() {\n  if (firebaseApp) {\n    return { app: firebaseApp, db: firestoreDb };\n  }\n\n  if (initializationFailed) {\n    throw new Error('Firebase initialization previously failed');\n  }\n\n  try {\n    const projectId = process.env.FIREBASE_PROJECT_ID;\n    const privateKey = process.env.FIREBASE_PRIVATE_KEY;\n    const clientEmail = process.env.FIREBASE_CLIENT_EMAIL;\n\n    if (!projectId || !privateKey || !clientEmail) {\n      console.warn('⚠️ Firebase credentials not found in environment variables');\n      console.warn('⚠️ Falling back to data.json for read operations');\n      initializationFailed = true;\n      throw new Error('Firebase credentials not configured');\n    }\n\n    firebaseApp = admin.initializeApp({\n      credential: admin.credential.cert({\n        projectId,\n        privateKey: privateKey.replace(/\\\\n/g, '\\n'),\n        clientEmail,\n      })\n    });\n\n    firestoreDb = firebaseApp.firestore();\n    \n    console.log('✅ Firebase Admin initialized successfully');\n    return { app: firebaseApp, db: firestoreDb };\n  } catch (error) {\n    console.error('❌ Error initializing Firebase:', error);\n    initializationFailed = true;\n    throw error;\n  }\n}\n\nexport function getFirestore(): admin.firestore.Firestore {\n  if (!firestoreDb) {\n    const { db } = initializeFirebase();\n    return db;\n  }\n  return firestoreDb;\n}\n","size_bytes":1524},"client/src/lib/offline-data.ts":{"content":"import type { Walkpath, Drivepath, Building, Staff, Floor, Room, Event } from \"@shared/schema\";\nimport baselineData from \"./baseline-data.json\";\n\nconst DATA_CACHE_NAME = 'iccat-data-v3';\n\nlet cachedBuildings: Building[] | null = null;\nlet cachedWalkpaths: Walkpath[] | null = null;\nlet cachedDrivepaths: Drivepath[] | null = null;\nlet cachedStaff: Staff[] | null = null;\nlet cachedFloors: Floor[] | null = null;\nlet cachedRooms: Room[] | null = null;\nlet cachedEvents: Event[] | null = null;\n\nasync function fetchWithCacheFallback<T>(\n  url: string, \n  dataJsonKey: keyof typeof baselineData\n): Promise<T> {\n  try {\n    const response = await fetch(url);\n    if (response.ok) {\n      return await response.json();\n    }\n  } catch (fetchError) {\n    console.log(`[OFFLINE] Fetch failed for ${url} (offline or network error), trying cache...`);\n  }\n\n  if (window.caches) {\n    try {\n      const cache = await window.caches.open(DATA_CACHE_NAME);\n      const cachedResponse = await cache.match(url);\n      if (cachedResponse) {\n        console.log(`[OFFLINE] Retrieved ${url} from CacheStorage`);\n        return await cachedResponse.json();\n      }\n    } catch (cacheError) {\n      console.error(`[OFFLINE] CacheStorage error for ${url}:`, cacheError);\n    }\n  }\n\n  console.log(`[OFFLINE] Using embedded baseline data for ${dataJsonKey}`);\n  return baselineData[dataJsonKey] as T;\n}\n\nexport async function getWalkpaths(): Promise<Walkpath[]> {\n  if (cachedWalkpaths) {\n    console.log('[OFFLINE] Using in-memory cached walkpaths');\n    return cachedWalkpaths;\n  }\n\n  const walkpaths = await fetchWithCacheFallback<Walkpath[]>('/api/walkpaths', 'walkpaths');\n  cachedWalkpaths = walkpaths;\n  console.log('[OFFLINE] Loaded walkpaths:', walkpaths.length);\n  return walkpaths;\n}\n\nexport async function getDrivepaths(): Promise<Drivepath[]> {\n  if (cachedDrivepaths) {\n    console.log('[OFFLINE] Using in-memory cached drivepaths');\n    return cachedDrivepaths;\n  }\n\n  const drivepaths = await fetchWithCacheFallback<Drivepath[]>('/api/drivepaths', 'drivepaths');\n  cachedDrivepaths = drivepaths;\n  console.log('[OFFLINE] Loaded drivepaths:', drivepaths.length);\n  return drivepaths;\n}\n\nexport async function getBuildings(): Promise<Building[]> {\n  if (cachedBuildings) {\n    console.log('[OFFLINE] Using in-memory cached buildings');\n    return cachedBuildings;\n  }\n\n  const buildings = await fetchWithCacheFallback<Building[]>('/api/buildings', 'buildings');\n  cachedBuildings = buildings;\n  console.log('[OFFLINE] Loaded buildings:', buildings.length);\n  return buildings;\n}\n\nexport async function getStaff(): Promise<Staff[]> {\n  if (cachedStaff) {\n    console.log('[OFFLINE] Using in-memory cached staff');\n    return cachedStaff;\n  }\n\n  const staff = await fetchWithCacheFallback<Staff[]>('/api/staff', 'staff');\n  cachedStaff = staff;\n  console.log('[OFFLINE] Loaded staff:', staff.length);\n  return staff;\n}\n\nexport async function getFloors(): Promise<Floor[]> {\n  if (cachedFloors) {\n    console.log('[OFFLINE] Using in-memory cached floors');\n    return cachedFloors;\n  }\n\n  const floors = await fetchWithCacheFallback<Floor[]>('/api/floors', 'floors');\n  cachedFloors = floors;\n  console.log('[OFFLINE] Loaded floors:', floors.length);\n  return floors;\n}\n\nexport async function getRooms(): Promise<Room[]> {\n  if (cachedRooms) {\n    console.log('[OFFLINE] Using in-memory cached rooms');\n    return cachedRooms;\n  }\n\n  const rooms = await fetchWithCacheFallback<Room[]>('/api/rooms', 'rooms');\n  cachedRooms = rooms;\n  console.log('[OFFLINE] Loaded rooms:', rooms.length);\n  return rooms;\n}\n\nexport async function getEvents(): Promise<Event[]> {\n  if (cachedEvents) {\n    console.log('[OFFLINE] Using in-memory cached events');\n    return cachedEvents;\n  }\n\n  const events = await fetchWithCacheFallback<Event[]>('/api/events', 'events');\n  cachedEvents = events;\n  console.log('[OFFLINE] Loaded events:', events.length);\n  return events;\n}\n\nexport function clearAllCache() {\n  cachedBuildings = null;\n  cachedWalkpaths = null;\n  cachedDrivepaths = null;\n  cachedStaff = null;\n  cachedFloors = null;\n  cachedRooms = null;\n  cachedEvents = null;\n  console.log('[OFFLINE] All data cache cleared');\n}\n\nexport function clearPathCache() {\n  cachedWalkpaths = null;\n  cachedDrivepaths = null;\n  console.log('[OFFLINE] Path cache cleared');\n}\n","size_bytes":4339},"client/src/lib/pathfinding.ts":{"content":"import type { LatLng, Building, Walkpath, Drivepath } from \"@shared/schema\";\n\ninterface Node {\n  lat: number;\n  lng: number;\n}\n\ninterface GraphNode {\n  id: string;\n  lat: number;\n  lng: number;\n  pathId?: string;\n}\n\ninterface Edge {\n  from: string;\n  to: string;\n  distance: number;\n}\n\nfunction calculateDistance(lat1: number, lng1: number, lat2: number, lng2: number): number {\n  const R = 6371000;\n  const dLat = (lat2 - lat1) * Math.PI / 180;\n  const dLng = (lng2 - lng1) * Math.PI / 180;\n  const a = \n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\n    Math.sin(dLng / 2) * Math.sin(dLng / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return R * c;\n}\n\nfunction nodeKey(lat: number, lng: number): string {\n  return `${lat.toFixed(7)},${lng.toFixed(7)}`;\n}\n\nfunction projectPointOntoSegment(\n  point: LatLng,\n  segmentStart: LatLng,\n  segmentEnd: LatLng\n): { lat: number; lng: number; distance: number } {\n  const dx = segmentEnd.lng - segmentStart.lng;\n  const dy = segmentEnd.lat - segmentStart.lat;\n  \n  if (dx === 0 && dy === 0) {\n    return {\n      lat: segmentStart.lat,\n      lng: segmentStart.lng,\n      distance: calculateDistance(point.lat, point.lng, segmentStart.lat, segmentStart.lng)\n    };\n  }\n\n  const t = Math.max(0, Math.min(1,\n    ((point.lng - segmentStart.lng) * dx + (point.lat - segmentStart.lat) * dy) /\n    (dx * dx + dy * dy)\n  ));\n\n  const projectedLat = segmentStart.lat + t * dy;\n  const projectedLng = segmentStart.lng + t * dx;\n  const distance = calculateDistance(point.lat, point.lng, projectedLat, projectedLng);\n\n  return { lat: projectedLat, lng: projectedLng, distance };\n}\n\nfunction findClosestSegmentProjection(\n  point: LatLng,\n  paths: (Walkpath | Drivepath)[]\n): { lat: number; lng: number; pathIndex: number; segmentIndex: number } | null {\n  let minDistance = Infinity;\n  let bestProjection: { lat: number; lng: number; pathIndex: number; segmentIndex: number } | null = null;\n\n  paths.forEach((path, pathIndex) => {\n    const pathNodes = path.nodes as LatLng[];\n    for (let i = 0; i < pathNodes.length - 1; i++) {\n      const projection = projectPointOntoSegment(point, pathNodes[i], pathNodes[i + 1]);\n      if (projection.distance < minDistance) {\n        minDistance = projection.distance;\n        bestProjection = {\n          lat: projection.lat,\n          lng: projection.lng,\n          pathIndex,\n          segmentIndex: i\n        };\n      }\n    }\n  });\n\n  return bestProjection;\n}\n\nfunction mergeNearbyNodes(\n  nodes: Map<string, GraphNode>,\n  edges: Edge[],\n  snapThreshold: number = 10\n): { nodes: Map<string, GraphNode>, edges: Edge[], nodeMapping: Map<string, string> } {\n  const nodeArray = Array.from(nodes.entries());\n  \n  const parent = new Map<string, string>();\n  nodeArray.forEach(([key]) => parent.set(key, key));\n  \n  function find(key: string): string {\n    if (parent.get(key) !== key) {\n      parent.set(key, find(parent.get(key)!));\n    }\n    return parent.get(key)!;\n  }\n  \n  function union(a: string, b: string): void {\n    const rootA = find(a);\n    const rootB = find(b);\n    if (rootA !== rootB) {\n      parent.set(rootB, rootA);\n    }\n  }\n  \n  let mergeCount = 0;\n  let skippedSamePathCount = 0;\n  let missingPathIdCount = 0;\n  for (let i = 0; i < nodeArray.length; i++) {\n    const [keyA, nodeA] = nodeArray[i];\n    for (let j = i + 1; j < nodeArray.length; j++) {\n      const [keyB, nodeB] = nodeArray[j];\n      const dist = calculateDistance(nodeA.lat, nodeA.lng, nodeB.lat, nodeB.lng);\n      if (dist <= snapThreshold) {\n        if (!nodeA.pathId || !nodeB.pathId) {\n          missingPathIdCount++;\n          console.warn(`[WARN] Skipping merge due to missing pathId: ${keyA.substring(0, 20)}... (${nodeA.pathId || 'MISSING'}) <-> ${keyB.substring(0, 20)}... (${nodeB.pathId || 'MISSING'})`);\n          continue;\n        }\n        \n        if (nodeA.pathId === nodeB.pathId) {\n          skippedSamePathCount++;\n          continue;\n        }\n        \n        console.log(`[DEBUG] Merging nodes ${dist.toFixed(1)}m apart: ${keyA.substring(0, 20)}... <-> ${keyB.substring(0, 20)}... (pathIds: ${nodeA.pathId.substring(0, 8)} <-> ${nodeB.pathId.substring(0, 8)})`);\n        union(keyA, keyB);\n        mergeCount++;\n      }\n    }\n  }\n  console.log(`[DEBUG] Total nodes merged: ${mergeCount}, skipped same-path merges: ${skippedSamePathCount}, missing pathId: ${missingPathIdCount}`);\n  \n  const clusters = new Map<string, string[]>();\n  nodeArray.forEach(([key]) => {\n    const root = find(key);\n    if (!clusters.has(root)) {\n      clusters.set(root, []);\n    }\n    clusters.get(root)!.push(key);\n  });\n  \n  const nodeMapping = new Map<string, string>();\n  const mergedNodes = new Map<string, GraphNode>();\n  \n  clusters.forEach((clusterKeys, representative) => {\n    let sumLat = 0;\n    let sumLng = 0;\n    const pathIds = new Set<string>();\n    \n    clusterKeys.forEach(key => {\n      const node = nodes.get(key)!;\n      sumLat += node.lat;\n      sumLng += node.lng;\n      if (node.pathId) {\n        pathIds.add(node.pathId);\n      }\n      nodeMapping.set(key, representative);\n    });\n    \n    const avgLat = sumLat / clusterKeys.length;\n    const avgLng = sumLng / clusterKeys.length;\n    \n    const mergedNode: GraphNode = {\n      id: representative,\n      lat: avgLat,\n      lng: avgLng\n    };\n    \n    if (pathIds.size === 1) {\n      mergedNode.pathId = Array.from(pathIds)[0];\n    }\n    \n    mergedNodes.set(representative, mergedNode);\n  });\n  \n  const mergedEdges: Edge[] = [];\n  const edgeSet = new Set<string>();\n  \n  edges.forEach(edge => {\n    const fromMapped = nodeMapping.get(edge.from) || edge.from;\n    const toMapped = nodeMapping.get(edge.to) || edge.to;\n    \n    if (fromMapped === toMapped) return;\n    \n    const edgeKey = `${fromMapped}|${toMapped}`;\n    const reverseKey = `${toMapped}|${fromMapped}`;\n    \n    if (!edgeSet.has(edgeKey) && !edgeSet.has(reverseKey)) {\n      const fromNode = mergedNodes.get(fromMapped)!;\n      const toNode = mergedNodes.get(toMapped)!;\n      const distance = calculateDistance(fromNode.lat, fromNode.lng, toNode.lat, toNode.lng);\n      \n      mergedEdges.push({ from: fromMapped, to: toMapped, distance });\n      mergedEdges.push({ from: toMapped, to: fromMapped, distance });\n      edgeSet.add(edgeKey);\n      edgeSet.add(reverseKey);\n    }\n  });\n  \n  return { nodes: mergedNodes, edges: mergedEdges, nodeMapping };\n}\n\nfunction buildGraph(paths: (Walkpath | Drivepath)[]): {\n  nodes: Map<string, GraphNode>,\n  edges: Edge[]\n} {\n  const nodes = new Map<string, GraphNode>();\n  const edges: Edge[] = [];\n\n  console.log(`[CLIENT] Building graph from ${paths.length} paths`);\n\n  paths.forEach((path) => {\n    const pathNodes = path.nodes as LatLng[];\n    \n    pathNodes.forEach((node) => {\n      const key = nodeKey(node.lat, node.lng);\n      if (!nodes.has(key)) {\n        nodes.set(key, { id: key, lat: node.lat, lng: node.lng, pathId: path.id });\n      }\n    });\n\n    for (let i = 0; i < pathNodes.length - 1; i++) {\n      const fromKey = nodeKey(pathNodes[i].lat, pathNodes[i].lng);\n      const toKey = nodeKey(pathNodes[i + 1].lat, pathNodes[i + 1].lng);\n      const distance = calculateDistance(\n        pathNodes[i].lat,\n        pathNodes[i].lng,\n        pathNodes[i + 1].lat,\n        pathNodes[i + 1].lng\n      );\n\n      edges.push({ from: fromKey, to: toKey, distance });\n      edges.push({ from: toKey, to: fromKey, distance });\n    }\n  });\n\n  console.log(`[CLIENT] Before merge: ${nodes.size} nodes, ${edges.length} edges`);\n  const merged = mergeNearbyNodes(nodes, edges, 10);\n  console.log(`[CLIENT] After merge: ${merged.nodes.size} nodes, ${merged.edges.length} edges`);\n  \n  return { nodes: merged.nodes, edges: merged.edges };\n}\n\nexport function findShortestPath(\n  start: Building,\n  end: Building,\n  paths: (Walkpath | Drivepath)[]\n): LatLng[] | null {\n  const { nodes, edges } = buildGraph(paths);\n\n  console.log(`[CLIENT] Pathfinding from \"${start.name}\" to \"${end.name}\"`);\n  const startPoint = { lat: start.lat, lng: start.lng };\n  const endPoint = { lat: end.lat, lng: end.lng };\n\n  const startProjection = findClosestSegmentProjection(startPoint, paths);\n  const endProjection = findClosestSegmentProjection(endPoint, paths);\n\n  if (!startProjection || !endProjection) {\n    console.log(`[CLIENT] Could not find projections for buildings`);\n    return null;\n  }\n\n  let startProjKey = nodeKey(startProjection.lat, startProjection.lng);\n  let endProjKey = nodeKey(endProjection.lat, endProjection.lng);\n  const startKey = nodeKey(startPoint.lat, startPoint.lng);\n  const endKey = nodeKey(endPoint.lat, endPoint.lng);\n  \n  console.log(`[CLIENT] Start projection: ${startProjKey.substring(0, 30)}... on path ${startProjection.pathIndex}`);\n  console.log(`[CLIENT] End projection: ${endProjKey.substring(0, 30)}... on path ${endProjection.pathIndex}`);\n\n  const snapThreshold = 10;\n  \n  nodes.forEach((node, key) => {\n    const distToStart = calculateDistance(startProjection.lat, startProjection.lng, node.lat, node.lng);\n    if (distToStart <= snapThreshold && distToStart > 0) {\n      console.log(`[CLIENT] Snapping start projection to existing node ${key.substring(0, 30)}... (${distToStart.toFixed(1)}m away)`);\n      startProjKey = key;\n    }\n    \n    const distToEnd = calculateDistance(endProjection.lat, endProjection.lng, node.lat, node.lng);\n    if (distToEnd <= snapThreshold && distToEnd > 0) {\n      console.log(`[CLIENT] Snapping end projection to existing node ${key.substring(0, 30)}... (${distToEnd.toFixed(1)}m away)`);\n      endProjKey = key;\n    }\n  });\n\n  const augmentedNodes = new Map(nodes);\n  let augmentedEdges = [...edges];\n\n  augmentedNodes.set(startKey, { id: startKey, lat: startPoint.lat, lng: startPoint.lng });\n  augmentedNodes.set(endKey, { id: endKey, lat: endPoint.lat, lng: endPoint.lng });\n\n  const segmentProjections = new Map<string, Array<{ key: string; lat: number; lng: number; t: number }>>();\n\n  const projectionsToAdd = [\n    { key: startProjKey, ...startProjection },\n    { key: endProjKey, ...endProjection }\n  ];\n\n  projectionsToAdd.forEach(proj => {\n    if (!augmentedNodes.has(proj.key)) {\n      augmentedNodes.set(proj.key, {\n        id: proj.key,\n        lat: proj.lat,\n        lng: proj.lng\n      });\n    }\n\n    const path = paths[proj.pathIndex];\n    const pathNodes = path.nodes as LatLng[];\n    const segStart = pathNodes[proj.segmentIndex];\n    const segEnd = pathNodes[proj.segmentIndex + 1];\n    const segKey = `${proj.pathIndex}-${proj.segmentIndex}`;\n\n    const dx = segEnd.lng - segStart.lng;\n    const dy = segEnd.lat - segStart.lat;\n    const t = dx === 0 && dy === 0 ? 0 : Math.max(0, Math.min(1,\n      ((proj.lng - segStart.lng) * dx + (proj.lat - segStart.lat) * dy) /\n      (dx * dx + dy * dy)\n    ));\n\n    if (!segmentProjections.has(segKey)) {\n      segmentProjections.set(segKey, []);\n    }\n    segmentProjections.get(segKey)!.push({ key: proj.key, lat: proj.lat, lng: proj.lng, t });\n  });\n\n  segmentProjections.forEach((projs, segKey) => {\n    const [pathIndex, segmentIndex] = segKey.split('-').map(Number);\n    const path = paths[pathIndex];\n    const pathNodes = path.nodes as LatLng[];\n    const segStart = pathNodes[segmentIndex];\n    const segEnd = pathNodes[segmentIndex + 1];\n    const segStartKey = nodeKey(segStart.lat, segStart.lng);\n    const segEndKey = nodeKey(segEnd.lat, segEnd.lng);\n\n    augmentedEdges = augmentedEdges.filter(\n      e => !(e.from === segStartKey && e.to === segEndKey) &&\n           !(e.from === segEndKey && e.to === segStartKey)\n    );\n\n    projs.sort((a, b) => a.t - b.t);\n\n    const allPoints = [\n      { key: segStartKey, lat: segStart.lat, lng: segStart.lng },\n      ...projs,\n      { key: segEndKey, lat: segEnd.lat, lng: segEnd.lng }\n    ];\n\n    for (let i = 0; i < allPoints.length - 1; i++) {\n      const from = allPoints[i];\n      const to = allPoints[i + 1];\n      const dist = calculateDistance(from.lat, from.lng, to.lat, to.lng);\n      \n      if (dist > 0) {\n        augmentedEdges.push({ from: from.key, to: to.key, distance: dist });\n        augmentedEdges.push({ from: to.key, to: from.key, distance: dist });\n      }\n    }\n  });\n\n  const startToProjDist = calculateDistance(startPoint.lat, startPoint.lng, startProjection.lat, startProjection.lng);\n  const endToProjDist = calculateDistance(endPoint.lat, endPoint.lng, endProjection.lat, endProjection.lng);\n\n  augmentedEdges.push({ from: startKey, to: startProjKey, distance: startToProjDist });\n  augmentedEdges.push({ from: startProjKey, to: startKey, distance: startToProjDist });\n  augmentedEdges.push({ from: endKey, to: endProjKey, distance: endToProjDist });\n  augmentedEdges.push({ from: endProjKey, to: endKey, distance: endToProjDist });\n\n  const distances = new Map<string, number>();\n  const previous = new Map<string, string | null>();\n  const unvisited = new Set<string>();\n\n  augmentedNodes.forEach((_, key) => {\n    distances.set(key, Infinity);\n    previous.set(key, null);\n    unvisited.add(key);\n  });\n\n  distances.set(startKey, 0);\n\n  while (unvisited.size > 0) {\n    let current: string | null = null;\n    let minDist = Infinity;\n\n    unvisited.forEach((key) => {\n      const dist = distances.get(key)!;\n      if (dist < minDist) {\n        minDist = dist;\n        current = key;\n      }\n    });\n\n    if (current === null || current === endKey) {\n      break;\n    }\n\n    unvisited.delete(current);\n\n    const neighbors = augmentedEdges.filter(e => e.from === current);\n\n    neighbors.forEach(edge => {\n      if (!unvisited.has(edge.to)) return;\n\n      const alt = distances.get(current!)! + edge.distance;\n      if (alt < distances.get(edge.to)!) {\n        distances.set(edge.to, alt);\n        previous.set(edge.to, current);\n      }\n    });\n  }\n\n  if (distances.get(endKey) === Infinity || (previous.get(endKey) === undefined && endKey !== startKey)) {\n    console.warn(`[CLIENT] WARNING: No road connection found between \"${start.name}\" and \"${end.name}\" - paths are not connected!`);\n    console.warn('[CLIENT] TIP: Make sure your paths share common waypoints to form junctions.');\n    return [startPoint, endPoint];\n  }\n\n  const path: string[] = [];\n  let current: string | null = endKey;\n\n  while (current !== null) {\n    path.unshift(current);\n    current = previous.get(current) || null;\n  }\n\n  const route: LatLng[] = path.map(key => {\n    const node = augmentedNodes.get(key);\n    return node ? { lat: node.lat, lng: node.lng } : null;\n  }).filter((p): p is LatLng => p !== null);\n\n  return route;\n}\n","size_bytes":14553},"client/src/components/offline-indicator.tsx":{"content":"import { WifiOff, Wifi } from \"lucide-react\";\nimport { useOfflineDetection } from \"@/hooks/use-offline\";\n\nexport function OfflineIndicator() {\n  const isOffline = useOfflineDetection();\n\n  if (!isOffline) return null;\n\n  return (\n    <div className=\"fixed bottom-4 left-4 z-50 flex items-center gap-2 bg-destructive text-destructive-foreground px-4 py-2 rounded-md shadow-lg\" data-testid=\"indicator-offline\">\n      <WifiOff className=\"w-4 h-4\" />\n      <span className=\"text-sm font-medium\">Offline Mode</span>\n    </div>\n  );\n}\n","size_bytes":529},"client/src/hooks/use-offline.ts":{"content":"import { useState, useEffect } from 'react';\n\nexport function useOfflineDetection() {\n  const [isOffline, setIsOffline] = useState(!navigator.onLine);\n\n  useEffect(() => {\n    const handleOnline = () => {\n      console.log('[OFFLINE] Connection restored - back online');\n      setIsOffline(false);\n    };\n\n    const handleOffline = () => {\n      console.log('[OFFLINE] Connection lost - now offline');\n      setIsOffline(true);\n    };\n\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }, []);\n\n  return isOffline;\n}\n","size_bytes":722}},"version":2}